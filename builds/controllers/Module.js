"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _Controller=_interopRequireDefault(require("./Controller")),_package=_interopRequireDefault(require("../package.json")),_Tracing=_interopRequireDefault(require("../utils/Tracing")),_Result=_interopRequireDefault(require("../utils/Result")),_StackTrace=_interopRequireDefault(require("../utils/StackTrace")),_lodash=_interopRequireDefault(require("lodash")),_md=_interopRequireDefault(require("md5"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}class Module extends _Controller.default{constructor(a){super(),this.moduleManager=a}async getState(a){try{return await this.executeAction(a,"state",{})}catch(a){return _StackTrace.default.save(a),_Tracing.default.error(_package.default.name,"Error occurred when get state in module"),new _Result.default(_package.default.name,!0,"Error occurred when get state in module")}}async executeAction(a,b,c){try{if(this.moduleManager.instances.has(a)){let d=this.moduleManager.instances.get(a);return"function"==typeof d["__"+b]?await d["__"+b](c):new _Result.default(_package.default.name,!0,"Action not found")}return new _Result.default(_package.default.name,!0,"Module not found")}catch(a){return _StackTrace.default.save(a),_Tracing.default.error(_package.default.name,"Error occurred when executing an action in module manager"),new _Result.default(_package.default.name,!0,"Error occurred when executing an action in module manager")}}getAllConfiguration(){try{let a=[];for(let b=0;b<this.moduleManager.packages.length;b++){let c=this.moduleManager.packages[b],d=require(c+"/package.json");a.push(d)}return new _Result.default(_package.default.name,!1,"",a)}catch(a){return _StackTrace.default.save(a),_Tracing.default.error(_package.default.name,"Error occurred when get all configuration in module"),new _Result.default(_package.default.name,!0,"Error occurred when get all configuration in module")}}getByHash(a){let b=!1;return this.moduleManager.packages.forEach(c=>{(0,_md.default)(c)==a&&(b=c)}),new _Result.default(_package.default.name,!1,"",b)}}var _default=Module;exports.default=_default,module.exports=exports.default;