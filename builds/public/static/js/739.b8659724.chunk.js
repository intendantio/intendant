"use strict";(self.webpackChunk_intendant_dashboard=self.webpackChunk_intendant_dashboard||[]).push([[739],{9739:function(t,e,n){n.r(e),n.d(e,{default:function(){return T}});var i=n(3032),r=n(7853),s=n(4531),a=n(8932),o=n(2587),c=n(4322),l=n.n(c),u=n(2791),d=n(5886),h=n(1889),p=n(7621),f=n(6647),g=n(890),m=n(703),x=n(242),Z=n(4512),v=n(5825),j=n(3496),y=n(184),S={chart:{id:"basic-bar",zoom:{enabled:!1},toolbar:{show:!1},offsetX:-5,animations:{enabled:!0,easing:"easeout",animateGradually:{enabled:!0}}},grid:{show:!1},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{min:1,max:10,labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},dataLabels:{enabled:!1},tooltip:{enabled:!1,theme:"dark",x:{formatter:function(t){return Moment.unix(t).format("HH:mm")}}},title:{text:"Line Chart",align:"center",style:{color:"#ffffff",fontWeight:500,fontSize:18,fontFamily:"Poppins,sans-serif"}},subtitle:{text:"Data is sort per time",align:"center",style:{color:"rgba(255, 255, 255, 0.7)",fontSize:14,fontWeight:400,fontFamily:"Poppins,sans-serif"}},stroke:{width:6,curve:"smooth"},colors:["rgba(255,255,255,0.8)"],fill:{type:"gradient",gradient:{gradientToColors:["rgba(255,255,255,0.8)","rgba(255,255,255,0.8)"]}}},b=function(t){(0,a.Z)(n,t);var e=(0,o.Z)(n);function n(){return(0,r.Z)(this,n),e.apply(this,arguments)}return(0,s.Z)(n,[{key:"render",value:function(){var t=this;return(0,y.jsx)(h.ZP,{item:!0,xs:12,md:6,lg:4,children:(0,y.jsx)(p.Z,{variant:"outlined",children:(0,y.jsx)(f.Z,{onClick:function(){t.props.onSelect("lineChart")},children:(0,y.jsx)(j.Z,{options:S,series:[{name:"test",data:[7,6,8,6,4,9]}],type:"line",height:300})})})})}}]),n}(u.Component),k=b,w=n(9388),C=n(722),F=n(6067),z=n(7457),P=[{name:"1 minute",interval:60},{name:"5 minutes",interval:300},{name:"15 minutes",interval:900},{name:"30 minutes",interval:1800},{name:"1 hour",interval:3600},{name:"3 hours",interval:10800},{name:"6 hours",interval:21600},{name:"12 hours",interval:43200},{name:"24 hours",interval:86400}],L=function(t){(0,a.Z)(n,t);var e=(0,o.Z)(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,t)).state={loading:!0,step:0,reference:"",interval:0,configurations:[],configuration:{},settings:[]},t.setTitle("New rapport"),t.setActionType("return"),i}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){var t=(0,i.Z)(l().mark((function t(){var e,n,i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new d.Z).get().fetch("/api/modules");case 2:return e=t.sent,t.next=5,(new d.Z).get().fetch("/api/smartobjects");case 5:n=t.sent,e.error?this.props.setMessage(e.package+" : "+e.message):n.error?this.props.setMessage(n.package+" : "+n.message):(i=[],n.data.forEach((function(t){Array.isArray(t.dataSources)&&t.dataSources.length>0&&i.push(t)})),e.data.forEach((function(t){Array.isArray(t.dataSources)&&t.dataSources.length>0&&i.push({configuration:t,name:t.name,reference:t.reference,widgets:t.widgets,dataSources:t.dataSources,actions:t.actions})})),0==i.length?(this.props.setMessage("No sources available"),this.props.history.push("/rapport")):this.setState({loading:!1,configurations:i}),this.setState({loading:!1,configurations:i}));case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"selectSource",value:function(t){this.setState({open:!1});var e=[];this.state.configuration.actions.forEach((function(n){n.id==t.action&&(e=n.settings)})),0==e.length?this.setState({step:4,reference:t.id,settings:e}):this.setState({step:3,reference:t.id,settings:e})}},{key:"getStep",value:function(){var t=this;switch(this.state.step){case 0:return(0,y.jsx)(k,{onSelect:function(e){t.setState({type:e,step:1})}});case 1:return this.state.configurations.map((function(e,n){return"module"==e.module?(0,y.jsx)(h.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,y.jsx)(p.Z,{variant:"outlined",children:(0,y.jsx)(f.Z,{onClick:function(){t.setState({configuration:e,step:2})},style:{padding:10},children:(0,y.jsx)(g.Z,{variant:"subtitle1",children:String.capitalizeFirstLetter(e.name)})})})},n):(0,y.jsx)(h.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,y.jsx)(p.Z,{variant:"outlined",children:(0,y.jsxs)(f.Z,{onClick:function(){t.setState({configuration:e,step:2})},style:{padding:10},children:[(0,y.jsx)(g.Z,{variant:"subtitle1",children:String.capitalizeFirstLetter(e.reference)}),e.room&&(0,y.jsx)(g.Z,{variant:"body2",color:"text.secondary",children:String.capitalizeFirstLetter(e.room.name)})]})})},n)}));case 2:return this.state.configuration.dataSources.map((function(e,n){return(0,y.jsx)(h.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,y.jsx)(p.Z,{variant:"outlined",children:(0,y.jsx)(f.Z,{onClick:function(){t.selectSource(e)},style:{padding:10},children:(0,y.jsx)(g.Z,{variant:"subtitle1",children:String.capitalizeFirstLetter(e.id)})})})},n)}));case 3:return(0,y.jsxs)(y.Fragment,{children:[this.state.settings.map((function(e,n){return(0,y.jsx)(h.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,y.jsx)(p.Z,{variant:"outlined",style:{padding:10},children:(0,y.jsx)(C.Z,{options:e.options,label:String.capitalizeFirstLetter(e.id),setState:t.setState.bind(t),id:"rapport-"+e.id,action:e})})},n)})),(0,y.jsx)(F.Z,{xs:12,md:12,lg:12,onClick:function(){t.setState({step:4})}})]});case 4:return P.map((function(e,n){return(0,y.jsx)(h.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,y.jsx)(p.Z,{variant:"outlined",children:(0,y.jsx)(f.Z,{onClick:function(){t.setState({loading:!0,interval:e.interval},(function(){t.submit()}))},style:{padding:10},children:(0,y.jsx)(g.Z,{variant:"subtitle1",children:"Each "+String.capitalizeFirstLetter(e.name)})})})},n)}))}}},{key:"submit",value:function(){var t=(0,i.Z)(l().mark((function t(){var e,n,i,r,s;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=[],n={},i=0;i<this.state.settings.length;i++)r=this.state.settings[i],n["rapport-"+r.id]=null,e.push({reference:r.id,value:this.state["rapport-"+r.id]?this.state["rapport-"+r.id]:null,type:typeof this.state["rapport-"+r.id]});return t.next=5,(new d.Z).post({reference:this.state.reference,chart:this.state.type,interval:this.state.interval,type:this.state.configuration.configuration.module,object:"smartobject"==this.state.configuration.configuration.module?this.state.configuration.id:z.Z.getSum(this.state.configuration.name),settings:e}).fetch("/api/rapports");case 5:(s=t.sent).error?this.props.setMessage(s.package+" : "+s.message):(document.getElementById("main").scroll({top:0,left:0}),this.props.history.push("/rapport"));case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(m.Z,{variant:"outlined",style:{padding:12,justifyContent:"left"},children:[(0,y.jsx)(g.Z,{variant:"h6",fontWeight:"bold",children:"New rapport"}),(0,y.jsx)(g.Z,{variant:"subtitle2",color:"text.secondary",children:"Capture your data"})]}),(0,y.jsxs)(w.Z,{loading:this.state.loading,children:[(0,y.jsx)(p.Z,{variant:"outlined",style:{padding:10,marginTop:8},children:(0,y.jsxs)(x.Z,{activeStep:this.state.step,children:[(0,y.jsx)(Z.Z,{children:(0,y.jsx)(v.Z,{children:"Type"})},"type"),(0,y.jsx)(Z.Z,{children:(0,y.jsx)(v.Z,{children:"Source"})},"source"),(0,y.jsx)(Z.Z,{children:(0,y.jsx)(v.Z,{children:"Data"})},"data"),(0,y.jsx)(Z.Z,{children:(0,y.jsx)(v.Z,{children:"Settings"})},"settings"),(0,y.jsx)(Z.Z,{children:(0,y.jsx)(v.Z,{children:"Interval"})},"interval")]})}),(0,y.jsx)(h.ZP,{container:!0,spacing:1,style:{marginTop:0},children:this.getStep()})]})]})}}]),n}(u.Component),T=L},7457:function(t,e,n){var i=n(7853),r=n(4531),s=function(){function t(){(0,i.Z)(this,t)}return(0,r.Z)(t,null,[{key:"getSum",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.split("").reduce((function(t,e){return(t=(t<<5)-t+e.charCodeAt(0))&t}),0)}}]),t}();e.Z=s}}]);
//# sourceMappingURL=739.b8659724.chunk.js.map