"use strict";(self.webpackChunk_intendant_dashboard=self.webpackChunk_intendant_dashboard||[]).push([[877],{7877:function(e,t,n){n.r(t);var s=n(8489),i=n(3032),r=n(7853),a=n(4531),o=n(8932),c=n(2587),l=n(4322),d=n.n(l),h=n(2791),p=n(9779),u=n.n(p),x=n(703),m=n(4554),g=n(890),f=n(1889),j=n(7621),Z=n(9373),v=n(8102),y=n(5818),b=n(4721),w=n(3721),k=n(7391),S=n(4807),P=n(7067),C=n(7355),M=n(6080),A=n(8187),T=n(3530),z=(n(4893),n(722)),L=n(419),D=n(5886),R=n(9388),F=n(3712),B=n(7610),I=n(184),O=function(e){(0,o.Z)(n,e);var t=(0,c.Z)(n);function n(e){var s;return(0,r.Z)(this,n),(s=t.call(this,e)).state={id:e.match.params.id,smartobject:{reference:"",actions:[],room:{},state:{status:"unknown"}},expanded:"action",rooms:[],modalOpen:!1,content:{},loadingAction:"",loading:!0},e.setTitle(""),e.setActionType("return"),s}return(0,a.Z)(n,[{key:"componentDidMount",value:function(){var e=(0,i.Z)(d().mark((function e(){var t,n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new D.Z).get().fetch("/api/rooms");case 2:return t=e.sent,e.next=5,(new D.Z).get().fetch("/api/smartobjects/"+this.state.id);case 5:n=e.sent,t.error?(this.props.setMessage(t.package+" : "+t.message),this.props.history.push("/smartobject")):n.error?(this.props.setMessage(n.package+" : "+n.message),this.props.history.push("/smartobject")):(this.props.setTitle(n.data.reference),this.setState({reference:n.data.reference,loadingAction:"",loading:!1,smartobject:n.data,rooms:t.data}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,i.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new D.Z).delete().fetch("/api/smartobjects/"+this.state.id);case 2:(t=e.sent).error?this.props.setMessage(t.package+" : "+t.message):this.props.history.push("/smartobject");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeAction",value:function(){var e=(0,i.Z)(d().mark((function e(t,n){var s,i,r,a,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.setState({loadingAction:t.id}),s={},i=0;i<n.length;i++)r=n[i],a=this.state[t.id+"-"+r.id],s[r.id]=a||r.default;return e.next=5,(new D.Z).post({settings:s}).fetch("/api/smartobjects/"+this.state.id+"/actions/"+t.id);case 5:(o=e.sent).error?(this.props.setMessage(o.package+" : "+o.message),this.setState({loadingAction:""})):(this.setState({modalOpen:!0,content:o.data}),this.componentDidMount());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateRoom",value:function(){var e=(0,i.Z)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new D.Z).post({idRoom:t.id}).fetch("/api/smartobjects/"+this.state.smartobject.id+"/room");case 2:(n=e.sent).error?this.props.setMessage(n.package+" : "+n.message):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateReference",value:function(){var e=(0,i.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new D.Z).post({reference:this.state.reference}).fetch("/api/smartobjects/"+this.state.smartobject.id+"/reference");case 2:(t=e.sent).error?this.props.setMessage(t.package+" : "+t.message):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"installPackage",value:function(){var e=(0,i.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,(new D.Z).patch({package:this.state.smartobject.module}).fetch("/api/smartobjects");case 3:(t=e.sent).error?(this.props.setMessage(t.package+" : "+t.message),this.props.history.push("/smartobject")):this.componentDidMount();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t="";return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(L.Z,(0,s.Z)((0,s.Z)({},this.props),{},{children:(0,I.jsx)(x.Z,{variant:"outlined",style:{padding:12,justifyContent:"left"},children:(0,I.jsx)(m.Z,{style:{display:"flex",flex:1},children:(0,I.jsxs)(m.Z,{style:{flex:4,alignSelf:"center",alignItems:"center"},children:[(0,I.jsx)(g.Z,{variant:"h6",fontWeight:"bold",children:String.capitalizeFirstLetter(this.state.smartobject.reference)}),(0,I.jsx)(g.Z,{variant:"subtitle2",color:"text.secondary",children:String.capitalizeFirstLetter(this.state.smartobject.module)})]})})})})),(0,I.jsxs)(R.Z,{loading:this.state.loading,children:[(0,I.jsxs)(f.ZP,{container:!0,spacing:1,style:{marginTop:0},children:["uninstalled"==this.state.smartobject.state.status?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(f.ZP,{item:!0,xs:12,md:6,lg:10,children:(0,I.jsx)(j.Z,{variant:"outlined",style:{padding:12},children:(0,I.jsxs)(m.Z,{style:{display:"flex",flexDirection:"row"},children:[(0,I.jsx)(P.Z,{style:{fontSize:"24px"}}),(0,I.jsx)(g.Z,{variant:"subtitle1",style:{marginLeft:12},children:"Smartobject is not correctly installed"})]})})}),(0,I.jsx)(f.ZP,{item:!0,xs:12,md:6,lg:2,children:(0,I.jsx)(j.Z,{style:{height:"100%"},variant:"outlined",children:(0,I.jsx)(Z.Z,{onClick:function(){e.installPackage()},style:{padding:10,height:"100%",width:"100%"},variant:"contained",size:"small",color:"error",children:(0,I.jsx)(g.Z,{variant:"subtitle1",style:{textAlign:"center",color:"white",textTransform:"none"},children:"Fix smartobject"})})})})]}):null,(0,I.jsx)(f.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,I.jsxs)(v.Z,{variant:"outlined",expanded:"action"===this.state.expanded,onChange:function(){return e.setState({expanded:"action"})},children:[(0,I.jsxs)(y.Z,{expandIcon:(0,I.jsx)(C.Z,{}),children:[(0,I.jsx)(M.Z,{style:{fontSize:"28px"}}),(0,I.jsx)(g.Z,{variant:"h6",style:{marginLeft:5},children:"Action"})]}),(0,I.jsx)(b.Z,{}),(0,I.jsx)(w.Z,{children:(0,I.jsx)(f.ZP,{container:!0,children:this.state.smartobject.actions.map((function(n,s){if("trigger"==n.type)return null;var i=n.group&&n.group!=t;return t=n.group?n.group:"",(0,I.jsxs)(f.ZP,{item:!0,xs:12,md:12,lg:12,style:{marginTop:7},children:[i&&(0,I.jsx)(b.Z,{style:{marginBottom:14},children:(0,I.jsx)(g.Z,{textAlign:"center",variant:"subtitle1",children:t})}),(0,I.jsxs)(f.ZP,{container:!0,spacing:0==n.settings.length&&e.props.isMobile?0:2,children:[(0,I.jsx)(f.ZP,{item:!0,xs:12,md:3,lg:3,children:(0,I.jsx)(j.Z,{elevation:2,children:(0,I.jsx)(Z.Z,{disabled:n.id==e.state.loadingAction||"online"!=e.state.smartobject.state.status,variant:"contained",onClick:function(){e.executeAction(n,n.settings)},style:{width:"100%",flexDirection:"row",display:"flex"},children:(0,I.jsx)(g.Z,{textAlign:"center",variant:"subtitle2",children:n.name})})})}),(0,I.jsx)(f.ZP,{item:!0,xs:12,md:9,lg:9,style:{alignSelf:"center",paddingLeft:10},children:(0,I.jsx)(f.ZP,{container:!0,spacing:1,children:n.settings.map((function(t,s){return(0,I.jsx)(z.Z,{options:t.options,label:String.capitalizeFirstLetter(t.id),setState:e.setState.bind(e),id:n.id+"-"+t.id,action:t})}))})})]}),(0,I.jsx)(b.Z,{style:{marginBottom:7,marginTop:14}})]},s)}))})})]})}),(0,I.jsx)(f.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,I.jsxs)(v.Z,{variant:"outlined",expanded:"room"===this.state.expanded,onChange:function(){return e.setState({expanded:"room"})},children:[(0,I.jsxs)(y.Z,{expandIcon:(0,I.jsx)(C.Z,{}),children:[(0,I.jsx)(A.Z,{style:{fontSize:"28px"}}),(0,I.jsx)(g.Z,{variant:"h6",style:{marginLeft:5},children:"Room"})]}),(0,I.jsx)(b.Z,{}),(0,I.jsx)(w.Z,{children:(0,I.jsx)(f.ZP,{container:!0,spacing:1,style:{marginTop:2},children:this.state.rooms.map((function(t,n){var s=F[t.icon];return(0,I.jsx)(f.ZP,{item:!0,xs:12,md:3,lg:2,children:(0,I.jsxs)(Z.Z,{onClick:function(){e.updateRoom(t)},variant:t.id==e.state.smartobject.room.id?"contained":"outlined",style:{padding:5,paddingTop:10,paddingBottom:10,borderColor:"white",width:"100%"},children:[(0,I.jsx)(s,{style:{color:"white"}}),(0,I.jsx)(g.Z,{variant:"body1",style:{marginLeft:10,color:"white"},children:t.name})]})},n)}))})})]})}),(0,I.jsx)(f.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,I.jsxs)(v.Z,{variant:"outlined",expanded:"edit"===this.state.expanded,onChange:function(){return e.setState({expanded:"edit"})},children:[(0,I.jsxs)(y.Z,{expandIcon:(0,I.jsx)(C.Z,{}),children:[(0,I.jsx)(T.Z,{style:{fontSize:"28px"}}),(0,I.jsx)(g.Z,{variant:"h6",style:{marginLeft:5},children:"Edit"})]}),(0,I.jsx)(b.Z,{}),(0,I.jsx)(w.Z,{children:(0,I.jsx)(f.ZP,{container:!0,spacing:1,style:{marginTop:2},children:(0,I.jsx)(f.ZP,{item:!0,xs:12,md:4,lg:4,children:(0,I.jsx)(k.Z,{value:this.state.reference,color:this.state.smartobject.reference!=this.state.reference?"warning":"info",onChange:function(t){e.setState({reference:t.nativeEvent.target.value})},onBlur:function(t){e.updateReference()},style:{width:"100%",marginRight:10,marginBottom:this.props.isMobile?10:0},label:"Name",variant:"outlined"})})})})]})})]}),(0,I.jsx)(B.Z,{onClick:function(){e.delete()}}),(0,I.jsx)(S.Z,{open:this.state.modalOpen,style:{top:"25%",left:"25%"},onClose:function(){e.setState({modalOpen:!1})},children:(0,I.jsx)(j.Z,{variant:"outlined",style:{overflow:"auto",maxHeight:"50vh",maxWidth:"50vw",padding:20},children:(0,I.jsx)(u(),{style:{fontSize:12},id:"json-pretty",data:this.state.content})})})]})]})}}]),n}(h.Component);t.default=O}}]);
//# sourceMappingURL=877.6c5f84d4.chunk.js.map