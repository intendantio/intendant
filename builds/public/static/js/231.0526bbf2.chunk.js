"use strict";(self.webpackChunk_intendant_dashboard=self.webpackChunk_intendant_dashboard||[]).push([[231],{4369:function(t,e,n){function a(t){return t.isMobile?t.children:null}n.d(e,{Z:function(){return a}})},5028:function(t,e,n){n.r(e),n.d(e,{default:function(){return Y}});var a=n(8489),i=n(3032),r=n(7853),s=n(4531),o=n(8932),l=n(2587),c=n(4322),d=n.n(c),u=n(2791),h=n(3928),f=n(8820),p=n(7103),v=n(5397),x=n(703),m=n(890),g=n(1889),y=n(7621),Z=n(4554),j=n(3402),b=n(9373),k=n(3400),w=(n(4893),n(419)),M=n(5886),O=n(2426),C=n.n(O),D=n(3496),S=n(184),F=function(t){(0,o.Z)(n,t);var e=(0,l.Z)(n);function n(t){var a;return(0,r.Z)(this,n),(a=e.call(this,t)).state={id:a.props.id,remaning:0,percent:0,loading:!0},a}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){var t=(0,i.Z)(d().mark((function t(){var e,n,a=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new M.Z).get().fetch("/api/rapports/"+this.state.id);case 2:(e=t.sent).error?this.setState({remaning:0}):(n=C()(e.data.lastData.date).add({second:e.data.interval}),this.idInterval=setInterval((function(){var t=n.diff(C()(),"second");a.setState({remaning:t,percent:100-100*t/e.data.interval,loading:!1}),t<0&&(a.setState({remaning:0,loading:!0}),clearInterval(a.idInterval),t>-3600&&setTimeout((function(){a.props.onRefresh(),a.componentDidMount()}),2e3))}),1e3));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){clearInterval(this.idInterval)}},{key:"getOption",value:function(){return{series:[this.state.percent],chart:{height:350,type:"radialBar"},plotOptions:{radialBar:{hollow:{size:"55%"},track:{background:"rgba(255,255,255,0.20)"},dataLabels:{name:{offsetY:8,color:"rgba(255,255,255,0.8)",fontSize:24,fontWeight:600},value:{show:!1},total:{show:!1}}}},colors:["rgba(255,255,255,0.8)"],labels:[C()().set({hour:0,minute:0,second:1}).set({seconds:this.state.remaning}).format("HH:mm:ss")],title:{text:"Next acquisition",align:"center",style:{color:"#ffffff",fontSize:18,fontWeight:500,fontFamily:"Poppins,sans-serif"}},fill:{type:"gradient",gradient:{gradientToColors:["rgba(255,255,255,0.8)","rgba(255,255,255,1)"]}}}}},{key:"render",value:function(){return(0,S.jsx)(g.ZP,{item:!0,xs:12,md:12,lg:4,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{padding:10},children:this.state.loading?(0,S.jsx)(Z.Z,{style:{justifyContent:"center",display:"flex",marginTop:75,marginBottom:50},children:(0,S.jsx)(j.Z,{variant:"circular",height:230,width:230})}):(0,S.jsx)(D.Z,{options:this.getOption(),series:[this.state.percent],type:"radialBar",height:354})})})}}]),n}(u.Component),R=F,z=n(4369),P=function(t){(0,o.Z)(n,t);var e=(0,l.Z)(n);function n(t){var a;return(0,r.Z)(this,n),(a=e.call(this,t)).INTERVALS=[{name:"1H",durationFormat:"DD/MM/YY HH:mm",start:C()().subtract({hour:1}).valueOf(),end:C()().valueOf(),intervalObject:{hour:1},intervalMinimum:900},{name:"1D",durationFormat:"DD/MM/YY",start:C()().subtract({day:1}).valueOf(),end:C()().valueOf(),intervalObject:{day:1},intervalMinimum:14e3},{name:"1W",durationFormat:"DD/MM/YY",start:C()().subtract({week:1}).valueOf(),end:C()().valueOf(),intervalObject:{week:1},intervalMinimum:1/0},{name:"1M",durationFormat:"DD/MM/YY",start:C()().subtract({month:1}).valueOf(),end:C()().valueOf(),intervalObject:{month:1},intervalMinimum:1/0},{name:"1Y",durationFormat:"DD/MM/YY",start:C()().subtract({year:1}).valueOf(),end:C()().valueOf(),intervalObject:{year:1},intervalMinimum:1/0}],a.state={id:t.match.params.id,loading:!0,rapport:{configuration:{module:"module",name:""},reference:""},data:[],start:C()().valueOf(),end:C()().valueOf(),filter:a.INTERVALS[0],availableFilters:[]},t.setTitle("Rapport"),t.setActionType("return"),a}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){var t=(0,i.Z)(d().mark((function t(){var e,n,a=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new M.Z).get().fetch("/api/rapports/"+this.state.id);case 2:(e=t.sent).error?(this.props.setMessage(e.package+" : "+e.message),this.props.history.push("/rapport")):(n=this.getIntervals(e.data),this.setState({availableFilters:n,rapport:e.data,filter:n[0],start:n[0].start,end:n[0].end},(function(){a.update()})));case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getIntervals",value:function(t){var e=[];return this.INTERVALS.forEach((function(n){n.intervalMinimum>t.interval&&e.push(n)})),e}},{key:"update",value:function(){var t=(0,i.Z)(d().mark((function t(){var e;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new M.Z).get().fetch("/api/rapports/"+this.state.id+"/data/"+this.state.start+"/"+this.state.end);case 2:(e=t.sent).error?(this.props.setMessage(e.package+" : "+e.message),this.props.history.push("/rapport")):this.setState({loading:!1,data:e.data.map((function(t){return[t.date,t.value]}))});case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"delete",value:function(){var t=(0,i.Z)(d().mark((function t(){var e;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new M.Z).delete({}).fetch("/api/rapports/"+this.state.id);case 2:(e=t.sent).error?this.props.setMessage(e.package+" : "+e.message):this.props.history.push("/rapport");case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"truncate",value:function(){var t=(0,i.Z)(d().mark((function t(){var e;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new M.Z).patch({}).fetch("/api/rapports/"+this.state.id);case 2:(e=t.sent).error?this.props.setMessage(e.package+" : "+e.message):this.update();case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"nextDuration",value:function(){var t=this,e=C()(this.state.start).add(this.state.filter.intervalObject).valueOf(),n=C()(this.state.end).add(this.state.filter.intervalObject).valueOf();this.setState({start:e,end:n},(function(){t.update()}))}},{key:"previousDuration",value:function(){var t=this,e=C()(this.state.start).subtract(this.state.filter.intervalObject).valueOf(),n=C()(this.state.end).subtract(this.state.filter.intervalObject).valueOf();this.setState({start:e,end:n},(function(){t.update()}))}},{key:"render",value:function(){var t=this,e={chart:{id:"basic-bar",zoom:{enabled:!1},toolbar:{show:!1},offsetX:-5,animations:{enabled:!0,easing:"easeout",animateGradually:{enabled:!0}}},grid:{show:!1},xaxis:{type:"datetime",axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!0,style:{colors:"rgba(255, 255, 255, 0.7)",fontSize:14,fontWeight:400,fontFamily:"Poppins,sans-serif"}}},yaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},dataLabels:{enabled:!1},tooltip:{enabled:!0,theme:"dark",x:{formatter:function(t){return C()(t).format("HH:mm - DD/MM/YY")}}},title:{text:String.capitalizeFirstLetter(this.state.rapport.reference),align:"center",style:{color:"#ffffff",fontWeight:500,fontSize:18,fontFamily:"Poppins,sans-serif"}},subtitle:{text:String.capitalizeFirstLetter("smartobject"==this.state.rapport.configuration.module?this.state.rapport.smartobject.reference:""),align:"center",style:{color:"rgba(255, 255, 255, 0.7)",fontSize:14,fontWeight:400,fontFamily:"Poppins,sans-serif"}},noData:{text:"No data",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:"rgba(255, 255, 255, 0.7)",fontSize:16,fontWeight:400,fontFamily:"Poppins,sans-serif"}},stroke:{width:this.props.isMobile?3:5,curve:"smooth"},colors:["rgba(255,255,255,0.8)"],fill:{type:"gradient",gradient:{gradientToColors:["rgba(255,255,255,0.8)","rgba(255,255,255,0.8)"]}}};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(w.Z,(0,a.Z)((0,a.Z)({},this.props),{},{children:(0,S.jsxs)(x.Z,{variant:"outlined",style:{padding:12,marginBottom:10,justifyContent:"left"},children:[(0,S.jsx)(m.Z,{variant:"h6",fontWeight:"bold",children:"Rapport"}),(0,S.jsx)(m.Z,{variant:"subtitle2",color:"text.secondary",children:"Show what you need"})]})})),(0,S.jsxs)(g.ZP,{container:!0,spacing:1,children:[(0,S.jsx)(g.ZP,{item:!0,xs:12,md:6,lg:4,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{display:"flex"},children:0==this.state.availableFilters.length?(0,S.jsx)(Z.Z,{style:{paddingLeft:20,paddingRight:20},children:(0,S.jsx)(j.Z,{height:25})}):this.state.availableFilters.map((function(e,n){var a=e.name==t.state.filter.name;return(0,S.jsx)(b.Z,{style:{flex:1,display:"flex",justifyContent:"center",borderRadius:0},size:"large",color:"inherit",onClick:function(){t.setState({filter:e,start:e.start,end:e.end},(function(){t.update()}))},children:(0,S.jsx)(m.Z,{style:{fontWeight:a?600:"normal"},color:a?"":"text.secondary",children:e.name})},n)}))})}),(0,S.jsx)(g.ZP,{item:!0,xs:12,md:6,lg:4,children:(0,S.jsxs)(y.Z,{variant:"outlined",style:{display:"flex",justifyContent:"space-around"},children:[(0,S.jsx)(k.Z,{style:{flex:1,borderRadius:0},onClick:function(){t.previousDuration()},children:(0,S.jsx)(h.Z,{})}),(0,S.jsx)(m.Z,{style:{flex:5,alignSelf:"center"},textAlign:"center",color:"text.secondary",variant:this.props.isMobile?"body2":"subtitle2",children:C()(this.state.start).format(this.state.filter.durationFormat)+" - "+C()(this.state.end).format(this.state.filter.durationFormat)}),(0,S.jsx)(k.Z,{style:{flex:1,borderRadius:0},onClick:function(){t.nextDuration()},children:(0,S.jsx)(f.Z,{})})]})}),(0,S.jsxs)(w.Z,(0,a.Z)((0,a.Z)({},this.props),{},{children:[(0,S.jsx)(g.ZP,{item:!0,xs:12,md:1,lg:2,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{height:"100%",width:"100%",display:"flex",justifyContent:"center"},children:(0,S.jsx)(m.Z,{style:{alignSelf:"center"},textAlign:"center",variant:"subtitle2"})})}),(0,S.jsx)(g.ZP,{item:!0,xs:6,md:1,lg:1,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{display:"flex",justifyContent:"center"},children:(0,S.jsx)(k.Z,{style:{flex:1,display:"flex",borderRadius:0},onClick:function(){t.truncate()},children:(0,S.jsx)(p.Z,{color:"text.secondary"})})})}),(0,S.jsx)(g.ZP,{item:!0,xs:6,md:1,lg:1,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{display:"flex",justifyContent:"center"},children:(0,S.jsx)(k.Z,{style:{flex:1,display:"flex",borderRadius:0},onClick:function(){t.delete()},children:(0,S.jsx)(v.Z,{})})})})]})),(0,S.jsx)(g.ZP,{item:!0,xs:12,md:12,lg:8,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{paddingTop:10,paddingLeft:10,paddingRight:15},children:this.state.loading?(0,S.jsxs)(Z.Z,{style:{paddingLeft:20,paddingRight:20,paddingBottom:20},children:[(0,S.jsx)(j.Z,{height:25}),(0,S.jsx)(j.Z,{style:{marginTop:10},height:20}),(0,S.jsx)(j.Z,{style:{marginTop:30},variant:"rectangular",height:260})]}):(0,S.jsx)(D.Z,{options:e,series:[{name:this.state.rapport.reference,data:this.state.data}],type:"line",height:350})})}),(0,S.jsx)(R,{id:this.state.id,onRefresh:function(){t.update()}}),(0,S.jsxs)(z.Z,(0,a.Z)((0,a.Z)({},this.props),{},{children:[(0,S.jsx)(g.ZP,{item:!0,xs:6,md:1,lg:1,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{display:"flex",justifyContent:"center"},children:(0,S.jsx)(k.Z,{style:{flex:1,display:"flex",borderRadius:0},onClick:function(){t.truncate()},children:(0,S.jsx)(p.Z,{color:"text.secondary"})})})}),(0,S.jsx)(g.ZP,{item:!0,xs:6,md:1,lg:1,children:(0,S.jsx)(y.Z,{variant:"outlined",style:{display:"flex",justifyContent:"center"},children:(0,S.jsx)(k.Z,{style:{flex:1,display:"flex",borderRadius:0},onClick:function(){t.delete()},children:(0,S.jsx)(v.Z,{})})})})]}))]})]})}}]),n}(u.Component),Y=P},8820:function(t,e,n){var a=n(4223),i=n(184);e.Z=(0,a.Z)((0,i.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos")},7103:function(t,e,n){var a=n(4223),i=n(184);e.Z=(0,a.Z)((0,i.jsx)("path",{d:"M16 11h-1V3c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v8H8c-2.76 0-5 2.24-5 5v7h18v-7c0-2.76-2.24-5-5-5zm3 10h-2v-3c0-.55-.45-1-1-1s-1 .45-1 1v3h-2v-3c0-.55-.45-1-1-1s-1 .45-1 1v3H9v-3c0-.55-.45-1-1-1s-1 .45-1 1v3H5v-5c0-1.65 1.35-3 3-3h8c1.65 0 3 1.35 3 3v5z"}),"CleaningServices")},5397:function(t,e,n){var a=n(4223),i=n(184);e.Z=(0,a.Z)((0,i.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")}}]);
//# sourceMappingURL=231.0526bbf2.chunk.js.map