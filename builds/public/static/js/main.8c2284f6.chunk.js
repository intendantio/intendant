(this["webpackJsonp@intendant/dashboard"]=this["webpackJsonp@intendant/dashboard"]||[]).push([[0],{349:function(e,t,n){"use strict";n.r(t);var a=n(2),s=n.n(a),i=n(23),r=n.n(i),c=n(30),o=n(5),l=n.n(o),d=n(9),u=n(11),h=n(12),j=n(14),b=n(13),p=n(88),g=n(207),f=n(428),m=n(405),x=n(193),v=n(423),O=n(425),y=n(0);var w=function(e){return Object(y.jsx)(O.a,{open:e.open,autoHideDuration:6e3,onClose:function(){return e.onClose()},children:Object(y.jsx)(v.a,Object(x.a)({severity:e.severity,elevation:6,variant:"filled"},e))})},S=n(20),k=n(89),C=n.n(k),T=n(138),D=n(69),R=n(394),M=n(395),A=n(396),I=n(397),P=n(398),B=n(399),E=n(352),L=n(422),z=(n(22),n(148),function(){function e(){Object(u.a)(this,e),this.method="GET"}return Object(h.a)(e,[{key:"post",value:function(e){return this.method="POST",this.data=e,this}},{key:"get",value:function(){return this.method="GET",this}},{key:"delete",value:function(){return this.method="DELETE",this}},{key:"put",value:function(e){return this.method="PUT",this.data=e,this}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("authorization"),a=localStorage.getItem("server"),e.prev=2,e.next=5,fetch(a+t,{method:this.method,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n},body:"POST"==this.method||"PUT"==this.method?JSON.stringify(this.data):null});case 5:return s=e.sent,e.next=8,s.json();case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",{error:!0,message:"An error has occurred",package:p.name});case 14:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}())}]),e}());var W=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",smartobjects:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/smartobjects");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({enabled:!1,message:"",smartobjects:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)(y.Fragment,{children:[this.state.loading?Object(y.jsx)(g.a,{style:{display:"flex",padding:10,alignContent:"center",justifyContent:"center",alignItems:"center",alignSelf:"center"},children:Object(y.jsx)(D.a,{variant:"subtitle1",style:{fontSize:18},children:"Chargement des smartobject"})}):Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Reference"})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:"Status"})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:"Localisation"})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:"Last use"})})]})}),Object(y.jsx)(B.a,{children:this.state.smartobjects.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(y.jsx)(S.b,{to:"/smartobject/"+e.id,style:{textDecoration:"none",color:"white",display:"contents"},children:Object(y.jsxs)(I.a,{hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.reference})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:Object(y.jsx)("img",{style:{height:25,width:25,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/"+e.status.icon+".svg"})})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:(t=e.localisation.name,t.charAt(0).toUpperCase()+t.slice(1))})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:C()(e.lastUse).format("hh:mm DD/MM")})})]},e.name)});var t}))})]})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/smartobject/new",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:Object(y.jsx)(T.a,{})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.smartobjects.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),N=n(51),F=n.n(N),J=n(409),U=n(406),V=n(429),_=n(421),H=n(400),Q=n(353),q=n(410),G=n(411),K=n(151),X=n(144),Y=n(143),Z=n(354),$=n(408),ee=n(431),te=n(424),ne=n(203),ae=n(140),se=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={value:"",sunday:!1,monday:!1,tuesday:!1,wednesday:!1,friday:!1,saturday:!1,time:"00:00"},a}return Object(h.a)(n,[{key:"calculate",value:function(){var e=this.state.time.split(":");if(2==e.length){var t=e[1]+" "+e[0]+" * * "+(this.state.sunday?"0,":"")+(this.state.monday?"1,":"")+(this.state.tuesday?"2,":"")+(this.state.wednesday?"3,":"")+(this.state.thursday?"4,":"")+(this.state.friday?"5,":"")+(this.state.saturday?"6,":"");t=t.slice(0,t.length-1),this.props.onChange(t)}}},{key:"render",value:function(){var e=this;return Object(y.jsx)("div",{style:{display:"flex",paddingTop:10,paddingBottom:10,paddingLeft:5,paddingRight:5,flexDirection:"column"},children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignContent:"center",alignItems:"center",flex:1,justifyContent:"space-between"},children:[this.props.noChangeMode?null:Object(y.jsx)("div",{style:{flex:1},children:Object(y.jsx)(E.a,{size:"small",onClick:function(){e.props.onChangeMode()},variant:"outlined",children:Object(y.jsx)(ae.a,{})})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(m.a,{fullWidth:!0,size:"small",variant:this.state.sunday?"contained":"outlined",onClick:function(){e.setState({sunday:!e.state.sunday},(function(){e.calculate()}))},children:"Sunday"})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(m.a,{fullWidth:!0,size:"small",variant:this.state.monday?"contained":"outlined",onClick:function(){e.setState({monday:!e.state.monday},(function(){e.calculate()}))},children:"Monday"})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(m.a,{fullWidth:!0,size:"small",variant:this.state.tuesday?"contained":"outlined",onClick:function(){e.setState({tuesday:!e.state.tuesday},(function(){e.calculate()}))},children:"Tuesday"})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(m.a,{fullWidth:!0,size:"small",variant:this.state.wednesday?"contained":"outlined",onClick:function(){e.setState({wednesday:!e.state.wednesday},(function(){e.calculate()}))},children:"Wednesday"})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(m.a,{fullWidth:!0,size:"small",variant:this.state.thursday?"contained":"outlined",onClick:function(){e.setState({thursday:!e.state.thursday},(function(){e.calculate()}))},children:"Thursday"})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(m.a,{fullWidth:!0,size:"small",variant:this.state.friday?"contained":"outlined",onClick:function(){e.setState({friday:!e.state.friday},(function(){e.calculate()}))},children:"Friday"})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(m.a,{fullWidth:!0,size:"small",variant:this.state.saturday?"contained":"outlined",onClick:function(){e.setState({saturday:!e.state.saturday},(function(){e.calculate()}))},children:"Saturday"})}),Object(y.jsx)("div",{style:{flex:3,textAlign:"center",marginRight:2,marginLeft:2},children:Object(y.jsx)(f.a,{defaultValue:"00:00",size:"small",value:this.state.time,onChange:function(t){e.setState({time:t.currentTarget.value},(function(){e.calculate()}))},placeholder:"hh:mm",variant:"outlined"})})]})})}}]),n}(s.a.Component),ie=n(430),re=n(204),ce=n(101),oe=n(407),le=Object(ie.a)(Object(re.a)({palette:{type:"dark",primary:{main:ce.a[600]},secondary:{main:oe.a[500]}},typography:{fontFamily:"'Poppins', sans-serif",fontWeightLight:400,fontWeightRegular:500,fontWeightMedium:600},shape:{borderRadius:4}})),de={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:le.palette.background.paper,padding:10,borderRadius:5},ue=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={action:a.props.action,setState:a.props.setState,modal:!1,value:a.props.action.default},a}return Object(h.a)(n,[{key:"updateAction",value:function(e,t){var n={};n["argument-"+e.id]=t,this.state.setState(n),this.setState({value:t})}},{key:"render",value:function(){var e=this;switch(this.state.action.type){case"text":return Object(y.jsx)("div",{elevation:3,style:{alignItems:"center",display:"flex",marginRight:10,minWidth:"150px"},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:"default"==this.state.action.id?"":this.state.action.id,onChange:function(t){e.updateAction(e.state.action,t.currentTarget.value)}})});case"cron":return Object(y.jsxs)("div",{elevation:3,style:{alignItems:"center",display:"flex",marginRight:10,width:"200px"},children:[Object(y.jsx)(Z.a,{open:this.state.modal,onClose:function(){e.setState({modal:!1})},children:Object(y.jsx)($.a,{in:this.state.modal,children:Object(y.jsx)(g.a,{style:de,children:Object(y.jsx)(se,{noChangeMode:!0,onChange:function(t){e.updateAction(e.state.action,t),e.setState({value:t})},onChangeMode:function(){}})})})}),Object(y.jsx)(m.a,{variant:"outlined",style:{flexDirection:"column",width:"200px"},size:"large",onClick:function(){e.setState({modal:!0})},children:Object(y.jsx)(D.a,{style:{fontSize:this.state.value.length>0?12:14,padding:8,color:this.state.value.length>0?"white":"rgba(255, 255, 255, 0.6)"},children:0==this.state.value.length?"default"==this.state.action.id?"":this.state.action.id:this.state.value})})]});case"number":return Object(y.jsx)("div",{elevation:3,style:{alignItems:"center",display:"flex",marginRight:10,minWidth:"150px"},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:this.state.action.id,onChange:function(t){e.updateAction(e.state.action,t.currentTarget.value)}})});case"select":return Object(y.jsx)("div",{elevation:3,style:{alignItems:"center",display:"flex",marginRight:10},children:Object(y.jsxs)(U.a,{variant:"outlined",style:{width:"150px"},children:["default"==this.state.action.id?null:Object(y.jsx)(V.a,{children:this.state.action.id}),Object(y.jsx)(_.a,{onChange:function(t){e.updateAction(e.state.action,t.target.value)},label:"default"==this.state.action.id?null:this.state.action.id,children:this.state.action.values.map((function(e){return Object(y.jsx)(H.a,{value:e,children:e})}))})]})});case"colorpicker":return Object(y.jsx)("div",{elevation:3,style:{alignItems:"flex-start",display:"flex",padding:10,marginRight:5,flexDirection:this.props.flexDirection?this.props.flexDirection:"row"},children:Object(y.jsx)(ne.a,{styles:{padding:0},colors:["#d00a0a","#FF6900","#FCB900","#F9DE79","#F78DA7","#9900EF","#0e60f4","#8ED1FC","#11f4b8","#53b909"],triangle:"hide",color:this.state.value,onChangeComplete:function(t){e.updateAction(e.state.action,t.hex)}})});case"slider":return Object(y.jsxs)("div",{elevation:3,style:{minWidth:100,height:"fit-content",alignSelf:"flex-start",borderWidth:1,borderStyle:"solid",borderRadius:5,borderColor:"rgba(255, 255, 255, 0.23)",alignItems:"center",justifyContent:"center",display:"flex",flexDirection:this.props.flexDirection?this.props.flexDirection:"row",paddingTop:10,paddingBottom:10,paddingLeft:15,paddingRight:15,marginRight:10},children:["default"==this.state.action.id?null:Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(D.a,{variant:"body1",style:{textAlign:"center",color:"rgba(255, 255, 255, 0.5)",padding:0},children:this.state.action.id}),Object(y.jsx)("div",{style:{marginBottom:2,marginTop:2}})]}),Object(y.jsx)(ee.a,{defaultValue:0,valueLabelDisplay:"auto",orientation:this.props.orientation?this.props.orientation:"horizontal",min:this.state.action.min,max:this.state.action.max,step:this.state.action.step,onChange:function(t,n){e.updateAction(e.state.action,n)}})]});case"checkbox":return Object(y.jsxs)("div",{elevation:3,style:{height:"fit-content",alignSelf:"center",borderWidth:1,borderStyle:"solid",borderRadius:5,borderColor:"rgba(255, 255, 255, 0.23)",alignItems:"center",justifyContent:"center",display:"flex",flexDirection:this.props.flexDirection?this.props.flexDirection:"row",paddingTop:10,paddingBottom:10,paddingLeft:15,paddingRight:15,marginRight:10},children:["default"==this.state.action.id?null:Object(y.jsx)(D.a,{variant:"body1",style:{textAlign:"center",color:"rgba(255, 255, 255, 0.5)",padding:0},children:this.state.action.id}),Object(y.jsx)(te.a,{defaultChecked:this.state.action.default,color:"primary",onChange:function(t,n){e.updateAction(e.state.action,n)}})]});default:return null}}}]),n}(s.a.Component),he=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={id:e.match.params.id,smartobject:null,profiles:[],localisations:[],enabled:!1,loading:null,message:"",referenceArguments:"",valueArguments:"",executeInformation:""},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/profiles");case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/localisations");case 5:return n=e.sent,e.next=8,(new z).get().fetch("/api/smartobjects/"+this.state.id);case 8:a=e.sent,t.error||a.error||n.error?this.props.history.push("/smartobject"):this.setState({smartobject:a.data,profiles:t.data,localisations:n.data}),this.setState({loading:null});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/smartobjects/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.props.history.push("/smartobject");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"executeAction",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,s,i,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.setState({loading:t}),a={},s=0;s<n.length;s++)i=n[s],void 0==(r=this.state["argument-"+i.id])&&(r=i.default),a[i.id]=r;return e.next=5,(new z).post({settings:a}).fetch("/api/smartobjects/"+this.state.id+"/actions/"+t);case 5:(c=e.sent).error?this.setState({enabled:!0,message:c.package+" : "+c.message,loading:null}):(c.data&&this.setState({executeInformation:JSON.stringify(c.data)}),this.componentDidMount());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteSmartobjectArguments",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/smartobjects/"+t.smartobject+"/arguments/"+t.id);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertSmartobjectArguments",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).post({reference:n,value:a}).fetch("/api/smartobjects/"+t+"/arguments");case 2:(s=e.sent).error?this.setState({enabled:!0,message:s.package+" : "+s.message}):(this.setState({referenceArguments:"",valueArguments:""}),this.componentDidMount());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"insertProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).post({idProfile:n.id}).fetch("/api/smartobjects/"+t.id+"/profiles");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/smartobjects/"+t.id+"/profiles/"+n.id);case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateLocalisation",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).post({idLocalisation:n.id}).fetch("/api/smartobjects/"+t.id+"/localisation");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setLocalisation",value:function(e){var t=this;this.state.localisations.forEach((function(n){n.id===e&&(t.state.smartobject.localisation=n,t.updateLocalisation(t.state.smartobject,n))}))}},{key:"render",value:function(){var e=this;return this.state.smartobject?Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,marginBottom:10,justifyContent:"left"},children:[Object(y.jsxs)("div",{style:{padding:10},children:[Object(y.jsx)(D.a,{variant:"h4",children:this.state.smartobject.reference}),Object(y.jsx)(D.a,{variant:"subtitle1",children:this.state.smartobject.module})]}),Object(y.jsx)(J.a,{}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Configuration"}),Object(y.jsx)("div",{style:{marginTop:10,marginBottom:10,display:"flex",flexDirection:"row"},children:Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(B.a,{children:[this.state.smartobject.arguments.map((function(t){return Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:t.reference})}),Object(y.jsx)(P.a,{align:"left",style:{width:"70%"},children:Object(y.jsx)(D.a,{variant:"subtitle1",children:t.value.slice(0,50)+(t.value.length>50?" (...)":"")})}),Object(y.jsx)(P.a,{align:"right",style:{padding:4},children:Object(y.jsx)(E.a,{onClick:function(){navigator.clipboard.writeText(t.value)},style:{borderRadius:5,margin:0},children:Object(y.jsx)(K.a,{})})}),Object(y.jsx)(P.a,{align:"right",style:{padding:4},children:Object(y.jsx)(E.a,{onClick:function(){e.deleteSmartobjectArguments(t)},style:{borderRadius:5,margin:0},children:Object(y.jsx)(X.a,{})})})]},t.id)})),Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(f.a,{value:this.state.referenceArguments,onChange:function(t){e.setState({referenceArguments:t.nativeEvent.target.value})},placeholder:"Name",style:{width:"100%"}})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(f.a,{value:this.state.valueArguments,onChange:function(t){e.setState({valueArguments:t.nativeEvent.target.value})},placeholder:"Value",style:{width:"100%"}})}),Object(y.jsx)(P.a,{align:"right",style:{padding:4},children:Object(y.jsx)(E.a,{onClick:function(){e.insertSmartobjectArguments(e.state.smartobject.id,e.state.referenceArguments,e.state.valueArguments)},style:{borderRadius:5,margin:0},children:Object(y.jsx)(T.a,{})})})]},"-1")]})})})]}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Action"}),this.state.smartobject.actions.map((function(t){return Object(y.jsxs)(g.a,{style:{padding:10,marginTop:10,marginBottom:10,display:"flex",flexDirection:"column",width:"100%",maxWidth:"100%"},children:[Object(y.jsx)(m.a,{disabled:e.state.loading==t.id,onClick:function(){e.executeAction(t.id,t.settings)},variant:e.state.loading==t.id?"contained":"outlined",style:{width:"250px",height:"100%"},children:t.name}),t.settings.length>0?Object(y.jsx)("div",{style:{display:"grid",gridRowGap:"10px",gridTemplateColumns:"repeat(5,min-content)",marginTop:10,marginBottom:10},children:t.settings.map((function(t){return Object(y.jsx)(ue,{flexDirection:"column",orientation:"horizontal",setState:e.setState.bind(e),action:t})}))}):null]})}))]}),this.state.executeInformation.length>0?Object(y.jsx)("div",{style:{padding:10},children:Object(y.jsx)(v.a,{severity:"success",action:Object(y.jsx)(E.a,{onClick:function(){e.setState({executeInformation:""})},style:{alignSelf:"start"},color:"inherit",size:"small",children:Object(y.jsx)(Y.a,{})}),children:Object(y.jsx)(F.a,{id:"json-pretty",data:JSON.parse(this.state.executeInformation)})})}):null,Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Localisation"}),Object(y.jsx)("div",{style:{marginTop:20,marginBottom:10,display:"flex",flexDirection:"row"},children:Object(y.jsxs)(U.a,{variant:"outlined",style:{marginRight:10,width:"300px"},children:[Object(y.jsx)(V.a,{children:"Localisation"}),Object(y.jsx)(_.a,{value:this.state.smartobject.localisation.id,onChange:function(t){e.setLocalisation(t.target.value)},label:"Connexion",children:this.state.localisations.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]})})]}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Authorization"}),this.state.profiles.map((function(t){var n=!1;return e.state.smartobject.profiles.forEach((function(e){e.profile==t.id&&(n=!0)})),Object(y.jsx)(Q.a,{style:{padding:1},children:Object(y.jsx)(q.a,{control:Object(y.jsx)(G.a,{checked:n,onChange:function(){n?e.deleteProfile(e.state.smartobject,t):e.insertProfile(e.state.smartobject,t)},color:"primary"}),label:t.name})})}))]})]}),Object(y.jsx)(g.a,{style:{width:"min-content",marginTop:10,marginBottom:10,alignContent:"center",justifyContent:"center",alignSelf:"center"},children:Object(y.jsx)(E.a,{onClick:function(){e.delete(e.state.id)},style:{borderRadius:5},children:Object(y.jsx)(X.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),je=n(159),be=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={module:!1,localisation:!1,reference:"",enabled:!1,message:"",types:[],smartobjects:[],localisations:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/configurations/smartobject");case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/localisations");case 5:return n=e.sent,e.next=8,(new z).get().fetch("/api/smartobjects");case 8:a=e.sent,t.error||a.error||n.error?this.setState({enabled:!0,message:a.message+" : "+t.message+" : "+n.message}):this.setState({enabled:!1,message:"",types:t.data,smartobjects:a.data,localisations:n.data});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setModule",value:function(e){var t=this;this.state.types.forEach((function(n){n.name===e&&t.setState({module:n})}))}},{key:"setLocalisation",value:function(e){var t=this;this.state.localisations.forEach((function(n){n.id===e&&t.setState({localisation:n})}))}},{key:"updateSettings",value:function(e,t){var n={};n["settings-"+e]=t,this.setState(n)}},{key:"add",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.reference){e.next=4;break}this.setState({enabled:!0,message:"Missing-parameter : reference is empty"}),e.next=18;break;case 4:if(!1!==this.state.localisation){e.next=8;break}this.setState({enabled:!0,message:"Missing-parameter : localisation not selected"}),e.next=18;break;case 8:if(""!==this.state.module.name){e.next=12;break}this.setState({enabled:!0,message:"Missing-parameter : type not selected"}),e.next=18;break;case 12:for(t=[],n=0;n<this.state.module.settings.length;n++)a=this.state.module.settings[n],t.push({reference:a.id,value:this.state["settings-"+a.name]?this.state["settings-"+a.name]:""});return e.next=16,(new z).post({localisation:this.state.localisation.id,module:this.state.module.name,reference:this.state.reference,settings:t}).fetch("/api/smartobjects");case 16:(s=e.sent).error?this.setState({enabled:!0,message:s.package+" : "+s.message}):this.props.history.push("/smartobject");case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between"},children:Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"start",flexDirection:"row",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(y.jsx)(f.a,{onChange:function(t){e.setState({reference:t.nativeEvent.target.value})},style:{width:"150px",marginRight:10},label:"Reference",variant:"outlined"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginRight:10,width:"300px"},children:[Object(y.jsx)(V.a,{children:"Module"}),Object(y.jsx)(_.a,{value:this.state.module.name,onChange:function(t){e.setModule(t.target.value)},label:"Connexion",children:this.state.types.map((function(e){return Object(y.jsx)(H.a,{value:e.name,children:e.name})}))})]}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginRight:10,width:"300px"},children:[Object(y.jsx)(V.a,{children:"Localisation"}),Object(y.jsx)(_.a,{value:this.state.localisation.name,onChange:function(t){e.setLocalisation(t.target.value)},label:"Connexion",children:this.state.localisations.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]})]})}),this.state.module?0===this.state.module.settings.length?null:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:10},children:[Object(y.jsx)(D.a,{variant:"body1",style:{fontSize:20},children:"Configuration"}),this.state.module.settings.map((function(t){return"smartobject"==t.type?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:10,width:"300px"},children:[Object(y.jsx)(V.a,{children:t.name}),Object(y.jsx)(_.a,{onChange:function(n){e.updateSettings(t.name,n.target.value)},children:e.state.smartobjects.filter((function(e){return e.module==t.reference})).map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.reference})}))})]}):"select"==t.type?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:10,width:"300px"},children:[Object(y.jsx)(V.a,{children:t.name}),Object(y.jsx)(_.a,{onChange:function(n){e.updateSettings(t.name,n.target.value)},children:t.values.map((function(e){return Object(y.jsx)(H.a,{value:e,children:e})}))})]}):Object(y.jsx)(f.a,{onChange:function(n){e.updateSettings(t.name,n.nativeEvent.target.value)},style:{width:"300px",marginTop:10},label:t.name,variant:"outlined"})}))]}):null]}),Object(y.jsx)(g.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(y.jsx)(E.a,{onClick:function(){e.add()},style:{borderRadius:0},variant:"outlined",children:Object(y.jsx)(je.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),pe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",processs:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/process");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({processs:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsx)(B.a,{children:this.state.processs.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(y.jsx)(S.b,{to:"/process/"+e.id,style:{textDecoration:"none",color:"white",display:"contents"},children:Object(y.jsxs)(I.a,{hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)("img",{style:{width:30,height:30,filter:"invert(100%)"},src:"/admin/ressource/icon/"+e.icon+".svg"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.reference})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.description})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.espace.reference})})]},e.name)})}))})})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/process/new",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:Object(y.jsx)(T.a,{})})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.processs.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),ge=n(413),fe=n(403),me=n(412),xe=n(154),ve=function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"getSource",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i,r,c,o=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:[],e.next=3,(new z).get().fetch("/api/smartobjects");case 3:return n=e.sent,e.next=6,(new z).get().fetch("/api/configurations/module");case 6:return a=e.sent,e.next=9,(new z).get().fetch("/api/process");case 9:return s=e.sent,e.next=12,(new z).get().fetch("/api/essentials");case 12:if(i=e.sent,!s.error){e.next=17;break}return e.abrupt("return",s);case 17:if(!a.error){e.next=21;break}return e.abrupt("return",a);case 21:if(!n.error){e.next=25;break}return e.abrupt("return",n);case 25:if(!i.error){e.next=29;break}return e.abrupt("return",i);case 29:return r=[],t.includes("smartobject")&&n.data.forEach((function(e){var t=[];e.actions.forEach((function(e){t.push({id:e.id,name:e.name,settings:e.settings})})),r.push({id:e.id,name:"Smartobject "+e.reference,actions:t,type:"smartobject"})})),t.includes("module")&&a.data.forEach((function(e){var t=[];e.actions.forEach((function(e){t.push({id:e.id,name:e.name,settings:e.settings})})),r.push({id:e.name,name:"Module "+e.name,actions:t,type:"module"})})),t.includes("essential")&&(c=[],i.data.forEach((function(e){c.push({id:e.id,name:e.name,settings:e.settings})})),r.push({id:"essential",name:"Core essential",actions:c,type:"essential"})),t.includes("process")&&s.data.forEach((function(e){var t=[];"simple"==e.mode?t.push({id:"auto",name:e.name,settings:e.inputs.map((function(e){return{id:e.reference,name:e.name,type:e.type}}))}):(t.push({id:"enable",name:e.name_enable,settings:e.inputs.map((function(e){return{id:e.reference,name:e.name,type:e.type}}))}),t.push({id:"disable",name:e.name_disable,settings:e.inputs.map((function(e){return{id:e.reference,name:e.name,type:e.type}}))})),r.push({id:e.id,name:"Processus "+e.reference,actions:t,type:"process"})})),e.abrupt("return",{data:r,error:!1,package:"",message:""});case 35:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Oe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={icons:[],mode:"normal"},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/admin/ressource/icon.json");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,this.setState({icons:n}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.setState({icons:[]});case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)(me.a,{container:!0,spacing:1,style:{width:"32vw",height:"32vw",padding:10,marginRight:10},children:[Object(y.jsx)(me.a,{item:!0,xs:6,children:Object(y.jsx)(g.a,{onClick:function(){e.setState({mode:"normal"})},style:{cursor:"pointer",display:"flex",justifyContent:"center",alignContent:"center",padding:5,alignItems:"center",alignSelf:"center"},children:Object(y.jsx)("img",{style:{height:30,width:30,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/star.svg"})})}),Object(y.jsx)(me.a,{item:!0,xs:6,children:Object(y.jsx)(g.a,{onClick:function(){e.setState({mode:"outline"})},style:{cursor:"pointer",display:"flex",justifyContent:"center",alignContent:"center",padding:5,alignItems:"center",alignSelf:"center"},children:Object(y.jsx)("img",{style:{height:30,width:30,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/star-outline.svg"})})}),this.state.icons.filter((function(t){return-1!=t.search("outline")&&"outline"==e.state.mode||-1==t.search("outline")&&"normal"==e.state.mode})).map((function(t){return Object(y.jsx)(me.a,{item:!0,xs:!0,children:Object(y.jsx)(g.a,{onClick:function(){e.props.onSelect&&e.props.onSelect(t)},style:{cursor:"pointer",display:"flex",justifyContent:"center",alignContent:"center",padding:5,alignItems:"center",alignSelf:"center"},children:Object(y.jsx)("img",{style:{height:30,width:30,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/"+t+".svg"})})})}))]})}}]),n}(s.a.Component),ye=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,popup:!1,message:"",espaces:[],reference:"",icon:"",description:"",name:"",name_disable:"",name_enable:"",mode:"simple",module:null,espace:!1,inputReference:"",inputName:"",inputType:null,inputMode:!1,inputs:[],sources:[],isChecked:!1,action:null,source:null,arrSources:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.getSource(["smartobject","module","essential"]);case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/espaces");case 5:n=e.sent,t.error?this.setState({enabled:!0,message:t.package+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.setState({enabled:!1,message:"",espaces:n.data,sources:t.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=!1;this.state.sources.forEach((function(n){n.id===e&&(t=n)})),this.setState({source:t})}},{key:"setAction",value:function(e){var t=!1;this.state.source.actions.forEach((function(n){n.id===e&&(t=n)})),this.setState({action:t})}},{key:"setInput",value:function(){if(""!==this.state.inputReference)if(""!==this.state.inputType)if(""!==this.state.inputName){var e=this.state.inputs;e.push({name:this.state.inputName,type:this.state.inputType,reference:this.state.inputReference,enable:this.state.inputMode?1:0}),this.setState({inputs:e,inputName:"",inputType:null,inputReference:"",inputMode:!1})}else this.setState({enabled:!0,message:"Name is missing"});else this.setState({enabled:!0,message:"Type is missing"});else this.setState({enabled:!0,message:"Reference is missing"})}},{key:"set",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.reference){e.next=3;break}return this.setState({enabled:!0,message:"Reference is missing"}),e.abrupt("return");case 3:if(""!==this.state.icon){e.next=6;break}return this.setState({enabled:!0,message:"Icon is missing"}),e.abrupt("return");case 6:if(""!==this.state.description){e.next=9;break}return this.setState({enabled:!0,message:"Description is missing"}),e.abrupt("return");case 9:if(!1!==this.state.espace){e.next=12;break}return this.setState({enabled:!0,message:"Espace is missing"}),e.abrupt("return");case 12:return t={description:this.state.description,nameEnable:this.state.name_enable,nameDisable:this.state.name_disable,name:this.state.name,espace:this.state.espace,sources:this.state.arrSources,reference:this.state.reference,icon:this.state.icon,mode:this.state.mode,inputs:this.state.inputs},e.next=15,(new z).post(t).fetch("/api/process");case 15:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.props.history.push("/process");case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateAction",value:function(e,t){var n={};n["argument-"+e.id]=t,this.setState(n)}},{key:"removeModeArgument",value:function(e){var t=[];this.state.inputs.forEach((function(n,a){e!==a&&t.push(n)})),this.setState({inputs:t})}},{key:"confirmationModule",value:function(){if(!1!==this.state.action)if(0!==this.state.source.actions.length){for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s={source:this.state.source,action:this.state.action,arguments:e,enable:this.state.isChecked},i=this.state.arrSources;i.push(s),this.setState({arrSources:i,action:null,source:null,isChecked:!1})}else this.setState({enabled:!0,message:"Module missing"});else this.setState({enabled:!0,message:"Action missing"})}},{key:"removeSource",value:function(e){var t=this,n=[];this.state.arrSources.forEach((function(t,a){e!==a&&n.push(t)})),this.setState({arrSources:[]},(function(){t.setState({arrSources:n})}))}},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(y.jsxs)("div",{style:{justifyContent:"start",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(y.jsx)(f.a,{onChange:function(t){e.setState({reference:t.nativeEvent.target.value})},style:{width:"20%",margin:10},label:"R\xe9ference",value:this.state.reference,variant:"outlined"}),Object(y.jsx)(f.a,{onChange:function(t){e.setState({icon:t.nativeEvent.target.value})},style:{width:"20%",margin:10},label:"Icon",variant:"outlined",value:this.state.icon,InputProps:{endAdornment:Object(y.jsx)(ge.a,{position:"end",children:Object(y.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(y.jsx)(xe.a,{})})})}}),Object(y.jsx)(fe.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(y.jsx)(Oe,{onSelect:function(t){e.setState({icon:t,popup:!1})}})}),Object(y.jsx)(f.a,{onChange:function(t){e.setState({description:t.nativeEvent.target.value})},style:{width:"50%",margin:10},label:"Description",variant:"outlined"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{margin:10,width:"150px"},children:[Object(y.jsx)(V.a,{children:"Espace"}),Object(y.jsx)(_.a,{onChange:function(t){e.setState({espace:t.target.value})},label:"Espace",children:this.state.espaces.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}),Object(y.jsx)(D.a,{variant:"h5",style:{margin:10},children:"Mode"}),Object(y.jsxs)(me.a,{style:{margin:10},container:!0,alignItems:"center",children:[Object(y.jsx)(me.a,{item:!0,children:Object(y.jsx)(D.a,{variant:"subtitle1",children:"Simple"})}),Object(y.jsx)(me.a,{item:!0,children:Object(y.jsx)(G.a,{checked:"switch"===this.state.mode,onChange:function(t,n){e.setState({mode:n?"switch":"simple"})},name:"checkedC"})}),Object(y.jsx)(me.a,{item:!0,children:Object(y.jsx)(D.a,{variant:"subtitle1",children:"Switch"})})]}),Object(y.jsx)(R.a,{style:{padding:10,margin:10},component:g.a,children:"switch"===this.state.mode?Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(y.jsx)(f.a,{onChange:function(t){e.setState({name_enable:t.nativeEvent.target.value})},style:{width:"45%",margin:10},label:"Texte actif",variant:"outlined"}),Object(y.jsx)(f.a,{onChange:function(t){e.setState({name_disable:t.nativeEvent.target.value})},style:{width:"45%",margin:10},label:"Texte passif",variant:"outlined"})]}):Object(y.jsx)("div",{children:Object(y.jsx)(f.a,{onChange:function(t){e.setState({name:t.nativeEvent.target.value})},style:{margin:10,width:"45%"},label:"Texte",variant:"outlined"})})}),Object(y.jsx)(D.a,{variant:"h5",style:{margin:10},children:"Argument"}),Object(y.jsxs)(R.a,{style:{padding:10,margin:10},component:g.a,children:[Object(y.jsx)(f.a,{value:this.state.inputReference,onChange:function(t){e.setState({inputReference:t.nativeEvent.target.value})},style:{width:"30%",margin:10},label:"Reference",variant:"outlined"}),Object(y.jsx)(f.a,{value:this.state.inputName,onChange:function(t){e.setState({inputName:t.nativeEvent.target.value})},style:{width:"30%",margin:10},label:"Name",variant:"outlined"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{margin:10,width:"25%"},children:[Object(y.jsx)(V.a,{children:"Type"}),Object(y.jsxs)(_.a,{value:this.state.inputType,onChange:function(t){e.setState({inputType:t.target.value})},label:"Type",children:[Object(y.jsx)(H.a,{value:"text",children:"Text"}),Object(y.jsx)(H.a,{value:"colorpicker",children:"Color picker"}),Object(y.jsx)(H.a,{value:"number",children:"Number"}),Object(y.jsx)(H.a,{value:"slider",children:"Slider"})]})]}),"switch"===this.state.mode?Object(y.jsx)(te.a,{onChange:function(t,n){e.setState({inputMode:n})}}):null,Object(y.jsx)(m.a,{style:{margin:10},onClick:function(){e.setInput()},variant:"outlined",children:"Ajouter"}),Object(y.jsx)(M.a,{children:Object(y.jsx)(B.a,{children:this.state.inputs.map((function(t,n){return Object(y.jsxs)(I.a,{onClick:function(){},hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.reference})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.name})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.type})}),"switch"===e.state.mode?Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(te.a,{disabled:!0,defaultChecked:t.mode})}):null,Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.removeModeArgument(n)},children:Object(y.jsx)(X.a,{})})})]})}))})})]}),Object(y.jsx)(D.a,{variant:"h5",style:{margin:10},children:"Action "}),Object(y.jsx)(R.a,{style:{padding:10,margin:10},component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsxs)(B.a,{children:[this.state.arrSources.map((function(t,n){return Object(y.jsxs)(I.a,{onClick:function(){},hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.source.name})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.action.name})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.arguments.map((function(e){return Object(y.jsx)(D.a,{variant:"body1",children:e.reference+" : "+e.value})}))})}),"simple"===e.state.mode?null:Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(te.a,{disabled:!0,defaultChecked:t.enable})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(E.a,{onClick:function(){e.removeSource(n)},children:Object(y.jsx)(X.a,{})})})]})})),Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",style:{minWidth:"30%"},children:Object(y.jsxs)(U.a,{fullWidth:!0,children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Connexion",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]})}),Object(y.jsx)(P.a,{align:"left",style:{width:"30%"},children:this.state.source?Object(y.jsxs)(U.a,{fullWidth:!0,children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Connexion",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null}),Object(y.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(y.jsx)("div",{}),this.state.action?this.state.action.settings.map((function(t){return Object(y.jsx)("div",{style:{marginLeft:10,marginRight:10,marginTop:5,marginBottom:2},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:t.id,onChange:function(n){e.updateAction(t,n.currentTarget.value,e.state.action)}})})})):null]}),"simple"===this.state.mode?null:Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(te.a,{onChange:function(t,n){e.setState({isChecked:n})}})})]}),Object(y.jsx)(m.a,{style:{margin:10},onClick:function(){e.confirmationModule()},variant:"outlined",children:"Ajouter"})]})})})]}),Object(y.jsx)(m.a,{style:{margin:10},onClick:function(){e.set()},variant:"outlined",children:"Save"})]}),Object(y.jsxs)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:[" ",this.state.message," "]})]})}}]),n}(s.a.Component),we=n(139),Se=n(142),ke=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={id:e.match.params.id,enabled:!1,message:"",process:null,profiles:[],executeInformation:"",referenceInput:"",nameInput:"",typeInput:null,modeInput:0,action:null,source:null,loading:!1,isChecked:!1,sources:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.getSource(["smartobject","module","essential"]);case 2:return t=e.sent,console.log(t),e.next=6,(new z).get().fetch("/api/espaces");case 6:return n=e.sent,e.next=9,(new z).get().fetch("/api/profiles");case 9:return a=e.sent,e.next=12,(new z).get().fetch("/api/process/"+this.state.id);case 12:s=e.sent,n.error?this.setState({enabled:!0,message:n.package+" : "+n.message}):s.error?this.setState({enabled:!0,message:s.package+" : "+s.message}):t.error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({process:s.data,profiles:a.data,espaces:n.data,sources:t.data}),this.setState({loading:null});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=!1;this.state.sources.forEach((function(n){n.id===e&&(t=n)})),this.setState({source:t})}},{key:"setAction",value:function(e){var t=!1;this.state.source.actions.forEach((function(n){n.id===e&&(t=n)})),this.setState({action:t})}},{key:"addSource",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.action){e.next=3;break}return this.setState({enabled:!0,message:"Action missing"}),e.abrupt("return");case 3:if(null!=this.state.source){e.next=6;break}return this.setState({enabled:!0,message:"Source missing"}),e.abrupt("return");case 6:for(t=[],n=0;n<this.state.action.settings.length;n++)a=this.state.action.settings[n],void 0==(s=this.state["argument-"+a.id])&&(s=a.default),t.push({reference:a.id,value:s});return i={source:this.state.source,action:this.state.action,arguments:t,enable:this.state.isChecked},e.next=11,(new z).post(i).fetch("/api/process/"+this.state.id+"/actions");case 11:(r=e.sent).error?this.setState({enabled:!0,message:r.package+" : "+r.message}):this.componentDidMount();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteSource",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/process/"+this.state.id+"/actions/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/process/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.props.history.push("/process");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"executeAction",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.setState({loading:!0}),t={},n=0;n<this.state.process.inputs.length;n++)a=this.state.process.inputs[n],void 0==(s=this.state["argument-"+a.id])&&(s=a.default),t[a.reference]=s;return e.next=5,(new z).post({inputs:t}).fetch("/api/process/"+this.state.process.id+"/execute");case 5:(i=e.sent).error?this.setState({loading:null,enabled:!0,message:i.package+" : "+i.message}):(i.data&&this.setState({executeInformation:JSON.stringify(i.data)}),this.componentDidMount());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"insertProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).post({idProfile:n.id}).fetch("/api/process/"+t.id+"/profiles");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/process/"+t.id+"/profiles/"+n.id);case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteProcessInput",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete({}).fetch("/api/process/"+this.state.process.id+"/inputs/"+t.id);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertProcessInput",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.typeInput){e.next=3;break}return this.setState({enabled:!0,message:"Missing-parameter : type is empty"}),e.abrupt("return");case 3:return e.next=5,(new z).post({reference:this.state.referenceInput,name:this.state.nameInput,type:this.state.typeInput,enable:this.state.modeInput}).fetch("/api/process/"+this.state.process.id+"/inputs");case 5:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):(this.setState({referenceSettings:"",valueSettings:"",referenceInput:"",nameInput:"",modeInput:0}),this.componentDidMount());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateAction",value:function(e,t){var n={};n["argument-"+e.id]=t,this.setState(n)}},{key:"render",value:function(){var e=this;return this.state.process?Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:25},children:[Object(y.jsx)(D.a,{variant:"h4",children:this.state.process.reference}),Object(y.jsx)(D.a,{variant:"subtitle1",children:this.state.process.espace.name}),Object(y.jsx)(D.a,{variant:"subtitle1",children:this.state.process.description}),Object(y.jsx)(J.a,{style:{marginTop:10,marginBottom:10}}),Object(y.jsxs)("div",{children:[Object(y.jsx)(D.a,{variant:"h5",style:{marginBottom:5},children:"Action"}),"simple"==this.state.process.mode?"simple"===this.state.process.mode?Object(y.jsx)(m.a,{disabled:this.state.loading,style:{alignSelf:"center",marginTop:10},variant:2===this.state.process.enable?"contained":"outlined",onClick:function(){e.executeAction()},color:"default",startIcon:Object(y.jsx)(we.a,{}),children:this.state.process.name}):null:Object(y.jsx)("div",{style:{flexDirection:"column",display:"flex",width:"20%"},children:1==this.state.process.enable?Object(y.jsx)(m.a,{disabled:this.state.loading,style:{marginTop:10},variant:"contained",onClick:function(){e.executeAction()},color:"default",children:this.state.process.name_enable}):Object(y.jsx)(m.a,{disabled:this.state.loading,style:{marginTop:10},variant:"outlined",onClick:function(){e.executeAction()},color:"default",children:this.state.process.name_disable})})]}),Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",marginTop:10,marginBottom:10},children:this.state.process.inputs.filter((function(t){return t.enable==e.state.process.enable})).map((function(t){return Object(y.jsx)(ue,{setState:e.setState.bind(e),action:t,flexDirection:"column",orientation:"horizontal"})}))}),Object(y.jsxs)("div",{style:{marginTop:15},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Input"}),Object(y.jsx)("div",{style:{flexDirection:"column",display:"flex",width:"100%",marginTop:10},children:Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsxs)(B.a,{children:[this.state.process.inputs.map((function(t){return Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.reference})}),Object(y.jsxs)(P.a,{align:"left",children:[Object(y.jsx)(D.a,{variant:"body1",children:t.name})," "]}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.type})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:t.enable})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(E.a,{onClick:function(){e.deleteProcessInput(t)},style:{borderRadius:5,margin:0},children:Object(y.jsx)(X.a,{})})})]},t.id)})),Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",style:{width:"35%"},children:Object(y.jsx)(f.a,{value:this.state.referenceInput,onChange:function(t){e.setState({referenceInput:t.nativeEvent.target.value})},placeholder:"Reference",style:{width:"100%"}})}),Object(y.jsx)(P.a,{align:"left",style:{width:"35%"},children:Object(y.jsx)(f.a,{value:this.state.nameInput,onChange:function(t){e.setState({nameInput:t.nativeEvent.target.value})},placeholder:"Name",style:{width:"100%"}})}),Object(y.jsx)(P.a,{align:"left",style:{width:"20%"},children:Object(y.jsxs)(U.a,{variant:"outlined",style:{width:"100%"},children:[Object(y.jsx)(V.a,{children:"Type"}),Object(y.jsxs)(_.a,{value:this.state.typeInput,onChange:function(t){e.setState({typeInput:t.target.value})},label:"Type",children:[Object(y.jsx)(H.a,{value:"text",children:"Text"}),Object(y.jsx)(H.a,{value:"colorpicker",children:"Color picker"}),Object(y.jsx)(H.a,{value:"number",children:"Number"}),Object(y.jsx)(H.a,{value:"slider",children:"Slider"})]})]})}),Object(y.jsx)(P.a,{align:"center",style:{width:"10%"},children:"switch"===this.state.process.mode?Object(y.jsx)(te.a,{value:0==this.state.modeInput,onChange:function(t,n){e.setState({modeInput:n?1:0})}}):null}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(E.a,{onClick:function(){e.insertProcessInput()},style:{borderRadius:5,margin:0},children:Object(y.jsx)(T.a,{})})})]},-1)]})})})})]}),Object(y.jsxs)("div",{style:{marginTop:15},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Module"}),Object(y.jsxs)("div",{style:{flexDirection:"column",display:"flex",width:"100%",marginTop:10},children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Module"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Type"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Action"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Arguments"})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:"Mode"})}),Object(y.jsx)(P.a,{align:"left"})]})}),Object(y.jsx)(B.a,{children:this.state.process.actions.map((function(t){return Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",style:{width:"15%"},children:Object(y.jsx)(D.a,{variant:"body1",children:t.object})}),Object(y.jsxs)(P.a,{align:"left",style:{width:"20%"},children:[Object(y.jsx)(D.a,{variant:"body1",children:t.type})," "]}),Object(y.jsx)(P.a,{align:"left",style:{width:"20%"},children:Object(y.jsx)(D.a,{variant:"body1",children:t.action})}),Object(y.jsx)(P.a,{align:"left",style:{width:"20%"},children:t.arguments.map((function(e){return Object(y.jsx)(D.a,{variant:"body1",children:e.reference+" : "+e.value})}))}),Object(y.jsx)(P.a,{align:"center",style:{width:"15%"},children:0===t.enable?Object(y.jsx)(Y.a,{}):1===t.enable?Object(y.jsx)(Se.a,{}):Object(y.jsx)(we.a,{})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(E.a,{onClick:function(){e.deleteSource(t.id)},children:Object(y.jsx)(X.a,{})})})]},t.id)}))})]})}),Object(y.jsx)(R.a,{style:{marginTop:15},component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",style:{width:"25%"},children:Object(y.jsxs)(U.a,{fullWidth:!0,children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Connexion",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]})}),Object(y.jsx)(P.a,{align:"left",style:{width:"25%"},children:this.state.source?Object(y.jsxs)(U.a,{fullWidth:!0,children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Connexion",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null}),Object(y.jsx)(P.a,{align:"left",style:{width:"20%"},children:this.state.action?this.state.action.settings.map((function(t){return Object(y.jsx)("div",{style:{marginLeft:10,marginRight:10,marginTop:5,marginBottom:2},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:t.id,onChange:function(n){e.updateAction(t,n.currentTarget.value,e.state.action)}})})})):null}),Object(y.jsx)(P.a,{align:"center",style:{width:"5%"},children:"switch"===this.state.process.mode?Object(y.jsx)(te.a,{onChange:function(t,n){e.setState({isChecked:n})}}):null}),Object(y.jsx)(P.a,{align:"center",style:{width:"5%"},children:Object(y.jsx)(E.a,{onClick:function(){e.addSource()},children:Object(y.jsx)(T.a,{})})})]})})})]})]}),this.state.executeInformation.length>0?Object(y.jsx)("div",{style:{padding:10},children:Object(y.jsx)(w,{severity:"success",action:Object(y.jsx)(E.a,{onClick:function(){e.setState({executeInformation:""})},style:{alignSelf:"start"},color:"inherit",size:"small",children:Object(y.jsx)(Y.a,{})}),children:Object(y.jsx)(F.a,{id:"json-pretty",data:JSON.parse(this.state.executeInformation)})})}):null,Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Authorization"}),this.state.profiles.map((function(t){var n=!1;return e.state.process.profiles.forEach((function(e){e.profile==t.id&&(n=!0)})),Object(y.jsx)(Q.a,{style:{padding:1},children:Object(y.jsx)(q.a,{control:Object(y.jsx)(G.a,{checked:n,onChange:function(){n?e.deleteProfile(e.state.process,t):e.insertProfile(e.state.process,t)},color:"primary"}),label:t.name})})}))]})]}),Object(y.jsx)(g.a,{style:{width:"min-content",marginTop:10,alignContent:"center",justifyContent:"center",alignSelf:"center"},children:Object(y.jsx)(E.a,{onClick:function(){e.delete(e.state.process.id)},style:{borderRadius:5},children:Object(y.jsx)(X.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),Ce=n(157),Te=n(155),De=n(147),Re=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,loading:!0,enabled:!1,message:"",routines:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/routines");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({enabled:!1,message:"",loading:!1,routines:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/routines/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"duplicate",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).put().fetch("/api/routines/"+t+"/duplicate");case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateStatus",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).put({status:n}).fetch("/api/routines/"+t+"/status");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsx)(B.a,{children:this.state.routines.slice(10*this.state.page,10*(this.state.page+1)).map((function(t){return Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)("img",{style:{width:30,height:30,filter:"invert(100%)"},src:"/admin/ressource/icon/"+t.icon+".svg"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.name})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsxs)("div",{style:{flex:1,flexDirection:"row",display:"flex",alignContent:"center",alignItems:"center",justifyContent:"end"},children:[Object(y.jsx)(E.a,{onClick:function(){e.updateStatus(t.id,0===t.status?1:0)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2,backgroundColor:1===t.status?le.palette.success.main:null},children:0===t.status?Object(y.jsx)(Ce.a,{}):Object(y.jsx)(Te.a,{})}),Object(y.jsx)(E.a,{onClick:function(){e.props.history.push("/routine/"+t.id)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2},children:Object(y.jsx)(De.a,{})}),Object(y.jsx)(E.a,{onClick:function(){e.duplicate(t.id)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2},children:Object(y.jsx)(K.a,{})}),Object(y.jsx)(E.a,{onClick:function(){e.delete(t.id)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2},children:Object(y.jsx)(X.a,{})})]})})]},t.id)}))})})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/routine/new",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:Object(y.jsx)(T.a,{})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.routines.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Me=n(414),Ae={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,backgroundColor:le.palette.background.paper,padding:10,borderRadius:5},Ie=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state=Object(c.a)({enabled:!1,message:"",routine:null,sources:[],mode:"counter",modalTrigger:!1,modalEffect:!1},"routine",{watch:1,triggers:[],effects:[],name:"",icon:""}),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.getSource(["smartobject","process","module","essential"]);case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({sources:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.setState({action:null,source:null,result:null,statement:null,expected:null})}},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"updateIcon",value:function(e){var t=this.state.routine;t.icon=e,this.setState({routine:t})}},{key:"updateName",value:function(e){var t=this.state.routine;t.name=e,this.setState({routine:t})}},{key:"updateWatch",value:function(e){var t=this.state.routine;t.watch=e,this.setState({routine:t})}},{key:"addTrigger",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.triggers.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e,result:this.state.result,statement:this.state.statement,expected:this.state.expected}),this.setState({routine:s,modalTrigger:!1,action:null,source:null,result:null,statement:null,expected:null})}}},{key:"addEffect",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.effects.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e}),this.setState({routine:s,modalEffect:!1,action:null,source:null})}}},{key:"removeTrigger",value:function(e){var t=this.state.routine,n=t.triggers.filter((function(t,n){return n!=e}));t.triggers=n,this.setState({routine:t})}},{key:"removeEffect",value:function(e){var t=this.state.routine,n=t.effects.filter((function(t,n){return n!=e}));t.effects=n,this.setState({routine:t})}},{key:"save",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.routine.name.length){e.next=4;break}this.setState({enabled:!0,message:"Missing name"}),e.next=16;break;case 4:if(0!=this.state.routine.icon.length){e.next=8;break}this.setState({enabled:!0,message:"Missing icon"}),e.next=16;break;case 8:if(0!=this.state.routine.effects.length){e.next=12;break}this.setState({enabled:!0,message:"Missing effect"}),e.next=16;break;case 12:return e.next=14,(new z).post({name:this.state.routine.name,watch:this.state.routine.watch.toString(),icon:this.state.routine.icon,triggers:this.state.routine.triggers,effects:this.state.routine.effects,mode:this.state.mode}).fetch("/api/routines");case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.props.history.push("/routine");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.routine?Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(y.jsx)(f.a,{onChange:function(t){e.updateName(t.nativeEvent.target.value)},style:{width:"49%"},value:this.state.routine.name,label:"Name",variant:"outlined"}),Object(y.jsx)(f.a,{onChange:function(t){e.updateIcon(t.nativeEvent.target.value)},value:this.state.routine.icon,label:"Icon",variant:"outlined",style:{width:"49%"},InputProps:{endAdornment:Object(y.jsx)(ge.a,{position:"end",children:Object(y.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(y.jsx)(xe.a,{})})})}}),Object(y.jsx)(fe.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(y.jsx)(Oe,{onSelect:function(t){e.setState({popup:!1}),e.updateIcon(t)}})})]}),"counter"==this.state.mode?Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsxs)("div",{style:{display:"flex",paddingTop:15,paddingBottom:15,paddingLeft:5,paddingRight:5},children:[Object(y.jsx)("div",{style:{flex:1},children:Object(y.jsx)(E.a,{size:"small",onClick:function(){e.setState({mode:"week"})},variant:"outlined",children:Object(y.jsx)(ae.a,{})})}),Object(y.jsx)("div",{style:{display:"flex",flex:20,justifyContent:"center"},children:Object(y.jsx)(ee.a,{defaultValue:0,valueLabelDisplay:"auto",orientation:"horizontal",min:0,max:1440,step:1,value:this.state.routine.watch,onChange:function(t,n){e.updateWatch(n)}})})]})}):Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)(se,{onChange:function(t){e.updateWatch(t)},onChangeMode:function(){e.setState({mode:"counter"})}})})]}),Object(y.jsxs)("div",{style:{flexDirection:"row",display:"flex",marginTop:20},children:[Object(y.jsxs)("div",{style:{flex:1,padding:5},children:[Object(y.jsx)(D.a,{variant:"subtitle1",children:"Trigger"}),Object(y.jsxs)(Me.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:["   ",this.state.routine.triggers.map((function(t,n){return Object(y.jsxs)("div",{onClick:function(){return e.removeTrigger(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)(D.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(y.jsx)(D.a,{variant:"body2",children:"Reference : "+t.source}),Object(y.jsx)(D.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(y.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(y.jsxs)(D.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]}),t.result&&t.statement&&t.expected?Object(y.jsxs)("div",{children:[Object(y.jsx)(D.a,{variant:"body2",children:"Pour condition"}),Object(y.jsxs)("div",{style:{marginLeft:20},children:[Object(y.jsx)(D.a,{variant:"body2",children:"Resultat : "+t.result}),Object(y.jsx)(D.a,{variant:"body2",children:"Condition : "+t.statement}),Object(y.jsx)(D.a,{variant:"body2",children:"Expected : "+t.expected})]})]}):null]})})),Object(y.jsx)(m.a,{onClick:function(){e.reset(),e.setState({modalTrigger:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)(T.a,{})})]})]}),Object(y.jsxs)("div",{style:{flex:1,padding:5},children:[Object(y.jsx)(D.a,{variant:"subtitle1",children:"Effect"}),Object(y.jsxs)(Me.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:[this.state.routine.effects.map((function(t,n){return Object(y.jsxs)("div",{onClick:function(){return e.removeEffect(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(y.jsxs)(D.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(y.jsx)(D.a,{variant:"body2",children:"Reference : "+t.source}),Object(y.jsx)(D.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(y.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(y.jsxs)(D.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]})})),Object(y.jsx)(m.a,{onClick:function(){e.reset(),e.setState({modalEffect:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)(T.a,{})})]})]})]})]}),Object(y.jsx)(g.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(y.jsx)(E.a,{onClick:function(){e.save()},style:{borderRadius:0},variant:"outlined",children:Object(y.jsx)(je.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message}),Object(y.jsx)(Z.a,{open:this.state.modalTrigger,onClose:function(){e.reset(),e.setState({modalTrigger:!1})},children:Object(y.jsx)($.a,{in:this.state.modalTrigger,children:Object(y.jsx)(g.a,{style:Ae,children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(y.jsx)(D.a,{variant:"h5",children:"New Trigger"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(y.jsx)("div",{style:{marginTop:5,marginBottom:5},children:Object(y.jsx)(ue,{flexDirection:"column",orientation:"horizontal",setState:e.setState.bind(e),action:t})})}))})}):null,Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:"Result",value:this.state.result,onChange:function(t){e.setState({result:t.currentTarget.value})},style:{width:"100%"}})}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginBottom:5,marginTop:5,flex:1},children:[Object(y.jsx)(V.a,{children:"Condition"}),Object(y.jsxs)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.statement,onChange:function(t){e.setState({statement:t.target.value})},label:"Source",children:[Object(y.jsx)(H.a,{value:"equal",children:"="}),Object(y.jsx)(H.a,{value:"smaller",children:"<"}),Object(y.jsx)(H.a,{value:"bigger",children:">"}),Object(y.jsx)(H.a,{value:"different",children:"<>"})]})]}),Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:"Expected",value:this.state.expected,onChange:function(t){e.setState({expected:t.currentTarget.value})},style:{width:"100%"}})})]}),Object(y.jsx)(m.a,{onClick:function(){e.addTrigger()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})}),Object(y.jsx)(Z.a,{open:this.state.modalEffect,onClose:function(){e.reset(),e.setState({modalEffect:!1})},children:Object(y.jsx)($.a,{in:this.state.modalEffect,children:Object(y.jsx)(g.a,{style:Ae,children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(y.jsx)(D.a,{variant:"h5",children:"New effect"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(y.jsx)("div",{style:{marginTop:5,marginBottom:5},children:Object(y.jsx)(ue,{flexDirection:"column",orientation:"horizontal",setState:e.setState.bind(e),action:t})})}))})}):null,Object(y.jsx)(m.a,{onClick:function(){e.addEffect()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})})]}):Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),Pe={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,backgroundColor:le.palette.background.paper,padding:10,borderRadius:5},Be=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={popup:!1,id:e.match.params.id,enabled:!1,message:"",routine:null,sources:[],modalTrigger:!1,modalEffect:!1,mode:"counter"},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.getSource(["smartobject","process","module","essential"]);case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/routines/"+this.state.id);case 5:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):t.error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({mode:n.data.mode,routine:n.data,sources:t.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.setState({action:null,source:null,result:null,statement:null,expected:null})}},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"updateIcon",value:function(e){var t=this.state.routine;t.icon=e,this.setState({routine:t})}},{key:"updateName",value:function(e){var t=this.state.routine;t.name=e,this.setState({routine:t})}},{key:"updateWatch",value:function(e){var t=this.state.routine;t.watch=e,this.setState({routine:t})}},{key:"addTrigger",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.triggers.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e,result:this.state.result,statement:this.state.statement,expected:this.state.expected}),this.setState({routine:s,modalTrigger:!1,action:null,source:null,result:null,statement:null,expected:null})}}},{key:"addEffect",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.effects.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e}),this.setState({routine:s,modalEffect:!1,action:null,source:null})}}},{key:"removeTrigger",value:function(e){var t=this.state.routine,n=t.triggers.filter((function(t,n){return n!=e}));t.triggers=n,this.setState({routine:t})}},{key:"removeEffect",value:function(e){var t=this.state.routine,n=t.effects.filter((function(t,n){return n!=e}));t.effects=n,this.setState({routine:t})}},{key:"save",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.routine.name.length){e.next=4;break}this.setState({enabled:!0,message:"Missing name"}),e.next=16;break;case 4:if(0!=this.state.routine.icon.length){e.next=8;break}this.setState({enabled:!0,message:"Missing icon"}),e.next=16;break;case 8:if(0!=this.state.routine.effects.length){e.next=12;break}this.setState({enabled:!0,message:"Missing effect"}),e.next=16;break;case 12:return e.next=14,(new z).put({name:this.state.routine.name,watch:this.state.routine.watch.toString(),icon:this.state.routine.icon,triggers:this.state.routine.triggers,effects:this.state.routine.effects,mode:this.state.mode}).fetch("/api/routines/"+this.state.id);case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.props.history.push("/routine/");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.routine?Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(y.jsx)(f.a,{onChange:function(t){e.updateName(t.nativeEvent.target.value)},style:{width:"49%"},value:this.state.routine.name,label:"Name",variant:"outlined"}),Object(y.jsx)(f.a,{onChange:function(t){e.updateIcon(t.nativeEvent.target.value)},value:this.state.routine.icon,label:"Icon",variant:"outlined",style:{width:"49%"},InputProps:{endAdornment:Object(y.jsx)(ge.a,{position:"end",children:Object(y.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(y.jsx)(xe.a,{})})})}}),Object(y.jsx)(fe.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(y.jsx)(Oe,{onSelect:function(t){e.setState({popup:!1}),e.updateIcon(t)}})})]}),"counter"==this.state.mode?Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsxs)("div",{style:{display:"flex",paddingTop:15,paddingBottom:15,paddingLeft:5,paddingRight:5},children:[Object(y.jsx)("div",{style:{flex:1},children:Object(y.jsx)(E.a,{size:"small",onClick:function(){e.setState({mode:"week"})},variant:"outlined",children:Object(y.jsx)(ae.a,{})})}),Object(y.jsx)("div",{style:{display:"flex",flex:15,justifyContent:"center"},children:Object(y.jsx)(ee.a,{defaultValue:0,valueLabelDisplay:"auto",orientation:"horizontal",min:0,max:1440,step:1,value:this.state.routine.watch,onChange:function(t,n){e.updateWatch(n)}})})]})}):Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,marginRight:10,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)(se,{onChange:function(t){e.updateWatch(t)},onChangeMode:function(){e.setState({mode:"counter"})}})})]}),Object(y.jsxs)("div",{style:{flexDirection:"row",display:"flex",marginTop:20},children:[Object(y.jsxs)("div",{style:{flex:1,padding:5},children:[Object(y.jsx)(D.a,{variant:"subtitle1",children:"Trigger"}),Object(y.jsxs)(Me.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:["   ",this.state.routine.triggers.map((function(t,n){return Object(y.jsxs)("div",{onClick:function(){return e.removeTrigger(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)(D.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(y.jsx)(D.a,{variant:"body2",children:"Reference : "+t.source}),Object(y.jsx)(D.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(y.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(y.jsxs)(D.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]}),t.result&&t.statement&&t.expected?Object(y.jsxs)("div",{children:[Object(y.jsx)(D.a,{variant:"body2",children:"Pour condition"}),Object(y.jsxs)("div",{style:{marginLeft:20},children:[Object(y.jsx)(D.a,{variant:"body2",children:"Resultat : "+t.result}),Object(y.jsx)(D.a,{variant:"body2",children:"Condition : "+t.statement}),Object(y.jsx)(D.a,{variant:"body2",children:"Expected : "+t.expected})]})]}):null]})})),Object(y.jsx)(m.a,{onClick:function(){e.reset(),e.setState({modalTrigger:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)(T.a,{})})]})]}),Object(y.jsxs)("div",{style:{flex:1,padding:5},children:[Object(y.jsx)(D.a,{variant:"subtitle1",children:"Effect"}),Object(y.jsxs)(Me.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:[this.state.routine.effects.map((function(t,n){return Object(y.jsxs)("div",{onClick:function(){return e.removeEffect(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(y.jsxs)(D.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(y.jsx)(D.a,{variant:"body2",children:"Reference : "+t.source}),Object(y.jsx)(D.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(y.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(y.jsxs)(D.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]})})),Object(y.jsx)(m.a,{onClick:function(){e.reset(),e.setState({modalEffect:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)(T.a,{})})]})]})]})]}),Object(y.jsx)(g.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(y.jsx)(E.a,{onClick:function(){e.save()},style:{borderRadius:0},variant:"outlined",children:Object(y.jsx)(je.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message}),Object(y.jsx)(Z.a,{open:this.state.modalTrigger,onClose:function(){e.reset(),e.setState({modalTrigger:!1})},children:Object(y.jsx)($.a,{in:this.state.modalTrigger,children:Object(y.jsx)(g.a,{style:Pe,children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(y.jsx)(D.a,{variant:"h5",children:"New Trigger"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(y.jsx)("div",{style:{marginTop:5,marginBottom:5},children:Object(y.jsx)(ue,{setState:e.setState.bind(e),action:t,flexDirection:"column",orientation:"horizontal"})})}))})}):null,Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:"Result",value:this.state.result,onChange:function(t){e.setState({result:t.currentTarget.value})},style:{width:"100%"}})}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginBottom:5,marginTop:5,flex:1},children:[Object(y.jsx)(V.a,{children:"Condition"}),Object(y.jsxs)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.statement,onChange:function(t){e.setState({statement:t.target.value})},label:"Source",children:[Object(y.jsx)(H.a,{value:"equal",children:"="}),Object(y.jsx)(H.a,{value:"smaller",children:"<"}),Object(y.jsx)(H.a,{value:"bigger",children:">"}),Object(y.jsx)(H.a,{value:"different",children:"<>"})]})]}),Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(y.jsx)(f.a,{variant:"outlined",placeholder:"Expected",value:this.state.expected,onChange:function(t){e.setState({expected:t.currentTarget.value})},style:{width:"100%"}})})]}),Object(y.jsx)(m.a,{onClick:function(){e.addTrigger()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})}),Object(y.jsx)(Z.a,{open:this.state.modalEffect,onClose:function(){e.reset(),e.setState({modalEffect:!1})},children:Object(y.jsx)($.a,{in:this.state.modalEffect,children:Object(y.jsx)(g.a,{style:Pe,children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(y.jsx)(D.a,{variant:"h5",children:"New effect"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(y.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(y.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(y.jsx)("div",{style:{marginTop:5,marginBottom:5},children:Object(y.jsx)(ue,{setState:e.setState.bind(e),action:t})})}))})}):null,Object(y.jsx)(m.a,{onClick:function(){e.addEffect()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})})]}):Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),Ee=n(65),Le=n.n(Ee),ze=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",modules:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/configurations/module");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({enabled:!1,message:"",modules:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsx)(I.a,{children:Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Identifiant"})})})}),Object(y.jsx)(B.a,{children:this.state.modules.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(y.jsx)(S.b,{to:"/module/"+Le()(e.name),style:{textDecoration:"none",color:"white",display:"contents"},children:Object(y.jsx)(I.a,{hover:!0,style:{cursor:"pointer"},children:Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.name})})},e.reference)})}))})]})}),Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignContent:"center",alignItems:"center"},children:Object(y.jsx)(L.a,{component:"div",count:this.state.modules.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),We=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={hashId:e.match.params.id,loading:null,module:null,enabled:!1,message:"",executeInformation:"",severity:"error"},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/configurations/module");case 2:(t=e.sent).error?(this.setState({enabled:!0,severity:"error",message:t.package+" : "+t.message}),this.props.history.push("/module")):(n=!1,t.data.forEach((function(e){Le()(e.name)==a.state.hashId&&(n=e)})),n?this.setState({module:n}):this.props.history.push("/module")),this.setState({loading:null});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeAction",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,s,i,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(this.setState({loading:t}),a={},s=0;s<n.length;s++)i=n[s],void 0==(r=this.state["argument-"+i.id])&&(r=i.default),a[i.id]=r;return e.next=5,(new z).post({settings:a,reference:this.state.module.reference}).fetch("/api/modules/"+Le()(this.state.module.name)+"/actions/"+t);case 5:(c=e.sent).error?(this.setState({enabled:!0,severity:"error",message:c.package+" : "+c.message}),this.setState({loading:null})):(c.data?this.setState({executeInformation:JSON.stringify(c.data)}):this.setState({enabled:!0,severity:"success",message:"Success"}),this.componentDidMount());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.module?Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,marginBottom:10,justifyContent:"left"},children:[Object(y.jsxs)("div",{style:{padding:10},children:[Object(y.jsx)(D.a,{variant:"h4",children:this.state.module.name.split("/")[1]}),Object(y.jsx)(D.a,{variant:"subtitle1",children:this.state.module.name})]}),Object(y.jsx)(J.a,{}),Object(y.jsx)("div",{style:{padding:10,paddingBottom:0},children:this.state.module.actions.map((function(t){return Object(y.jsxs)(g.a,{style:{marginTop:10,marginBottom:10,display:"flex",flexDirection:"column",padding:10},children:[Object(y.jsx)(m.a,{disabled:e.state.loading==t.id,onClick:function(){e.executeAction(t.id,t.settings)},variant:e.state.loading==t.id?"contained":"outlined",style:{width:"250px",height:"100%"},children:t.name}),t.settings.length>0?Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",marginTop:10,marginBottom:10},children:t.settings.map((function(t){return Object(y.jsx)(ue,{flexDirection:"column",orientation:"horizontal",setState:e.setState.bind(e),action:t})}))}):null]})}))}),this.state.executeInformation.length>0?Object(y.jsx)("div",{style:{padding:10},children:Object(y.jsx)(v.a,{severity:"success",action:Object(y.jsx)(E.a,{onClick:function(){e.setState({executeInformation:""})},style:{alignSelf:"start"},color:"inherit",size:"small",children:Object(y.jsx)(Y.a,{})}),children:Object(y.jsx)(F.a,{id:"json-pretty",data:JSON.parse(this.state.executeInformation)})})}):null]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:this.state.severity,children:this.state.message})]}):Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:this.state.severity,children:this.state.message})}}]),n}(s.a.Component),Ne=n(162),Fe=n(146),Je=n(141),Ue=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={pageSmartobject:0,pageModule:0,enabled:!1,message:"",modules:[],smartobjects:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/configurations/module");case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/configurations/smartobject");case 5:n=e.sent,t.error?this.setState({enabled:!0,message:t.package+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.setState({enabled:!1,message:"",modules:t.data,smartobjects:n.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Identifiant"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Name"})})]})}),Object(y.jsx)(B.a,{children:this.state.smartobjects.slice(10*this.state.pageSmartobject,10*(this.state.pageSmartobject+1)).map((function(e){return Object(y.jsxs)(I.a,{hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.id})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.name})})]},e.reference)}))})]})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/market/module",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:Object(y.jsx)(Ne.a,{})})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.smartobjects.length,rowsPerPage:10,page:this.state.pageSmartobject,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({pageSmartobject:n})}})]}),Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Identifiant"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Name"})})]})}),Object(y.jsx)(B.a,{children:this.state.modules.slice(10*this.state.pageSmartobject,10*(this.state.pageSmartobject+1)).map((function(e){return Object(y.jsxs)(I.a,{hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.id})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.name})})]},e.reference)}))})]})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/market/smartobject",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:"smartobject"!=this.state.id?Object(y.jsx)(Fe.a,{}):Object(y.jsx)(Je.a,{})})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.modules.length,rowsPerPage:10,page:this.state.pageModule,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({pageModule:n})}})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Ve=n(152),_e=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,message:"",markets:[],pageMarket:0,severity:"error",loading:!1},a}return Object(h.a)(n,[{key:"install",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,(new z).post({package:t}).fetch("/api/markets/install");case 3:(n=e.sent).error?this.setState({loading:!1,severity:"error",enabled:!0,message:n.package+" : "+n.message}):(this.setState({severity:"info",enabled:!0,message:t+" was installed"}),this.componentDidMount());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"upgrade",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,(new z).post({package:t}).fetch("/api/markets/upgrade");case 3:(n=e.sent).error?this.setState({loading:!1,severity:"error",enabled:!0,message:n.package+" : "+n.message}):(this.setState({severity:"info",enabled:!0,message:t+" was upgraded"}),this.componentDidMount());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uninstall",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,(new z).post({package:t}).fetch("/api/markets/uninstall");case 3:(n=e.sent).error?this.setState({loading:!1,severity:"error",enabled:!0,message:n.package+" : "+n.message}):(this.setState({severity:"info",enabled:!0,message:t+" was removed"}),this.componentDidMount());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/configurations/module");case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/configurations/smartobject");case 5:return n=e.sent,e.next=8,(new z).get().fetch("/api/ping");case 8:return a=e.sent,e.next=11,fetch("https://market.intendant.io");case 11:return s=e.sent,e.next=14,s.json();case 14:if(i=e.sent,!(a.error||n.error||t.error)){e.next=18;break}return this.setState({loading:!1,severity:"error",enabled:!0,message:a.package+" : "+a.message}),e.abrupt("return");case 18:i=(i=i.map((function(e){return e.mode="install",e.currentVersion="0.0.0",e}))).map((function(e){return"@intendant/core"==e.name&&(a.version!=e.version?e.mode="upgrade":e.mode="none",e.currentVersion=a.version),e})),t.data.forEach((function(e){i=i.map((function(t){return t.name==e.name&&(t.currentVersion=e.version,t.version==e.version?t.mode="remove":t.mode="update"),t}))})),n.data.forEach((function(e){i=i.map((function(t){return t.name==e.name&&(t.currentVersion=e.version,t.version==e.version?t.mode="remove":t.mode="update"),t}))})),this.setState({markets:i}),t.error?this.setState({severity:"error",enabled:!0,message:t.package+" : "+t.message}):n.error?this.setState({severity:"error",enabled:!0,message:n.package+" : "+n.message}):this.setState({modules:t.data,smartobjects:n.data}),this.setState({loading:!1});case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Name"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Type"})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:"Version"})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:"Action"})})]})}),Object(y.jsx)(B.a,{children:this.state.markets.slice(20*this.state.pageMarket,20*(this.state.pageMarket+1)).map((function(t){return Object(y.jsxs)(I.a,{hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.name})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.type})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:t.version})}),Object(y.jsx)(P.a,{align:"center",children:Object(y.jsx)(D.a,{variant:"body1",children:"none"==t.mode?Object(y.jsx)(D.a,{variant:"body1",children:"Updated"}):"remove"==t.mode?Object(y.jsx)(m.a,{disabled:e.state.loading,size:"small",startIcon:Object(y.jsx)(Y.a,{}),onClick:function(){e.uninstall(t.name)},variant:"outlined",children:"Remove"}):"upgrade"==t.mode?Object(y.jsx)(m.a,{disabled:e.state.loading,size:"small",startIcon:Object(y.jsx)(Ve.a,{}),onClick:function(){e.upgrade(t.name)},variant:"outlined",children:"Upgrade"}):"install"==t.mode?Object(y.jsx)(m.a,{disabled:e.state.loading,size:"small",startIcon:Object(y.jsx)(Ve.a,{}),onClick:function(){e.install(t.name)},variant:"outlined",disableElevation:!0,children:"Install"}):"update"==t.mode?Object(y.jsx)(m.a,{disabled:e.state.loading,size:"small",startIcon:Object(y.jsx)(Ve.a,{}),onClick:function(){e.install(t.name)},variant:"outlined",disableElevation:!0,children:"Update"}):Object(y.jsx)(m.a,{disabled:!0,size:"small",startIcon:Object(y.jsx)(Ve.a,{}),onClick:function(){e.install(t.name)},variant:"outlined",disableElevation:!0,children:"Unknown"})})})]},t.reference)}))})]})}),Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:Object(y.jsx)(L.a,{component:"div",count:this.state.markets.length,rowsPerPage:20,page:this.state.pageMarket,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({pageMarket:n})}})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:this.state.severity,children:this.state.message})]})}}]),n}(s.a.Component),He=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",widgets:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/widgets");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({enabled:!1,message:"",widgets:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsx)(B.a,{children:this.state.widgets.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(y.jsx)(S.b,{to:"/widget/"+e.id,style:{textDecoration:"none",color:"white",display:"contents"},children:Object(y.jsxs)(I.a,{hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)("img",{style:{width:30,height:30,filter:"invert(100%)"},src:"/admin/ressource/icon/"+e.icon+".svg"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.reference})}),Object(y.jsx)(P.a,{align:"left",children:e.contents.sort((function(e,t){return e.type.rank>t.type.rank})).map((function(e){return e.content.split("\n").map((function(t){return Object(y.jsx)(D.a,{variant:"body1",style:{fontWeight:"title"==e.type.reference?"bold":"normal"},children:t})}))}))}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:e.icon})})]},e.reference)})}))})})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/widget/new",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:Object(y.jsx)(T.a,{})})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.widgets.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Qe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,message:"",popup:!1,content:null,description:"",image:"",sources:[],contentSources:[],source:null,action:null,widgetReference:"",reference:"",icon:"",type:"title",types:[],contents:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/smartobjects");case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/configurations/widget");case 5:return n=e.sent,e.next=8,ve.getSource(["smartobject","module"]);case 8:a=e.sent,t.error?this.setState({enabled:!0,message:t.package+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.package+" : "+n.message}):a.error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.setState({enabled:!1,message:"",loading:!1,sources:a.data,type:!1,types:n.data.contents.types});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"setType",value:function(e){var t=this;this.state.types.map((function(n){n.id==e&&t.setState({type:n})}))}},{key:"save",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.widgetReference.length&&0!=this.state.contentSources.length&&0!=this.state.icon.length){e.next=3;break}return this.setState({enabled:!0,message:"Missing parameters"}),e.abrupt("return");case 3:return t=localStorage.getItem("authorization"),n=localStorage.getItem("server"),e.next=7,fetch(n+"/api/widgets",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({reference:this.state.widgetReference,sources:this.state.contentSources,contents:this.state.contents,icon:this.state.icon})});case 7:return a=e.sent,e.next=10,a.json();case 10:(s=e.sent).error?this.setState({enabled:!0,message:s.package+" : "+s.message}):this.props.history.push("/widget");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"insertContent",value:function(){var e=this.state.contents;e.push({type:this.state.type,content:this.state.content}),this.setState({contents:e,content:""})}},{key:"insertSource",value:function(){var e=this;if(null!=this.state.action&&null!=this.state.source&&0!=this.state.reference.length){var t=!1,n=this.state.contentSources;if(n.forEach((function(n){n.reference==e.state.reference&&(t=!0,e.setState({enabled:!0,message:"Duplicate reference"}))})),!t){for(var a=[],s=this.state.action,i=0;i<s.settings.length;i++){var r=s.settings[i],c=this.state["argument-"+r.id];void 0==c&&(c=r.default),a.push({reference:r.id,value:c})}n.push({source:this.state.source,action:this.state.action,arguments:a,reference:this.state.reference}),this.setState({contentSources:n,action:null,source:null,reference:""})}}else this.setState({enabled:!0,message:"Missing parameters"})}},{key:"delete",value:function(e){var t=[];this.state.contents.forEach((function(n,a){a!=e&&t.push(n)})),this.setState({contents:t})}},{key:"deleteContent",value:function(e){var t=[];this.state.contentSources.forEach((function(n,a){a!=e&&t.push(n)})),this.setState({contentSources:t})}},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,marginBottom:10,justifyContent:"left"},children:[Object(y.jsx)("div",{style:{padding:10},children:Object(y.jsx)(D.a,{variant:"h4",children:" Widget "})}),Object(y.jsx)(J.a,{}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(f.a,{onChange:function(t){e.setState({widgetReference:t.target.value})},multiline:!0,value:this.state.widgetReference,label:"Reference",variant:"outlined"}),Object(y.jsx)(f.a,{style:{marginLeft:10},onChange:function(t){e.setState({icon:t.target.value})},multiline:!0,value:this.state.icon,label:"Icon",variant:"outlined",InputProps:{endAdornment:Object(y.jsx)(ge.a,{position:"end",children:Object(y.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(y.jsx)(xe.a,{})})})}}),Object(y.jsx)(fe.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(y.jsx)(Oe,{onSelect:function(t){e.setState({popup:!1,icon:t})}})})]}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:" Source "}),Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:" Source "})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:" Argument "})}),Object(y.jsx)(P.a,{align:"left"})]})}),Object(y.jsxs)(B.a,{children:[this.state.contentSources.map((function(t,n){return Object(y.jsxs)(I.a,{children:[Object(y.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.reference," "]}),Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.source.name," "]}),Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.action.name," "]})]}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:JSON.stringify(t.arguments)})}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.deleteContent(n)},style:{borderRadius:2},children:Object(y.jsx)(Y.a,{})})})]})})),Object(y.jsxs)(I.a,{children:[Object(y.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(y.jsx)(f.a,{onChange:function(t){e.setState({reference:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.reference,label:"Reference",variant:"outlined"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{placeholder:"Source",value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null]}),Object(y.jsx)(P.a,{align:"right",style:{width:"40%"},children:this.state.action&&this.state.action.settings.length>0?Object(y.jsx)("div",{style:{marginLeft:5,marginBottom:5,marginTop:5,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",width:"100%"},children:Object(y.jsx)("div",{style:{display:"flex",paddingTop:10,paddingBottom:10,flexDirection:"column"},children:this.state.action.settings.map((function(t){return Object(y.jsx)(ue,{flexDirection:"column",orientation:"horizontal",setState:e.setState.bind(e),action:t})}))})}):null}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.insertSource()},style:{borderRadius:2},children:Object(y.jsx)(T.a,{})})})]})]})]})})})]}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:" Content "}),Object(y.jsx)("div",{style:{marginTop:10,marginBottom:10},children:Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:" Type "})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:" Affichage "})}),Object(y.jsx)(P.a,{align:"left"})]})}),Object(y.jsxs)(B.a,{children:[this.state.contents.sort((function(e,t){return e.type.rank>t.type.rank})).map((function(t,n){return Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.type.name," "]})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.content," "]})}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.delete(n)},style:{borderRadius:2},children:Object(y.jsx)(Y.a,{})})})]})})),Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsxs)(U.a,{variant:"outlined",style:{marginRight:10,width:"100%"},children:[Object(y.jsx)(V.a,{children:"Type"}),Object(y.jsx)(_.a,{value:this.state.type.id,onChange:function(t){e.setType(t.target.value)},label:"Type",children:this.state.types.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(f.a,{onChange:function(t){e.setState({content:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.content,label:"Name",variant:"outlined"})}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.insertContent()},style:{borderRadius:2},children:Object(y.jsx)(T.a,{})})})]})]})]})})})]}),Object(y.jsx)(m.a,{style:{marginTop:5,marginBottom:5},onClick:function(){e.save()},variant:"outlined",children:"Save"})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),qe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,message:"",id:e.match.params.id,contentSources:[],reference:"",source:null,action:null,type:"title",content:"",sources:[],types:[],widget:null,needSave:null},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/widgets/"+this.state.id);case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/configurations/widget");case 5:return n=e.sent,e.next=8,ve.getSource(["smartobject","module"]);case 8:a=e.sent,t.error?this.setState({enabled:!0,message:t.package+" : "+t.message}):a.error?this.setState({enabled:!0,message:a.package+" : "+a.message}):n.error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.setState({enabled:!1,message:"",loading:!1,widget:t.data,sources:a.data,types:n.data.contents.types});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete({}).fetch("/api/widgets/"+this.state.widget.id);case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.props.history.push("/widget");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteSource",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/widgets/"+this.state.widget.id+"/sources/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertSource",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i,r,c,o=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.action&&null!=this.state.source&&0!=this.state.reference.length){e.next=3;break}return this.setState({enabled:!0,message:"Missing parameters"}),e.abrupt("return");case 3:if(t=!1,this.state.widget.sources.forEach((function(e){e.reference==o.state.reference&&(t=!0,o.setState({enabled:!0,message:"Duplicate reference"}))})),!t){e.next=7;break}return e.abrupt("return");case 7:for(n=[],a=this.state.action,s=0;s<a.settings.length;s++)i=a.settings[s],void 0==(r=this.state["argument-"+i.id])&&(r=i.default),n.push({reference:i.id,value:r});return e.next=12,(new z).post({source:this.state.source,action:this.state.action,arguments:n,reference:this.state.reference}).fetch("/api/widgets/"+this.state.id+"/sources");case 12:(c=e.sent).error?this.setState({enabled:!0,message:c.package+" : "+c.message}):(this.setState({action:null,source:null,reference:""}),this.componentDidMount());case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"setContent",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).post({type:this.state.type,content:this.state.content}).fetch("/api/widgets/"+this.state.id+"/contents");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):(this.setState({content:""}),this.componentDidMount());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteContent",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/widgets/"+this.state.id+"/contents/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.widget,a=n.contents.map((function(e){return e.id==t.id&&(e.native=t.native),e})),n.contents=a,this.setState({widget:n,needSave:null}),e.next=6,(new z).put({content:t}).fetch("/api/widgets/"+this.state.widget.id);case 6:(s=e.sent).error?this.setState({enabled:!0,message:s.package+" : "+s.message}):this.componentDidMount();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.widget?Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(y.jsxs)("div",{style:{padding:10},children:[Object(y.jsx)(D.a,{variant:"h4",style:{fontSize:25},children:this.state.widget.reference}),Object(y.jsx)(D.a,{variant:"subtitle1",children:this.state.widget.icon})]}),Object(y.jsx)(J.a,{}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Source"}),Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:"Reference"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:"Source"})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:"Argument"})}),Object(y.jsx)(P.a,{align:"left"})]})}),Object(y.jsx)(B.a,{children:this.state.widget.sources.map((function(t,n){return Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:t.reference})}),Object(y.jsxs)(P.a,{align:"left",children:[Object(y.jsx)(D.a,{variant:"subtitle1",children:t.object}),Object(y.jsx)(D.a,{variant:"subtitle1",children:t.action})]}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:t.arguments.map((function(e){return Object(y.jsx)(D.a,{variant:"body1",children:e.reference+" : "+e.value})}))})}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.deleteSource(t.id)},style:{borderRadius:3},children:Object(y.jsx)(X.a,{})})})]})}))})]})})})]}),Object(y.jsx)("div",{style:{padding:10,paddingBottom:0},children:Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsxs)(B.a,{children:[this.state.contentSources.map((function(t,n){return Object(y.jsxs)(I.a,{children:[Object(y.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.reference," "]}),Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.source.name," "]}),Object(y.jsxs)(D.a,{variant:"subtitle1",children:[" ",t.action.name," "]})]}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:JSON.stringify(t.arguments)})}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.deleteContent(n)},style:{borderRadius:2},children:Object(y.jsx)(Y.a,{})})})]})})),Object(y.jsxs)(I.a,{children:[Object(y.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(y.jsx)(f.a,{onChange:function(t){e.setState({reference:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.reference,label:"Reference",variant:"outlined"}),Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(y.jsx)(V.a,{children:"Source"}),Object(y.jsx)(_.a,{placeholder:"Source",value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(y.jsxs)(U.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(y.jsx)(V.a,{children:"Action"}),Object(y.jsx)(_.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]}):null]}),Object(y.jsx)(P.a,{align:"right",style:{width:"40%"},children:this.state.action&&this.state.action.settings.length>0?Object(y.jsx)("div",{style:{marginLeft:5,marginBottom:5,marginTop:5,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",width:"100%"},children:Object(y.jsx)("div",{style:{display:"flex",paddingTop:10,paddingBottom:10,flexDirection:"column"},children:this.state.action.settings.map((function(t){return Object(y.jsx)(ue,{flexDirection:"column",orientation:"horizontal",setState:e.setState.bind(e),action:t})}))})}):null}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.insertSource()},style:{borderRadius:2},children:Object(y.jsx)(T.a,{})})})]})]})})})})}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Content"}),Object(y.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",style:{width:"15%"},children:Object(y.jsx)(D.a,{variant:"subtitle1",children:"Type"})}),Object(y.jsx)(P.a,{align:"left",style:{width:"80%"},children:Object(y.jsx)(D.a,{variant:"subtitle1",children:"content"})}),Object(y.jsx)(P.a,{align:"left",style:{width:"20%"}})]})}),Object(y.jsxs)(B.a,{children:[this.state.widget.contents.sort((function(e,t){return e.type.rank>t.type.rank})).map((function(t,n){return Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"subtitle1",children:t.type.name})}),Object(y.jsxs)(P.a,{align:"left",children:[Object(y.jsx)(f.a,{style:{width:"100%",marginBottom:5},onChange:function(a){t.native=a.target.value,e.setState({needSave:n})},onBlur:function(n){e.update(t)},multiline:!0,value:t.native,variant:"outlined"}),t.content.split("\n").map((function(t){return Object(y.jsx)(D.a,{variant:"body1",color:e.state.needSave==n?"primary":"inherit",style:{fontWeight:"title"==t.type?"bold":"normal"},children:t})}))]}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.deleteContent(t.id)},style:{borderRadius:3},children:Object(y.jsx)(X.a,{})})})]})})),Object(y.jsxs)(I.a,{children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsxs)(U.a,{variant:"outlined",style:{marginRight:10,width:"100%"},children:[Object(y.jsx)(V.a,{children:"Type"}),Object(y.jsx)(_.a,{value:this.state.type,onChange:function(t){e.setState({type:t.target.value})},label:"Type",children:this.state.types.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})]})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(f.a,{onChange:function(t){e.setState({content:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.content,label:"Name",variant:"outlined"})}),Object(y.jsx)(P.a,{align:"right",children:Object(y.jsx)(E.a,{onClick:function(){e.setContent()},style:{borderRadius:2},children:Object(y.jsx)(T.a,{})})})]})]})]})})})]})]}),Object(y.jsx)(g.a,{style:{width:"min-content",marginTop:10,alignContent:"center",justifyContent:"center",alignSelf:"center"},children:Object(y.jsx)(E.a,{onClick:function(){e.delete()},style:{borderRadius:5},children:Object(y.jsx)(X.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),Ge=n(158),Ke=n(160),Xe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",users:[],profiles:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/users");case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/profiles");case 5:n=e.sent,t.error?this.setState({enabled:!0,message:t.package+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.setState({enabled:!1,message:"",users:t.data,profiles:n.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/users/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).put({login:t.login,profile:n}).fetch("/api/users/"+t.id);case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)(y.Fragment,{children:[this.state.loading?Object(y.jsx)(g.a,{style:{display:"flex",padding:10,alignContent:"center",justifyContent:"center",alignItems:"center",alignSelf:"center"},children:Object(y.jsx)(D.a,{variant:"subtitle1",style:{fontSize:18},children:"Chargement des smartobject"})}):Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsx)(M.a,{children:Object(y.jsx)(B.a,{children:this.state.users.sort((function(e,t){return e.profile>t.profile})).slice(10*this.state.page,10*(this.state.page+1)).map((function(t){return Object(y.jsxs)(I.a,{hover:!0,style:{cursor:"pointer"},children:[Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:t.login})}),Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(U.a,{variant:"outlined",children:Object(y.jsx)(_.a,{disabled:"admin"==t.login,value:t.profile,onChange:function(n){e.updateProfile(t,n.target.value)},children:e.state.profiles.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})})}),Object(y.jsxs)(P.a,{align:"right",children:[Object(y.jsx)(E.a,{onClick:function(){e.props.history.push("/qrcode/"+btoa(window.location.origin+"|"+t.login+"|"))},style:{borderRadius:3},children:Object(y.jsx)(Ge.a,{})}),Object(y.jsx)(E.a,{onClick:function(){e.props.history.push("/user/"+t.id+"/password")},style:{borderRadius:3},children:Object(y.jsx)(Ke.a,{})}),Object(y.jsx)(E.a,{onClick:function(){e.delete(t.id)},style:{borderRadius:3},children:Object(y.jsx)(X.a,{})})]})]},t.id)}))})})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/user/new",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:Object(y.jsx)(T.a,{})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.users.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Ye=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,message:"",profiles:[],profile:1,login:"",password:"",confirmationPassword:""},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/profiles");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({enabled:!1,message:"",profiles:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.login.length){e.next=4;break}this.setState({enabled:!0,message:"Missing login"}),e.next=16;break;case 4:if(0!=this.state.password.length){e.next=8;break}this.setState({enabled:!0,message:"Missing password"}),e.next=16;break;case 8:if(this.state.password==this.state.confirmationPassword){e.next=12;break}this.setState({enabled:!0,message:"Passwords are not the same"}),e.next=16;break;case 12:return e.next=14,(new z).post({login:this.state.login,password:this.state.password,profile:this.state.profile}).fetch("/api/users");case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.props.history.push("/user");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between"},children:Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"start",flexDirection:"column",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(y.jsx)(f.a,{placeholder:"login",variant:"outlined",value:this.state.login,onChange:function(t){e.setState({login:t.currentTarget.value})}}),Object(y.jsx)(f.a,{type:"password",placeholder:"password",variant:"outlined",value:this.state.password,style:{marginTop:10},onChange:function(t){e.setState({password:t.currentTarget.value})}}),Object(y.jsx)(f.a,{placeholder:"password confirmation",type:"password",variant:"outlined",value:this.state.confirmationPassword,style:{marginTop:10},onChange:function(t){e.setState({confirmationPassword:t.currentTarget.value})}}),Object(y.jsx)(U.a,{variant:"outlined",style:{width:"100%",marginTop:10},children:Object(y.jsx)(_.a,{value:this.state.profile,onChange:function(t){e.setState({profile:t.target.value})},children:this.state.profiles.map((function(e){return Object(y.jsx)(H.a,{value:e.id,children:e.name})}))})})]})})}),Object(y.jsx)(g.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(y.jsx)(E.a,{onClick:function(){e.add()},style:{borderRadius:0},variant:"outlined",children:Object(y.jsx)(je.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Ze=n(202),$e=n.n(Ze),et=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),a=t.call(this,e),console.log(a.props.match.params.id),a}return Object(h.a)(n,[{key:"render",value:function(){return Object(y.jsx)(g.a,{elevation:2,style:{padding:10,display:"flex",justifyContent:"center"},children:Object(y.jsx)($e.a,{style:{borderRadius:3},value:this.props.match.params.id,size:256,includeMargin:!0})})}}]),n}(s.a.Component),tt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,id:e.match.params.id,message:"",confirmationPassword:"",password:""},a}return Object(h.a)(n,[{key:"changePassword",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.password.length){e.next=4;break}this.setState({enabled:!0,message:"Missing password"}),e.next=16;break;case 4:if(0!=this.state.confirmationPassword.length){e.next=8;break}this.setState({enabled:!0,message:"Missing confirmation password"}),e.next=16;break;case 8:if(this.state.password==this.state.confirmationPassword){e.next=12;break}this.setState({enabled:!0,message:"Passwords are not the same"}),e.next=16;break;case 12:return e.next=14,(new z).post({password:this.state.password}).fetch("/api/users/"+this.state.id+"/password");case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.props.history.push("/user");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between"},children:Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"start",flexDirection:"column",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(y.jsx)(f.a,{placeholder:"password",type:"password",variant:"outlined",value:this.state.password,onChange:function(t){e.setState({password:t.currentTarget.value})}}),Object(y.jsx)(f.a,{placeholder:"password confirmation",type:"password",variant:"outlined",value:this.state.confirmationPassword,style:{marginTop:10},onChange:function(t){e.setState({confirmationPassword:t.currentTarget.value})}})]})})}),Object(y.jsx)(g.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(y.jsx)(E.a,{onClick:function(){e.changePassword()},style:{borderRadius:0},variant:"outlined",children:Object(y.jsx)(je.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),nt=n(426),at=n(404),st=n(415),it=n(416),rt=n(153),ct=n(150),ot=n(145),lt=n(137),dt=n(156),ut=n(161),ht=n(149),jt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return this.props.isMobile?null:Object(y.jsx)(nt.a,{variant:"persistent",anchor:"left",open:!0,style:{width:240},children:Object(y.jsx)("div",{style:{width:240,display:"flex",justifyContent:"space-between"},children:Object(y.jsxs)(at.a,{children:[Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",padding:5,alignContent:"center",alignSelf:"center",alignItems:"center"},children:[Object(y.jsx)("img",{src:"/admin/logo.svg",style:{height:"7vh",width:"7vh",borderRadius:7,marginLeft:15}}),Object(y.jsxs)("div",{children:[Object(y.jsx)(D.a,{variant:"h5",style:{textAlign:"start",fontWeight:"bold",paddingTop:15,paddingLeft:10},children:"Intendant"}),Object(y.jsx)(D.a,{variant:"subtitle1",style:{textAlign:"start",fontWeight:"bold",paddingTop:0,paddingBottom:15,paddingLeft:10},children:"Administration"})]})]}),Object(y.jsx)(J.a,{}),Object(y.jsx)(S.b,{to:"/smartobject",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(Fe.a,{})}),Object(y.jsx)(it.a,{primary:"Smartobject"})]},"smartobject")}),Object(y.jsx)(S.b,{to:"/localisation",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(rt.a,{})}),Object(y.jsx)(it.a,{primary:"Room"})]},"localisation")}),Object(y.jsx)(S.b,{to:"/module",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(Je.a,{})}),Object(y.jsx)(it.a,{primary:"Module"})]},"module")}),Object(y.jsx)(S.b,{to:"/widget",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(ct.a,{})}),Object(y.jsx)(it.a,{primary:"Widget"})]},"widget")}),Object(y.jsx)(S.b,{to:"/process",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(ot.a,{})}),Object(y.jsx)(it.a,{primary:"Process"})]},"process")}),Object(y.jsx)(S.b,{to:"/routine",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(lt.a,{})}),Object(y.jsx)(it.a,{primary:"Routine"})]},"configuration")}),Object(y.jsx)(S.b,{to:"/user",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(dt.a,{})}),Object(y.jsx)(it.a,{primary:"User"})]},"user")}),Object(y.jsx)(S.b,{to:"/market",style:{textDecoration:"none",color:"white"},children:Object(y.jsxs)(Q.a,{button:!0,children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(ut.a,{})}),Object(y.jsx)(it.a,{primary:"Market"})]},"market")}),Object(y.jsx)(J.a,{}),Object(y.jsxs)(Q.a,{button:!0,onClick:function(){e.props.onDisconnect()},children:[Object(y.jsx)(st.a,{children:Object(y.jsx)(ht.a,{})}),Object(y.jsx)(it.a,{primary:"Disconnect"})]},"disconnect")]})})})}}]),n}(s.a.Component);var bt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",localisations:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/localisations");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.setState({enabled:!1,message:"",localisations:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)(y.Fragment,{children:[this.state.loading?Object(y.jsx)(g.a,{style:{display:"flex",padding:10,alignContent:"center",justifyContent:"center",alignItems:"center",alignSelf:"center"},children:Object(y.jsx)(D.a,{variant:"subtitle1",style:{fontSize:18},children:"Chargement des smartobject"})}):Object(y.jsxs)("div",{children:[Object(y.jsx)(R.a,{component:g.a,children:Object(y.jsxs)(M.a,{children:[Object(y.jsx)(A.a,{children:Object(y.jsx)(I.a,{children:Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:"Reference"})})})}),Object(y.jsx)(B.a,{children:this.state.localisations.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(y.jsx)(S.b,{to:"/localisation/"+e.id,style:{textDecoration:"none",color:"white",display:"contents"},children:Object(y.jsx)(I.a,{hover:!0,style:{cursor:"pointer"},children:Object(y.jsx)(P.a,{align:"left",children:Object(y.jsx)(D.a,{variant:"body1",children:(t=e.name,t.charAt(0).toUpperCase()+t.slice(1))})})},e.name)});var t}))})]})}),Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(y.jsx)(g.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(y.jsx)(S.b,{to:"/localisation/new",style:{textDecoration:"none",color:"white"},children:Object(y.jsx)(E.a,{style:{borderRadius:0},children:Object(y.jsx)(T.a,{})})})}),Object(y.jsx)(L.a,{component:"div",count:this.state.localisations.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),pt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={name:""},a}return Object(h.a)(n,[{key:"add",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.name){e.next=4;break}this.setState({enabled:!0,message:"Missing-parameter : name is empty"}),e.next=8;break;case 4:return e.next=6,(new z).post({name:this.state.name}).fetch("/api/localisations");case 6:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.props.history.push("/localisation");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(g.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:Object(y.jsx)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between"},children:Object(y.jsx)("div",{style:{display:"flex",justifyContent:"start",flexDirection:"row",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:Object(y.jsx)(f.a,{onChange:function(t){e.setState({name:t.nativeEvent.target.value})},style:{width:"150px",marginRight:10},label:"Name",variant:"outlined"})})})}),Object(y.jsx)(g.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(y.jsx)(E.a,{onClick:function(){e.add()},style:{borderRadius:0},variant:"outlined",children:Object(y.jsx)(je.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component);function gt(e){return e.charAt(0).toUpperCase()+e.slice(1)}var ft=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={id:e.match.params.id,localisation:null,profiles:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/profiles");case 2:return t=e.sent,e.next=5,(new z).get().fetch("/api/localisations/"+this.state.id);case 5:(n=e.sent).error||t.error?this.props.history.push("/localisation"):this.setState({localisation:n.data,profiles:t.data}),this.setState({loading:null});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/localisations/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.props.history.push("/localisation");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).post({idProfile:n.id}).fetch("/api/localisations/"+t.id+"/profiles");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).delete().fetch("/api/localisations/"+t.id+"/profiles/"+n.id);case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.package+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.localisation?Object(y.jsxs)("div",{children:[Object(y.jsxs)(g.a,{elevation:2,style:{padding:10,marginBottom:10,justifyContent:"left"},children:[Object(y.jsx)("div",{style:{padding:10},children:Object(y.jsx)(D.a,{variant:"h4",children:gt(this.state.localisation.name)})}),Object(y.jsx)(J.a,{}),Object(y.jsx)("div",{style:{padding:10},children:this.state.localisation.smartobjects.map((function(e){return Object(y.jsx)("div",{style:{paddingTop:10},children:Object(y.jsx)(D.a,{variant:"body1",children:gt(e.reference)})})}))}),Object(y.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(y.jsx)(D.a,{variant:"h5",children:"Authorization"}),this.state.profiles.map((function(t){var n=!1;return e.state.localisation.profiles.forEach((function(e){e.profile==t.id&&(n=!0)})),Object(y.jsx)(Q.a,{style:{padding:1},children:Object(y.jsx)(q.a,{control:Object(y.jsx)(G.a,{checked:n,onChange:function(){n?e.deleteProfile(e.state.localisation,t):e.insertProfile(e.state.localisation,t)},color:"primary"}),label:t.name})})}))]})]}),Object(y.jsx)(g.a,{style:{width:"min-content",marginTop:10,marginBottom:10,alignContent:"center",justifyContent:"center",alignSelf:"center"},children:Object(y.jsx)(E.a,{onClick:function(){e.delete(e.state.id)},style:{borderRadius:5},children:Object(y.jsx)(X.a,{})})}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),mt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",profiles:[],selectProfile:"",authorizations:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).get().fetch("/api/profiles");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):""===this.state.selectProfile?(this.setState({enabled:!1,message:"",profiles:t.data,selectProfile:t.data[0].id}),this.onSelectProfile(t.data[0].id)):(this.setState({enabled:!1,message:"",profiles:t.data}),this.onSelectProfile(this.state.selectProfile));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getColor",value:function(e){switch(e){default:case"GET":return le.palette.success.main;case"POST":return le.palette.error.main;case"PUT":return le.palette.warning.main;case"DELETE":return le.palette.info.main}}},{key:"onSelectProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({selectProfile:t}),e.next=3,(new z).get().fetch("/api/profiles/"+t+"/authorizations");case 3:(n=e.sent).error?this.setState({enabled:!0,message:n.package+" : "+n.message}):this.setState({enabled:!1,message:"",authorizations:n.data});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateSecure",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new z).post({authorization:n,secure:a}).fetch("/api/profiles/"+t+"/authorizations");case 2:(s=e.sent).error?this.setState({enabled:!0,message:s.package+" : "+s.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(g.a,{style:{padding:10,marginBottom:10,flexDirection:"row",display:"flex"},children:this.state.profiles.map((function(t){return Object(y.jsx)(m.a,{style:{marginLeft:5,marginRight:5},onClick:function(){e.onSelectProfile(t.id)},variant:e.state.selectProfile===t.id?"contained":"outlined",children:t.name})}))}),Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(y.jsxs)(at.a,{style:{backgroundColor:le.palette.background.paper,width:"45%"},children:[Object(y.jsx)(Q.a,{children:Object(y.jsx)(it.a,{children:Object(y.jsx)(D.a,{variant:"subtitle1",style:{display:"flex",padding:3,borderRadius:3,backgroundColor:le.palette.error.main,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center"},children:"Refus\xe9"})})}),Object(y.jsx)(J.a,{}),this.state.authorizations.sort((function(e,t){return e.method<t.method})).filter((function(e){return 0===e.secure})).map((function(t){return Object(y.jsx)(Q.a,{button:!0,onClick:function(){e.updateSecure(e.state.selectProfile,t.id,1)},children:Object(y.jsx)(it.a,{style:{display:"flex",flexDirection:"row"},children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(y.jsx)(D.a,{variant:"body",style:{padding:3,paddingLeft:8,paddingRight:8,borderRadius:3,backgroundColor:e.getColor(t.method)},children:t.method}),Object(y.jsx)(D.a,{variant:"body",style:{padding:3,borderRadius:3,marginLeft:5},children:t.reference})]})})})}))]}),Object(y.jsxs)(at.a,{style:{backgroundColor:le.palette.background.paper,width:"45%"},children:[Object(y.jsx)(Q.a,{children:Object(y.jsx)(it.a,{children:Object(y.jsx)(D.a,{variant:"subtitle1",style:{display:"flex",padding:3,borderRadius:3,backgroundColor:le.palette.success.main,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center"},children:"Authoris\xe9"})})}),Object(y.jsx)(J.a,{}),this.state.authorizations.sort((function(e,t){return e.method<t.method})).filter((function(e){return 1===e.secure})).map((function(t){return Object(y.jsx)(Q.a,{button:!0,onClick:function(){e.updateSecure(e.state.selectProfile,t.id,0)},children:Object(y.jsx)(it.a,{style:{display:"flex",flexDirection:"row"},children:Object(y.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(y.jsx)(D.a,{variant:"body",style:{padding:3,paddingLeft:8,paddingRight:8,borderRadius:3,backgroundColor:e.getColor(t.method)},children:t.method}),Object(y.jsx)(D.a,{variant:"body",style:{padding:3,borderRadius:3,marginLeft:5},children:t.reference})]})})})}))]})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),xt=n(29),vt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={isMobile:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.mediaQueries("(max-width: 900px)")}},{key:"mediaQueries",value:function(e){var t=this,n=window.matchMedia(e);this.setState({isMobile:n.matches});n.addListener((function(e){return t.setState({isMobile:e.matches})}))}},{key:"render",value:function(){var e=this;return Object(y.jsxs)(S.a,{basename:"/admin",children:[Object(y.jsx)(jt,{isMobile:this.state.isMobile,onDisconnect:function(){e.props.onDisconnect()}}),Object(y.jsx)("main",{style:{padding:20,width:this.state.isMobile?"95vw":"80vw",height:"100vh"},children:Object(y.jsx)("div",{style:{marginLeft:this.state.isMobile?0:240,marginTop:this.state.isMobile?0:32},children:Object(y.jsxs)(xt.c,{children:[Object(y.jsx)(xt.a,{exact:!0,path:"/smartobject",component:W}),Object(y.jsx)(xt.a,{exact:!0,path:"/smartobject/new",component:be}),Object(y.jsx)(xt.a,{exact:!0,path:"/smartobject/:id",component:he}),Object(y.jsx)(xt.a,{exact:!0,path:"/module",component:ze}),Object(y.jsx)(xt.a,{exact:!0,path:"/module/:id",component:We}),Object(y.jsx)(xt.a,{exact:!0,path:"/routine",component:Re}),Object(y.jsx)(xt.a,{exact:!0,path:"/routine/new",component:Ie}),Object(y.jsx)(xt.a,{exact:!0,path:"/routine/:id",component:Be}),Object(y.jsx)(xt.a,{exact:!0,path:"/widget",component:He}),Object(y.jsx)(xt.a,{exact:!0,path:"/widget/new",component:Qe}),Object(y.jsx)(xt.a,{exact:!0,path:"/widget/authorization",component:He}),Object(y.jsx)(xt.a,{exact:!0,path:"/widget/authorization",component:He}),Object(y.jsx)(xt.a,{exact:!0,path:"/widget/:id",component:qe}),Object(y.jsx)(xt.a,{exact:!0,path:"/process",component:pe}),Object(y.jsx)(xt.a,{exact:!0,path:"/process/new",component:ye}),Object(y.jsx)(xt.a,{exact:!0,path:"/process/:id",component:ke}),Object(y.jsx)(xt.a,{exact:!0,path:"/qrcode/:id",component:et}),Object(y.jsx)(xt.a,{exact:!0,path:"/user",component:Xe}),Object(y.jsx)(xt.a,{exact:!0,path:"/user/new",component:Ye}),Object(y.jsx)(xt.a,{exact:!0,path:"/user/:id/password",component:tt}),Object(y.jsx)(xt.a,{exact:!0,path:"/configuration",component:Ue}),Object(y.jsx)(xt.a,{exact:!0,path:"/market",component:_e}),Object(y.jsx)(xt.a,{exact:!0,path:"/localisation",component:bt}),Object(y.jsx)(xt.a,{exact:!0,path:"/localisation/new",component:pt}),Object(y.jsx)(xt.a,{exact:!0,path:"/localisation/:id",component:ft}),Object(y.jsx)(xt.a,{exect:!0,path:"/authorisation",component:mt})]})})})]})}}]),n}(s.a.Component),Ot=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={authentification:!0,enabled:!1,message:"",password:"",confirmePassword:"",login:"admin",isMobile:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.mediaQueries("(max-width: 900px)")}},{key:"mediaQueries",value:function(e){var t=this,n=window.matchMedia(e);this.setState({isMobile:n.matches});n.addListener((function(e){return t.setState({isMobile:e.matches})}))}},{key:"register",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.password!=this.state.confirmePassword){e.next=7;break}return e.next=3,(new z).put({password:this.state.password}).fetch("/api/getstarted");case 3:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):this.props.onFinish(),e.next=8;break;case 7:this.setState({enabled:!0,message:"Password and password confirmation is not the same"});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)(g.a,{elevation:3,style:{padding:30,width:this.state.isMobile?"400px":"30vw",textAlign:"center"},children:[Object(y.jsxs)("div",{children:[Object(y.jsx)("img",{src:"/admin/logo.svg",style:{height:"15vh",width:"15vh",borderRadius:7}}),Object(y.jsx)("div",{style:{fontSize:70,fontWeight:"bold",marginTop:0,lineHeight:.5},children:"Intendant"}),Object(y.jsx)("div",{style:Object(c.a)({fontSize:14,fontWeight:"bold",marginTop:0,lineHeight:1},"marginTop",30),children:"At the first launch, you must set the admin password"})]}),Object(y.jsxs)("div",{noValidate:!0,autoComplete:"off",style:{marginBottom:10},children:[Object(y.jsx)("div",{style:{marginTop:10},children:Object(y.jsx)(f.a,{value:this.state.password,fullWidth:!0,label:"Password",type:"password",inputProps:{maxLength:12},onChange:function(t){e.setState({password:t.nativeEvent.target.value})}})}),Object(y.jsx)("div",{style:{marginTop:10},children:Object(y.jsx)(f.a,{value:this.state.confirmePassword,fullWidth:!0,label:"Confirmation",type:"password",inputProps:{maxLength:12},onChange:function(t){e.setState({confirmePassword:t.nativeEvent.target.value})}})}),Object(y.jsx)("div",{style:{marginTop:15,textAlign:"end"},children:Object(y.jsx)(m.a,{variant:"plain",onClick:function(){e.register()},children:"Let's get started"})})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),yt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={authentification:!0,enabled:!1,getStarted:!1,message:"",password:"",customAddress:!1,address:window.location.origin,login:"admin",isMobile:!1},a}return Object(h.a)(n,[{key:"mediaQueries",value:function(e){var t=this,n=window.matchMedia(e);this.setState({isMobile:n.matches});n.addListener((function(e){return t.setState({isMobile:e.matches})}))}},{key:"componentDidMount",value:function(){var e=localStorage.getItem("server");e&&this.setState({address:e.replace("http://","")}),this.mediaQueries("(max-width: 900px)")}},{key:"login",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkServer();case 2:if(!e.sent){e.next=7;break}return e.next=5,(new z).post({login:this.state.login,password:this.state.password}).fetch("/api/authentification");case 5:(t=e.sent).error?this.setState({enabled:!0,message:t.package+" : "+t.message}):(localStorage.setItem("authorization",t.token),this.setState({enabled:!1,message:"",authentification:!1}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){localStorage.removeItem("authorization"),this.setState({authentification:!0,password:""})}},{key:"checkServer",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!0,n=window.location.protocol+"//",this.state.address.split("://").length>1&&(n=""),e.prev=3,e.next=6,fetch(n+this.state.address+"/api/ping",{},2e3);case 6:return a=e.sent,e.next=9,a.json();case 9:if("pong"==(s=e.sent).message){e.next=15;break}this.setState({enabled:!0,message:"Connection to server failed"}),t=!1,e.next=19;break;case 15:if(localStorage.setItem("server",n+this.state.address),!s.getStarted){e.next=19;break}return this.setState({getStarted:!0}),e.abrupt("return",!1);case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(3),this.setState({enabled:!0,message:"Connection to server failed"}),t=!1;case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}}),e,this,[[3,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.getStarted?Object(y.jsx)(Ot,{onFinish:function(){e.setState({getStarted:!1})}}):this.state.authentification?Object(y.jsxs)(g.a,{elevation:3,style:{padding:30,width:this.state.isMobile?"400px":"25vw",textAlign:"center"},children:[Object(y.jsxs)("div",{children:[Object(y.jsxs)("div",{style:{marginBottom:50},children:[Object(y.jsx)("img",{onClick:function(){e.setState({customAddress:!e.state.customAddress})},src:"/admin/logo.svg",style:{height:"15vh",width:"15vh",borderRadius:7,cursor:"pointer"}}),Object(y.jsx)("div",{style:{fontSize:55,fontWeight:"bold",marginTop:0,lineHeight:.5},children:"Intendant"}),Object(y.jsx)("div",{style:Object(c.a)({fontSize:20,fontWeight:"bold",marginTop:0,lineHeight:1},"marginTop",15),children:"Administration"})]}),Object(y.jsxs)("form",{noValidate:!0,onSubmit:function(t){t.preventDefault(),e.login()},autoComplete:"off",style:{marginBottom:10},children:[this.state.customAddress?Object(y.jsx)("div",{style:{padding:5},children:Object(y.jsx)(f.a,{value:this.state.address,fullWidth:!0,label:"Server address",autoFocus:!0,onChange:function(t){e.setState({address:t.nativeEvent.target.value})}})}):null,Object(y.jsx)("div",{style:{padding:5},children:Object(y.jsx)(f.a,{value:this.state.login,fullWidth:!0,label:"Login",autoComplete:"current-login",inputProps:{maxLength:12},onChange:function(t){e.setState({login:t.nativeEvent.target.value})}})}),Object(y.jsx)("div",{style:{padding:5},children:Object(y.jsx)(f.a,{value:this.state.password,fullWidth:!0,label:"Password",type:"password",autoComplete:"current-login",inputProps:{maxLength:12},onChange:function(t){e.setState({password:t.nativeEvent.target.value})}})}),Object(y.jsx)("div",{style:{padding:5,marginTop:5,textAlign:"end"},children:Object(y.jsx)(m.a,{type:"submit",variant:"plain",on:!0,onSubmit:function(){e.login()},onClick:function(){e.login()},children:"Connection"})})]})]}),Object(y.jsx)(w,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(y.jsx)(vt,{onDisconnect:function(){e.disconnect()}})}}]),n}(s.a.Component),wt=n(417),St=n(418),kt=n(420);var Ct=function(){return Object(y.jsxs)(wt.a,{theme:le,children:[Object(y.jsx)(St.a,{}),Object(y.jsx)(kt.a,{style:{userSelect:"none",outline:"none",WebkitTapHighlightColor:"rgba(41,108,71,0.33)",height:"100vh",width:"100wh",backgroundColor:le.palette.background.default,display:"flex",flexDirection:"column",alignSelf:"center",justifyContent:"center",alignContent:"center",alignItems:"center"},children:Object(y.jsx)(yt,{})})]})};r.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(Ct,{})}),document.getElementById("root"))},88:function(e){e.exports=JSON.parse('{"name":"@intendant/dashboard","homepage":"/admin/","dependencies":{"@emotion/react":"^11.7.1","@emotion/styled":"^11.6.0","@material-ui/core":"^4.11.3","@material-ui/lab":"^4.0.0-alpha.57","@mui/icons-material":"^5.2.5","@mui/material":"^5.2.5","md5":"^2.3.0","moment":"^2.29.1","qrcode.react":"^1.0.1","react":"^17.0.2","react-color":"^2.19.3","react-dom":"^17.0.2","react-json-pretty":"^2.2.0","react-router-dom":"^5.2.0","react-scripts":"4.0.3"},"scripts":{"build":"react-scripts build","start":"react-scripts start"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')}},[[349,1,2]]]);
//# sourceMappingURL=main.8c2284f6.chunk.js.map