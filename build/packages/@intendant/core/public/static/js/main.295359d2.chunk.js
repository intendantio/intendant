(this["webpackJsonp@intendant/dashboard"]=this["webpackJsonp@intendant/dashboard"]||[]).push([[0],{129:function(e){e.exports=JSON.parse("{}")},329:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),i=n(21),r=n.n(i),c=n(48),o=n(5),l=n.n(o),d=n(10),u=n(11),h=n(12),j=n(14),b=n(13),p=(n(129),n(193)),f=n(402),g=n(381),x=n(180),m=n(397),O=n(399),v=n(2);var y=function(e){return Object(v.jsx)(O.a,{open:e.open,autoHideDuration:6e3,onClose:function(){return e.onClose()},children:Object(v.jsx)(m.a,Object(x.a)({severity:e.severity,elevation:6,variant:"filled"},e))})},w=n(20),S=n(120),C=n.n(S),k=n(131),T=n(66),D=n(368),R=n(369),I=n(370),M=n(371),P=n(372),A=n(373),E=n(332),B=n(396),W=(n(26),n(140),function(){function e(){Object(u.a)(this,e),this.method="GET"}return Object(h.a)(e,[{key:"post",value:function(e){return this.method="POST",this.data=e,this}},{key:"get",value:function(){return this.method="GET",this}},{key:"delete",value:function(){return this.method="DELETE",this}},{key:"put",value:function(e){return this.method="PUT",this.data=e,this}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("authorization"),a=localStorage.getItem("server"),e.prev=2,e.next=5,fetch(a+t,{method:this.method,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n},body:"POST"==this.method||"PUT"==this.method?JSON.stringify(this.data):null});case 5:return s=e.sent,e.next=8,s.json();case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",{error:!0,message:"An error has occurred"});case 14:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}())}]),e}()),L=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",smartobjects:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/smartobjects");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({enabled:!1,message:"",smartobjects:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)(v.Fragment,{children:[this.state.loading?Object(v.jsx)(p.a,{style:{display:"flex",padding:10,alignContent:"center",justifyContent:"center",alignItems:"center",alignSelf:"center"},children:Object(v.jsx)(T.a,{variant:"subtitle1",style:{fontSize:18},children:"Chargement des smartobject"})}):Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Reference"})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:"Status"})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:"Last use"})})]})}),Object(v.jsx)(A.a,{children:this.state.smartobjects.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(v.jsx)(w.b,{to:"/smartobject/"+e.id,style:{textDecoration:"none",color:"white",display:"contents"},children:Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.reference})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:Object(v.jsx)("img",{style:{height:25,width:25,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/"+e.status.icon+".svg"})})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:C()(e.lastUse).format("hh:mm DD/MM")})})]},e.name)})}))})]})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"/smartobject/new",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:Object(v.jsx)(k.a,{})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.smartobjects.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),z=n(62),N=n.n(z),J=n(380),_=n(333),U=n(382),F=n(383),H=n(143),Q=n(136),V=n(135),G=n(379),q=n(403),K=n(395),X=n(374),Y=n(404),Z=n(189),$=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={action:a.props.action,setState:a.props.setState,value:a.props.action.default},a}return Object(h.a)(n,[{key:"updateAction",value:function(e,t){var n={};n["argument-"+e.id]=t,this.state.setState(n),this.setState({value:t})}},{key:"render",value:function(){var e=this;switch(this.state.action.type){case"text":case"number":return Object(v.jsx)("div",{elevation:3,style:{alignItems:"center",display:"flex",marginRight:10,minWidth:"150px"},children:Object(v.jsx)(f.a,{variant:"outlined",placeholder:this.state.action.id,onChange:function(t){e.updateAction(e.state.action,t.currentTarget.value)}})});case"select":return Object(v.jsx)("div",{elevation:3,style:{alignItems:"center",display:"flex",marginRight:10},children:Object(v.jsxs)(G.a,{variant:"outlined",style:{width:"150px"},children:[Object(v.jsx)(q.a,{children:this.state.action.id}),Object(v.jsx)(K.a,{onChange:function(t){e.updateAction(e.state.action,t.target.value)},label:this.state.action.id,children:this.state.action.values.map((function(e){return Object(v.jsx)(X.a,{value:e,children:e})}))})]})});case"colorpicker":return Object(v.jsxs)(p.a,{elevation:3,style:{alignItems:"center",display:"flex",padding:10,marginRight:5},children:[Object(v.jsx)(T.a,{variant:"body1",style:{textAlign:"start",marginBottom:5,marginRight:10},children:this.state.action.id.toUpperCase()}),Object(v.jsx)(Z.a,{triangle:"hide",color:this.state.value,onChangeComplete:function(t){e.updateAction(e.state.action,t.hex)}})]});case"slider":return Object(v.jsxs)(p.a,{elevation:3,style:{alignItems:"center",display:"flex",padding:10,marginRight:5},children:[Object(v.jsx)(T.a,{variant:"body1",style:{textAlign:"start",marginBottom:5},children:this.state.action.id.toUpperCase()}),Object(v.jsx)(Y.a,{defaultValue:0,valueLabelDisplay:"auto",orientation:this.props.orientation?this.props.orientation:"horizontal",min:this.state.action.min,max:this.state.action.max,step:this.state.action.step,onChange:function(t,n){e.updateAction(e.state.action,n)}})]});default:return null}}}]),n}(s.a.Component),ee=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={id:e.match.params.id,smartobject:null,profiles:[],enabled:!1,message:"",referenceSettings:"",valueSettings:"",executeInformation:""},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/profiles");case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/smartobjects/"+this.state.id);case 5:n=e.sent,t.error||n.error?this.props.history.push("/smartobject"):this.setState({smartobject:n.data,profiles:t.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/smartobjects/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.props.history.push("/smartobject");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"executeAction",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,s,i,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a={},s=0;s<n.length;s++)i=n[s],void 0==(r=this.state["argument-"+i.id])&&(r=i.default),a[i.id]=r;return e.next=4,(new W).post({settings:a}).fetch("/api/smartobjects/"+this.state.id+"/actions/"+t);case 4:(c=e.sent).error?this.setState({enabled:!0,message:c.code+" : "+c.message}):(c.data&&this.setState({executeInformation:JSON.stringify(c.data)}),this.componentDidMount());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteSmartobjectSettings",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/smartobjects/"+t.smartobject+"/settings/"+t.id);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertSmartobjectSettings",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).post({reference:n,value:a}).fetch("/api/smartobjects/"+t+"/settings");case 2:(s=e.sent).error?this.setState({enabled:!0,message:s.code+" : "+s.message}):(this.setState({referenceSettings:"",valueSettings:""}),this.componentDidMount());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"insertProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).post({idProfile:n.id}).fetch("/api/smartobjects/"+t.id+"/profiles");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.code+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/smartobjects/"+t.id+"/profiles/"+n.id);case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.code+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.smartobject?Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,marginBottom:10,justifyContent:"left"},children:[Object(v.jsxs)("div",{style:{padding:10},children:[Object(v.jsx)(T.a,{variant:"h4",children:this.state.smartobject.reference}),Object(v.jsx)(T.a,{variant:"subtitle1",children:this.state.smartobject.module})]}),Object(v.jsx)(J.a,{}),Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Configuration"}),Object(v.jsx)("div",{style:{marginTop:10,marginBottom:10,display:"flex",flexDirection:"row"},children:Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(A.a,{children:[this.state.smartobject.settings.map((function(t){return Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:t.reference})}),Object(v.jsx)(P.a,{align:"left",style:{width:"70%"},children:Object(v.jsx)(T.a,{variant:"subtitle1",children:t.value.slice(0,50)+(t.value.length>50?" (...)":"")})}),Object(v.jsx)(P.a,{align:"right",style:{padding:4},children:Object(v.jsx)(E.a,{onClick:function(){navigator.clipboard.writeText(t.value)},style:{borderRadius:5,margin:0},children:Object(v.jsx)(H.a,{})})}),Object(v.jsx)(P.a,{align:"right",style:{padding:4},children:Object(v.jsx)(E.a,{onClick:function(){e.deleteSmartobjectSettings(t)},style:{borderRadius:5,margin:0},children:Object(v.jsx)(Q.a,{})})})]},t.id)})),Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(f.a,{value:this.state.referenceSettings,onChange:function(t){e.setState({referenceSettings:t.nativeEvent.target.value})},placeholder:"Name",style:{width:"100%"}})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(f.a,{value:this.state.valueSettings,onChange:function(t){e.setState({valueSettings:t.nativeEvent.target.value})},placeholder:"Value",style:{width:"100%"}})}),Object(v.jsx)(P.a,{align:"right",style:{padding:4},children:Object(v.jsx)(E.a,{onClick:function(){e.insertSmartobjectSettings(e.state.smartobject.id,e.state.referenceSettings,e.state.valueSettings)},style:{borderRadius:5,margin:0},children:Object(v.jsx)(k.a,{})})})]},"-1")]})})})]}),Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Action"}),this.state.smartobject.actions.map((function(t){return Object(v.jsxs)(p.a,{style:{padding:10,marginTop:10,marginBottom:10,display:"flex",flexDirection:"column",width:"100%",maxWidth:"100%"},children:[Object(v.jsx)(g.a,{onClick:function(){e.executeAction(t.id,t.settings)},variant:"outlined",style:{width:"250px",height:"100%"},children:t.name}),t.settings.length>0?Object(v.jsx)("div",{style:{display:"grid",gridRowGap:"10px",gridTemplateColumns:"repeat(5,min-content)",marginTop:10,marginBottom:10},children:t.settings.map((function(t){return Object(v.jsx)($,{orientation:"vertical",setState:e.setState.bind(e),action:t})}))}):null]})}))]}),this.state.executeInformation.length>0?Object(v.jsx)("div",{style:{padding:10},children:Object(v.jsx)(m.a,{severity:"success",action:Object(v.jsx)(E.a,{onClick:function(){e.setState({executeInformation:""})},style:{alignSelf:"start"},color:"inherit",size:"small",children:Object(v.jsx)(V.a,{})}),children:Object(v.jsx)(N.a,{id:"json-pretty",data:JSON.parse(this.state.executeInformation)})})}):null,Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Authorization"}),this.state.profiles.map((function(t){var n=!1;return e.state.smartobject.profiles.forEach((function(e){e.profile==t.id&&(n=!0)})),Object(v.jsx)(_.a,{style:{padding:1},children:Object(v.jsx)(U.a,{control:Object(v.jsx)(F.a,{checked:n,onChange:function(){n?e.deleteProfile(e.state.smartobject,t):e.insertProfile(e.state.smartobject,t)},color:"primary"}),label:t.name})})}))]})]}),Object(v.jsx)(p.a,{style:{width:"min-content",marginTop:10,marginBottom:10,alignContent:"center",justifyContent:"center",alignSelf:"center"},children:Object(v.jsx)(E.a,{onClick:function(){e.delete(e.state.id)},style:{borderRadius:5},children:Object(v.jsx)(Q.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),te=n(150),ne=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={module:!1,reference:"",enabled:!1,message:"",types:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/configurations/smartobject");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({enabled:!1,message:"",types:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setModule",value:function(e){var t=this;this.state.types.forEach((function(n){n.id===e&&t.setState({module:n})}))}},{key:"updateSettings",value:function(e,t){var n={};n["settings-"+e]=t,this.setState(n)}},{key:"add",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.reference){e.next=4;break}this.setState({enabled:!0,message:"Missing-parameter : reference is empty"}),e.next=14;break;case 4:if(""!==this.state.module.name){e.next=8;break}this.setState({enabled:!0,message:"Missing-parameter : type not selected"}),e.next=14;break;case 8:for(t=[],n=0;n<this.state.module.settings.length;n++)a=this.state.module.settings[n],t.push({reference:a.id,value:this.state["settings-"+a.name]?this.state["settings-"+a.name]:""});return e.next=12,(new W).post({module:this.state.module.id,reference:this.state.reference,settings:t}).fetch("/api/smartobjects");case 12:(s=e.sent).error?this.setState({enabled:!0,message:s.code+" : "+s.message}):this.props.history.push("/smartobject");case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between"},children:Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"start",flexDirection:"row",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(v.jsx)(f.a,{onChange:function(t){e.setState({reference:t.nativeEvent.target.value})},style:{width:"150px",marginRight:10},label:"Reference",variant:"outlined"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginRight:10,width:"300px"},children:[Object(v.jsx)(q.a,{children:"Module"}),Object(v.jsx)(K.a,{value:this.state.module.id,onChange:function(t){e.setModule(t.target.value)},label:"Connexion",children:this.state.types.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]})]})}),this.state.module?0===this.state.module.settings.length?null:Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:10},children:[Object(v.jsx)(T.a,{variant:"body1",style:{fontSize:20},children:"Configuration"}),this.state.module.settings.map((function(t){return Object(v.jsx)(f.a,{onChange:function(n){e.updateSettings(t.name,n.nativeEvent.target.value)},style:{width:"300px",marginTop:10},label:t.name,variant:"outlined"})}))]}):null]}),Object(v.jsx)(p.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(v.jsx)(E.a,{onClick:function(){e.add()},style:{borderRadius:0},variant:"outlined",children:Object(v.jsx)(te.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),ae=n(378),se=n(385),ie=n(405),re=n(190),ce=n(96),oe=n(384),le=Object(ie.a)(Object(re.a)({palette:{type:"dark",primary:{main:ce.a[600]},secondary:{main:oe.a[500]}},typography:{fontFamily:"'Poppins', sans-serif",fontWeightLight:400,fontWeightRegular:500,fontWeightMedium:600},shape:{borderRadius:4}})),de=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",profiles:[],selectProfile:"",authorizations:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/profiles");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):""===this.state.selectProfile?(this.setState({enabled:!1,message:"",profiles:t.data,selectProfile:t.data[0].id}),this.onSelectProfile(t.data[0].id)):(this.setState({enabled:!1,message:"",profiles:t.data}),this.onSelectProfile(this.state.selectProfile));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getColor",value:function(e){switch(e){default:case"GET":return le.palette.success.main;case"POST":return le.palette.error.main;case"PUT":return le.palette.warning.main;case"DELETE":return le.palette.info.main}}},{key:"onSelectProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({selectProfile:t}),e.next=3,(new W).get().fetch("/api/profiles/"+t+"/authorizations");case 3:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.setState({enabled:!1,message:"",authorizations:n.data});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateSecure",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).post({authorization:n,secure:a}).fetch("/api/profiles/"+t+"/authorizations");case 2:(s=e.sent).error?this.setState({enabled:!0,message:s.code+" : "+s.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(p.a,{style:{padding:10,marginBottom:10,flexDirection:"row",display:"flex"},children:this.state.profiles.map((function(t){return Object(v.jsx)(g.a,{style:{marginLeft:5,marginRight:5},onClick:function(){e.onSelectProfile(t.id)},variant:e.state.selectProfile===t.id?"contained":"outlined",children:t.name})}))}),Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(v.jsxs)(ae.a,{style:{backgroundColor:le.palette.background.paper,width:"45%"},children:[Object(v.jsx)(_.a,{children:Object(v.jsx)(se.a,{children:Object(v.jsx)(T.a,{variant:"subtitle1",style:{display:"flex",padding:3,borderRadius:3,backgroundColor:le.palette.error.main,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center"},children:"Refus\xe9"})})}),Object(v.jsx)(J.a,{}),this.state.authorizations.sort((function(e,t){return e.method<t.method})).filter((function(e){return 0===e.secure})).map((function(t){return Object(v.jsx)(_.a,{button:!0,onClick:function(){e.updateSecure(e.state.selectProfile,t.id,1)},children:Object(v.jsx)(se.a,{style:{display:"flex",flexDirection:"row"},children:Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(v.jsx)(T.a,{variant:"body",style:{padding:3,paddingLeft:8,paddingRight:8,borderRadius:3,backgroundColor:e.getColor(t.method)},children:t.method}),Object(v.jsx)(T.a,{variant:"body",style:{padding:3,borderRadius:3,marginLeft:5},children:t.reference})]})})})}))]}),Object(v.jsxs)(ae.a,{style:{backgroundColor:le.palette.background.paper,width:"45%"},children:[Object(v.jsx)(_.a,{children:Object(v.jsx)(se.a,{children:Object(v.jsx)(T.a,{variant:"subtitle1",style:{display:"flex",padding:3,borderRadius:3,backgroundColor:le.palette.success.main,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center"},children:"Authoris\xe9"})})}),Object(v.jsx)(J.a,{}),this.state.authorizations.sort((function(e,t){return e.method<t.method})).filter((function(e){return 1===e.secure})).map((function(t){return Object(v.jsx)(_.a,{button:!0,onClick:function(){e.updateSecure(e.state.selectProfile,t.id,0)},children:Object(v.jsx)(se.a,{style:{display:"flex",flexDirection:"row"},children:Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(v.jsx)(T.a,{variant:"body",style:{padding:3,paddingLeft:8,paddingRight:8,borderRadius:3,backgroundColor:e.getColor(t.method)},children:t.method}),Object(v.jsx)(T.a,{variant:"body",style:{padding:3,borderRadius:3,marginLeft:5},children:t.reference})]})})})}))]})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),ue=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",processs:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/process");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({processs:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsx)(A.a,{children:this.state.processs.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(v.jsx)(w.b,{to:"/process/"+e.id,style:{textDecoration:"none",color:"white",display:"contents"},children:Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)("img",{style:{width:30,height:30,filter:"invert(100%)"},src:"/admin/ressource/icon/"+e.icon+".svg"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.reference})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.description})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.espace.reference})})]},e.name)})}))})})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"/process/new",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:Object(v.jsx)(k.a,{})})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.processs.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),he=n(387),je=n(377),be=n(386),pe=n(398),fe=n(146),ge=function(){function e(){Object(u.a)(this,e)}return Object(h.a)(e,null,[{key:"getSource",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],e.next=3,(new W).get().fetch("/api/smartobjects");case 3:return n=e.sent,e.next=6,(new W).get().fetch("/api/configurations/module");case 6:return a=e.sent,e.next=9,(new W).get().fetch("/api/process");case 9:if(!(s=e.sent).error){e.next=14;break}return e.abrupt("return",s);case 14:if(!a.error){e.next=18;break}return e.abrupt("return",a);case 18:if(!n.error){e.next=22;break}return e.abrupt("return",n);case 22:return i=[],t.includes("smartobject")&&n.data.forEach((function(e){var t=[];e.actions.forEach((function(e){t.push({id:e.id,name:e.name,settings:e.settings})})),i.push({id:e.id,name:"Smartobject "+e.reference,actions:t,type:"smartobject"})})),t.includes("module")&&a.data.forEach((function(e){var t=[];e.actions.forEach((function(e){t.push({id:e.id,name:e.name,settings:e.settings})})),i.push({id:e.id,name:"Module "+e.name,actions:t,type:"module"})})),t.includes("process")&&s.data.forEach((function(e){var t=[];"simple"==e.mode?t.push({id:"auto",name:e.name,settings:e.inputs.map((function(e){return{id:e.reference,name:e.name,type:e.type}}))}):(t.push({id:"enable",name:e.name_enable,settings:e.inputs.map((function(e){return{id:e.reference,name:e.name,type:e.type}}))}),t.push({id:"disable",name:e.name_disable,settings:e.inputs.map((function(e){return{id:e.reference,name:e.name,type:e.type}}))})),i.push({id:e.id,name:"Processus "+e.reference,actions:t,type:"process"})})),e.abrupt("return",{data:i,error:!1,code:"",message:""});case 27:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),xe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={icons:[],mode:"normal"},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/admin/ressource/icon.json");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,this.setState({icons:n}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.setState({icons:[]});case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)(be.a,{container:!0,spacing:1,style:{width:"32vw",height:"32vw",padding:10,marginRight:10},children:[Object(v.jsx)(be.a,{item:!0,xs:6,children:Object(v.jsx)(p.a,{onClick:function(){e.setState({mode:"normal"})},style:{cursor:"pointer",display:"flex",justifyContent:"center",alignContent:"center",padding:5,alignItems:"center",alignSelf:"center"},children:Object(v.jsx)("img",{style:{height:30,width:30,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/star.svg"})})}),Object(v.jsx)(be.a,{item:!0,xs:6,children:Object(v.jsx)(p.a,{onClick:function(){e.setState({mode:"outline"})},style:{cursor:"pointer",display:"flex",justifyContent:"center",alignContent:"center",padding:5,alignItems:"center",alignSelf:"center"},children:Object(v.jsx)("img",{style:{height:30,width:30,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/star-outline.svg"})})}),this.state.icons.filter((function(t){return-1!=t.search("outline")&&"outline"==e.state.mode||-1==t.search("outline")&&"normal"==e.state.mode})).map((function(t){return Object(v.jsx)(be.a,{item:!0,xs:!0,children:Object(v.jsx)(p.a,{onClick:function(){e.props.onSelect&&e.props.onSelect(t)},style:{cursor:"pointer",display:"flex",justifyContent:"center",alignContent:"center",padding:5,alignItems:"center",alignSelf:"center"},children:Object(v.jsx)("img",{style:{height:30,width:30,alignSelf:"center",filter:"invert(100%)"},src:"/admin/ressource/icon/"+t+".svg"})})})}))]})}}]),n}(s.a.Component),me=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,popup:!1,message:"",espaces:[],reference:"",icon:"",description:"",name:"",name_disable:"",name_enable:"",mode:"simple",module:null,espace:!1,inputReference:"",inputName:"",inputType:null,inputMode:!1,inputs:[],sources:[],isChecked:!1,action:null,source:null,arrSources:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.getSource(["smartobject","module"]);case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/espaces");case 5:n=e.sent,t.error?this.setState({enabled:!0,message:t.code+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.setState({enabled:!1,message:"",espaces:n.data,sources:t.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=!1;this.state.sources.forEach((function(n){n.id===e&&(t=n)})),this.setState({source:t})}},{key:"setAction",value:function(e){var t=!1;this.state.source.actions.forEach((function(n){n.id===e&&(t=n)})),this.setState({action:t})}},{key:"setInput",value:function(){if(""!==this.state.inputReference)if(""!==this.state.inputType)if(""!==this.state.inputName){var e=this.state.inputs;e.push({name:this.state.inputName,type:this.state.inputType,reference:this.state.inputReference,enable:this.state.inputMode?1:0}),this.setState({inputs:e,inputName:"",inputType:null,inputReference:"",inputMode:!1})}else this.setState({enabled:!0,message:"Name is missing"});else this.setState({enabled:!0,message:"Type is missing"});else this.setState({enabled:!0,message:"Reference is missing"})}},{key:"set",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.reference){e.next=3;break}return this.setState({enabled:!0,message:"Reference is missing"}),e.abrupt("return");case 3:if(""!==this.state.icon){e.next=6;break}return this.setState({enabled:!0,message:"Icon is missing"}),e.abrupt("return");case 6:if(""!==this.state.description){e.next=9;break}return this.setState({enabled:!0,message:"Description is missing"}),e.abrupt("return");case 9:if(!1!==this.state.espace){e.next=12;break}return this.setState({enabled:!0,message:"Espace is missing"}),e.abrupt("return");case 12:return t={description:this.state.description,nameEnable:this.state.name_enable,nameDisable:this.state.name_disable,name:this.state.name,espace:this.state.espace,sources:this.state.arrSources,reference:this.state.reference,icon:this.state.icon,mode:this.state.mode,inputs:this.state.inputs},e.next=15,(new W).post(t).fetch("/api/process");case 15:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.props.history.push("/process");case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateAction",value:function(e,t){var n={};n["argument-"+e.id]=t,this.setState(n)}},{key:"removeModeArgument",value:function(e){var t=[];this.state.inputs.forEach((function(n,a){e!==a&&t.push(n)})),this.setState({inputs:t})}},{key:"confirmationModule",value:function(){if(!1!==this.state.action)if(0!==this.state.source.actions.length){for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s={source:this.state.source,action:this.state.action,arguments:e,enable:this.state.isChecked},i=this.state.arrSources;i.push(s),this.setState({arrSources:i,action:null,source:null,isChecked:!1})}else this.setState({enabled:!0,message:"Module missing"});else this.setState({enabled:!0,message:"Action missing"})}},{key:"removeSource",value:function(e){var t=this,n=[];this.state.arrSources.forEach((function(t,a){e!==a&&n.push(t)})),this.setState({arrSources:[]},(function(){t.setState({arrSources:n})}))}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(v.jsxs)("div",{style:{justifyContent:"start",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(v.jsx)(f.a,{onChange:function(t){e.setState({reference:t.nativeEvent.target.value})},style:{width:"20%",margin:10},label:"R\xe9ference",value:this.state.reference,variant:"outlined"}),Object(v.jsx)(f.a,{onChange:function(t){e.setState({icon:t.nativeEvent.target.value})},style:{width:"20%",margin:10},label:"Icon",variant:"outlined",value:this.state.icon,InputProps:{endAdornment:Object(v.jsx)(he.a,{position:"end",children:Object(v.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(v.jsx)(fe.a,{})})})}}),Object(v.jsx)(je.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(v.jsx)(xe,{onSelect:function(t){e.setState({icon:t,popup:!1})}})}),Object(v.jsx)(f.a,{onChange:function(t){e.setState({description:t.nativeEvent.target.value})},style:{width:"50%",margin:10},label:"Description",variant:"outlined"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{margin:10,width:"150px"},children:[Object(v.jsx)(q.a,{children:"Espace"}),Object(v.jsx)(K.a,{onChange:function(t){e.setState({espace:t.target.value})},label:"Espace",children:this.state.espaces.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}),Object(v.jsx)(T.a,{variant:"h5",style:{margin:10},children:"Mode"}),Object(v.jsxs)(be.a,{style:{margin:10},container:!0,alignItems:"center",children:[Object(v.jsx)(be.a,{item:!0,children:Object(v.jsx)(T.a,{variant:"subtitle1",children:"Simple"})}),Object(v.jsx)(be.a,{item:!0,children:Object(v.jsx)(F.a,{checked:"switch"===this.state.mode,onChange:function(t,n){e.setState({mode:n?"switch":"simple"})},name:"checkedC"})}),Object(v.jsx)(be.a,{item:!0,children:Object(v.jsx)(T.a,{variant:"subtitle1",children:"Switch"})})]}),Object(v.jsx)(D.a,{style:{padding:10,margin:10},component:p.a,children:"switch"===this.state.mode?Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)(f.a,{onChange:function(t){e.setState({name_enable:t.nativeEvent.target.value})},style:{width:"45%",margin:10},label:"Texte actif",variant:"outlined"}),Object(v.jsx)(f.a,{onChange:function(t){e.setState({name_disable:t.nativeEvent.target.value})},style:{width:"45%",margin:10},label:"Texte passif",variant:"outlined"})]}):Object(v.jsx)("div",{children:Object(v.jsx)(f.a,{onChange:function(t){e.setState({name:t.nativeEvent.target.value})},style:{margin:10,width:"45%"},label:"Texte",variant:"outlined"})})}),Object(v.jsx)(T.a,{variant:"h5",style:{margin:10},children:"Argument"}),Object(v.jsxs)(D.a,{style:{padding:10,margin:10},component:p.a,children:[Object(v.jsx)(f.a,{value:this.state.inputReference,onChange:function(t){e.setState({inputReference:t.nativeEvent.target.value})},style:{width:"30%",margin:10},label:"Reference",variant:"outlined"}),Object(v.jsx)(f.a,{value:this.state.inputName,onChange:function(t){e.setState({inputName:t.nativeEvent.target.value})},style:{width:"30%",margin:10},label:"Name",variant:"outlined"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{margin:10,width:"25%"},children:[Object(v.jsx)(q.a,{children:"Type"}),Object(v.jsxs)(K.a,{value:this.state.inputType,onChange:function(t){e.setState({inputType:t.target.value})},label:"Type",children:[Object(v.jsx)(X.a,{value:"text",children:"Text"}),Object(v.jsx)(X.a,{value:"colorpicker",children:"Color picker"}),Object(v.jsx)(X.a,{value:"number",children:"Number"}),Object(v.jsx)(X.a,{value:"slider",children:"Slider"})]})]}),"switch"===this.state.mode?Object(v.jsx)(pe.a,{onChange:function(t,n){e.setState({inputMode:n})}}):null,Object(v.jsx)(g.a,{style:{margin:10},onClick:function(){e.setInput()},variant:"outlined",children:"Ajouter"}),Object(v.jsx)(R.a,{children:Object(v.jsx)(A.a,{children:this.state.inputs.map((function(t,n){return Object(v.jsxs)(M.a,{onClick:function(){},hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.reference})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.name})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.type})}),"switch"===e.state.mode?Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(pe.a,{disabled:!0,defaultChecked:t.mode})}):null,Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.removeModeArgument(n)},children:Object(v.jsx)(Q.a,{})})})]})}))})})]}),Object(v.jsx)(T.a,{variant:"h5",style:{margin:10},children:"Action "}),Object(v.jsx)(D.a,{style:{padding:10,margin:10},component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsxs)(A.a,{children:[this.state.arrSources.map((function(t,n){return Object(v.jsxs)(M.a,{onClick:function(){},hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.source.name})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.action.name})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.arguments.map((function(e){return Object(v.jsx)(T.a,{variant:"body1",children:e.reference+" : "+e.value})}))})}),"simple"===e.state.mode?null:Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(pe.a,{disabled:!0,defaultChecked:t.enable})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(E.a,{onClick:function(){e.removeSource(n)},children:Object(v.jsx)(Q.a,{})})})]})})),Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",style:{minWidth:"30%"},children:Object(v.jsxs)(G.a,{fullWidth:!0,children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Connexion",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]})}),Object(v.jsx)(P.a,{align:"left",style:{width:"30%"},children:this.state.source?Object(v.jsxs)(G.a,{fullWidth:!0,children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Connexion",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null}),Object(v.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(v.jsx)("div",{}),this.state.action?this.state.action.settings.map((function(t){return Object(v.jsx)("div",{style:{marginLeft:10,marginRight:10,marginTop:5,marginBottom:2},children:Object(v.jsx)(f.a,{variant:"outlined",placeholder:t.id,onChange:function(n){e.updateAction(t,n.currentTarget.value,e.state.action)}})})})):null]}),"simple"===this.state.mode?null:Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(pe.a,{onChange:function(t,n){e.setState({isChecked:n})}})})]}),Object(v.jsx)(g.a,{style:{margin:10},onClick:function(){e.confirmationModule()},variant:"outlined",children:"Ajouter"})]})})})]}),Object(v.jsx)(g.a,{style:{margin:10},onClick:function(){e.set()},variant:"outlined",children:"Save"})]}),Object(v.jsxs)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:[" ",this.state.message," "]})]})}}]),n}(s.a.Component),Oe=n(132),ve=n(134),ye=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={id:e.match.params.id,enabled:!1,message:"",process:null,profiles:[],executeInformation:"",referenceInput:"",nameInput:"",typeInput:null,modeInput:0,action:null,source:null,isChecked:!1,sources:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.getSource(["smartobject","module"]);case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/espaces");case 5:return n=e.sent,e.next=8,(new W).get().fetch("/api/profiles");case 8:return a=e.sent,e.next=11,(new W).get().fetch("/api/process/"+this.state.id);case 11:s=e.sent,n.error?this.setState({enabled:!0,message:n.code+" : "+n.message}):s.error?this.setState({enabled:!0,message:s.code+" : "+s.message}):this.setState({process:s.data,profiles:a.data,espaces:n.data,sources:t.data});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=!1;this.state.sources.forEach((function(n){n.id===e&&(t=n)})),this.setState({source:t})}},{key:"setAction",value:function(e){var t=!1;this.state.source.actions.forEach((function(n){n.id===e&&(t=n)})),this.setState({action:t})}},{key:"addSource",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.action){e.next=3;break}return this.setState({enabled:!0,message:"Action missing"}),e.abrupt("return");case 3:if(null!=this.state.source){e.next=6;break}return this.setState({enabled:!0,message:"Source missing"}),e.abrupt("return");case 6:for(t=[],n=0;n<this.state.action.settings.length;n++)a=this.state.action.settings[n],void 0==(s=this.state["argument-"+a.id])&&(s=a.default),t.push({reference:a.id,value:s});return i={source:this.state.source,action:this.state.action,arguments:t,enable:this.state.isChecked},e.next=11,(new W).post(i).fetch("/api/process/"+this.state.id+"/actions");case 11:(r=e.sent).error?this.setState({enabled:!0,message:r.code+" : "+r.message}):this.componentDidMount();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteSource",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/process/"+this.state.id+"/actions/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/process/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.props.history.push("/process");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"executeAction",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=0;n<this.state.process.inputs.length;n++)a=this.state.process.inputs[n],void 0==(s=this.state["argument-"+a.id])&&(s=a.default),t[a.reference]=s;return e.next=4,(new W).post({inputs:t}).fetch("/api/process/"+this.state.process.id+"/execute");case 4:(i=e.sent).error?this.setState({enabled:!0,message:i.code+" : "+i.message}):(i.data&&this.setState({executeInformation:JSON.stringify(i.data)}),this.componentDidMount());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"insertProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).post({idProfile:n.id}).fetch("/api/process/"+t.id+"/profiles");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.code+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/process/"+t.id+"/profiles/"+n.id);case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.code+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteProcessInput",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete({}).fetch("/api/process/"+this.state.process.id+"/inputs/"+t.id);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertProcessInput",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.typeInput){e.next=3;break}return this.setState({enabled:!0,message:"Missing-parameter : type is empty"}),e.abrupt("return");case 3:return e.next=5,(new W).post({reference:this.state.referenceInput,name:this.state.nameInput,type:this.state.typeInput,enable:this.state.modeInput}).fetch("/api/process/"+this.state.process.id+"/inputs");case 5:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):(this.setState({referenceSettings:"",valueSettings:"",referenceInput:"",nameInput:"",modeInput:0}),this.componentDidMount());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateAction",value:function(e,t){var n={};n["argument-"+e.id]=t,this.setState(n)}},{key:"render",value:function(){var e=this;return this.state.process?Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:25},children:[Object(v.jsx)(T.a,{variant:"h4",children:this.state.process.reference}),Object(v.jsx)(T.a,{variant:"subtitle1",children:this.state.process.espace.name}),Object(v.jsx)(T.a,{variant:"subtitle1",children:this.state.process.description}),Object(v.jsx)(J.a,{style:{marginTop:10,marginBottom:10}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(T.a,{variant:"h5",style:{marginBottom:5},children:"Action"}),"simple"==this.state.process.mode?"simple"===this.state.process.mode?Object(v.jsx)(g.a,{style:{alignSelf:"center",marginLeft:10,marginTop:10},variant:2===this.state.process.enable?"contained":"outlined",onClick:function(){e.executeAction()},color:"default",startIcon:Object(v.jsx)(Oe.a,{}),children:this.state.process.name}):null:Object(v.jsx)("div",{style:{flexDirection:"column",display:"flex",width:"20%"},children:1==this.state.process.enable?Object(v.jsx)(g.a,{style:{marginTop:10},variant:"contained",onClick:function(){e.executeAction()},color:"default",startIcon:Object(v.jsx)(ve.a,{}),children:this.state.process.name_enable}):Object(v.jsx)(g.a,{style:{marginTop:10},variant:"outlined",onClick:function(){e.executeAction()},color:"default",startIcon:Object(v.jsx)(V.a,{}),children:this.state.process.name_disable})})]}),Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",marginTop:10,marginBottom:10},children:this.state.process.inputs.filter((function(t){return t.enable==e.state.process.enable})).map((function(t){return Object(v.jsx)($,{setState:e.setState.bind(e),action:t,orientation:"vertical"})}))}),Object(v.jsxs)("div",{style:{marginTop:15},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Input"}),Object(v.jsx)("div",{style:{flexDirection:"column",display:"flex",width:"100%",marginTop:10},children:Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsxs)(A.a,{children:[this.state.process.inputs.map((function(t){return Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.reference})}),Object(v.jsxs)(P.a,{align:"left",children:[Object(v.jsx)(T.a,{variant:"body1",children:t.name})," "]}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.type})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:t.enable})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(E.a,{onClick:function(){e.deleteProcessInput(t)},style:{borderRadius:5,margin:0},children:Object(v.jsx)(Q.a,{})})})]},t.id)})),Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",style:{width:"35%"},children:Object(v.jsx)(f.a,{value:this.state.referenceInput,onChange:function(t){e.setState({referenceInput:t.nativeEvent.target.value})},placeholder:"Reference",style:{width:"100%"}})}),Object(v.jsx)(P.a,{align:"left",style:{width:"35%"},children:Object(v.jsx)(f.a,{value:this.state.nameInput,onChange:function(t){e.setState({nameInput:t.nativeEvent.target.value})},placeholder:"Name",style:{width:"100%"}})}),Object(v.jsx)(P.a,{align:"left",style:{width:"20%"},children:Object(v.jsxs)(G.a,{variant:"outlined",style:{width:"100%"},children:[Object(v.jsx)(q.a,{children:"Type"}),Object(v.jsxs)(K.a,{value:this.state.typeInput,onChange:function(t){e.setState({typeInput:t.target.value})},label:"Type",children:[Object(v.jsx)(X.a,{value:"text",children:"Text"}),Object(v.jsx)(X.a,{value:"colorpicker",children:"Color picker"}),Object(v.jsx)(X.a,{value:"number",children:"Number"}),Object(v.jsx)(X.a,{value:"slider",children:"Slider"})]})]})}),Object(v.jsx)(P.a,{align:"center",style:{width:"10%"},children:"switch"===this.state.process.mode?Object(v.jsx)(pe.a,{value:0==this.state.modeInput,onChange:function(t,n){e.setState({modeInput:n?1:0})}}):null}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(E.a,{onClick:function(){e.insertProcessInput()},style:{borderRadius:5,margin:0},children:Object(v.jsx)(k.a,{})})})]},-1)]})})})})]}),Object(v.jsxs)("div",{style:{marginTop:15},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Module"}),Object(v.jsxs)("div",{style:{flexDirection:"column",display:"flex",width:"100%",marginTop:10},children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Module"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Type"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Action"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Arguments"})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:"Mode"})}),Object(v.jsx)(P.a,{align:"left"})]})}),Object(v.jsx)(A.a,{children:this.state.process.actions.map((function(t){return Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",style:{width:"15%"},children:Object(v.jsx)(T.a,{variant:"body1",children:t.object})}),Object(v.jsxs)(P.a,{align:"left",style:{width:"20%"},children:[Object(v.jsx)(T.a,{variant:"body1",children:t.type})," "]}),Object(v.jsx)(P.a,{align:"left",style:{width:"20%"},children:Object(v.jsx)(T.a,{variant:"body1",children:t.action})}),Object(v.jsx)(P.a,{align:"left",style:{width:"20%"},children:t.arguments.map((function(e){return Object(v.jsx)(T.a,{variant:"body1",children:e.reference+" : "+e.value})}))}),Object(v.jsx)(P.a,{align:"center",style:{width:"15%"},children:0===t.enable?Object(v.jsx)(V.a,{}):1===t.enable?Object(v.jsx)(ve.a,{}):Object(v.jsx)(Oe.a,{})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(E.a,{onClick:function(){e.deleteSource(t.id)},children:Object(v.jsx)(Q.a,{})})})]},t.id)}))})]})}),Object(v.jsx)(D.a,{style:{marginTop:15},component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",style:{width:"25%"},children:Object(v.jsxs)(G.a,{fullWidth:!0,children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Connexion",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]})}),Object(v.jsx)(P.a,{align:"left",style:{width:"25%"},children:this.state.source?Object(v.jsxs)(G.a,{fullWidth:!0,children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Connexion",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null}),Object(v.jsx)(P.a,{align:"left",style:{width:"20%"},children:this.state.action?this.state.action.settings.map((function(t){return Object(v.jsx)("div",{style:{marginLeft:10,marginRight:10,marginTop:5,marginBottom:2},children:Object(v.jsx)(f.a,{variant:"outlined",placeholder:t.id,onChange:function(n){e.updateAction(t,n.currentTarget.value,e.state.action)}})})})):null}),Object(v.jsx)(P.a,{align:"center",style:{width:"5%"},children:"switch"===this.state.process.mode?Object(v.jsx)(pe.a,{onChange:function(t,n){e.setState({isChecked:n})}}):null}),Object(v.jsx)(P.a,{align:"center",style:{width:"5%"},children:Object(v.jsx)(E.a,{onClick:function(){e.addSource()},children:Object(v.jsx)(k.a,{})})})]})})})]})]}),this.state.executeInformation.length>0?Object(v.jsx)("div",{style:{padding:10},children:Object(v.jsx)(y,{severity:"success",action:Object(v.jsx)(E.a,{onClick:function(){e.setState({executeInformation:""})},style:{alignSelf:"start"},color:"inherit",size:"small",children:Object(v.jsx)(V.a,{})}),children:Object(v.jsx)(N.a,{id:"json-pretty",data:JSON.parse(this.state.executeInformation)})})}):null,Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Authorization"}),this.state.profiles.map((function(t){var n=!1;return e.state.process.profiles.forEach((function(e){e.profile==t.id&&(n=!0)})),Object(v.jsx)(_.a,{style:{padding:1},children:Object(v.jsx)(U.a,{control:Object(v.jsx)(F.a,{checked:n,onChange:function(){n?e.deleteProfile(e.state.process,t):e.insertProfile(e.state.process,t)},color:"primary"}),label:t.name})})}))]})]}),Object(v.jsx)(p.a,{style:{width:"min-content",marginTop:10,alignContent:"center",justifyContent:"center",alignSelf:"center"},children:Object(v.jsx)(E.a,{onClick:function(){e.delete(e.state.process.id)},style:{borderRadius:5},children:Object(v.jsx)(Q.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),we=n(149),Se=n(147),Ce=n(139),ke=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,loading:!0,enabled:!1,message:"",routines:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/routines");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({enabled:!1,message:"",loading:!1,routines:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/routines/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"duplicate",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).put().fetch("/api/routines/"+t+"/duplicate");case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateStatus",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).put({status:n}).fetch("/api/routines/"+t+"/status");case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.code+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsx)(A.a,{children:this.state.routines.slice(10*this.state.page,10*(this.state.page+1)).map((function(t){return Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)("img",{style:{width:30,height:30,filter:"invert(100%)"},src:"/admin/ressource/icon/"+t.icon+".svg"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.name})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsxs)("div",{style:{flex:1,flexDirection:"row",display:"flex",alignContent:"center",alignItems:"center",justifyContent:"end"},children:[Object(v.jsx)(E.a,{onClick:function(){e.updateStatus(t.id,0===t.status?1:0)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2,backgroundColor:1===t.status?le.palette.success.main:null},children:0===t.status?Object(v.jsx)(we.a,{}):Object(v.jsx)(Se.a,{})}),Object(v.jsx)(E.a,{onClick:function(){e.props.history.push("/routine/"+t.id)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2},children:Object(v.jsx)(Ce.a,{})}),Object(v.jsx)(E.a,{onClick:function(){e.duplicate(t.id)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2},children:Object(v.jsx)(H.a,{})}),Object(v.jsx)(E.a,{onClick:function(){e.delete(t.id)},style:{borderRadius:3,padding:8,marginLeft:2,marginRight:2},children:Object(v.jsx)(Q.a,{})})]})})]},t.id)}))})})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"/routine/new",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:Object(v.jsx)(k.a,{})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.routines.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Te=n(388),De=n(334),Re=n(389),Ie={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,backgroundColor:le.palette.background.paper,padding:10,borderRadius:5},Me=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state=Object(c.a)({enabled:!1,message:"",routine:null,sources:[],modalTrigger:!1,modalEffect:!1},"routine",{watch:1,triggers:[],effects:[],name:"",icon:""}),a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.getSource(["smartobject","process","module"]);case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({sources:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.setState({action:null,source:null,result:null,statement:null,expected:null})}},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"updateIcon",value:function(e){var t=this.state.routine;t.icon=e,this.setState({routine:t})}},{key:"updateName",value:function(e){var t=this.state.routine;t.name=e,this.setState({routine:t})}},{key:"updateWatch",value:function(e){var t=this.state.routine;t.watch=e,this.setState({routine:t})}},{key:"addTrigger",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.triggers.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e,result:this.state.result,statement:this.state.statement,expected:this.state.expected}),this.setState({routine:s,modalTrigger:!1,action:null,source:null,result:null,statement:null,expected:null})}}},{key:"addEffect",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.effects.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e}),this.setState({routine:s,modalEffect:!1,action:null,source:null})}}},{key:"removeTrigger",value:function(e){var t=this.state.routine,n=t.triggers.filter((function(t,n){return n!=e}));t.triggers=n,this.setState({routine:t})}},{key:"removeEffect",value:function(e){var t=this.state.routine,n=t.effects.filter((function(t,n){return n!=e}));t.effects=n,this.setState({routine:t})}},{key:"save",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.routine.name.length){e.next=4;break}this.setState({enabled:!0,message:"Missing name"}),e.next=16;break;case 4:if(0!=this.state.routine.icon.length){e.next=8;break}this.setState({enabled:!0,message:"Missing icon"}),e.next=16;break;case 8:if(0!=this.state.routine.effects.length){e.next=12;break}this.setState({enabled:!0,message:"Missing effect"}),e.next=16;break;case 12:return e.next=14,(new W).post({name:this.state.routine.name,watch:this.state.routine.watch,icon:this.state.routine.icon,triggers:this.state.routine.triggers,effects:this.state.routine.effects}).fetch("/api/routines");case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.props.history.push("/routine");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.routine?Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(v.jsx)(f.a,{onChange:function(t){e.updateName(t.nativeEvent.target.value)},style:{width:"49%"},value:this.state.routine.name,label:"Name",variant:"outlined"}),Object(v.jsx)(f.a,{onChange:function(t){e.updateIcon(t.nativeEvent.target.value)},value:this.state.routine.icon,label:"Icon",variant:"outlined",style:{width:"49%"},InputProps:{endAdornment:Object(v.jsx)(he.a,{position:"end",children:Object(v.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(v.jsx)(fe.a,{})})})}}),Object(v.jsx)(je.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(v.jsx)(xe,{onSelect:function(t){e.setState({popup:!1}),e.updateIcon(t)}})})]}),Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,marginRight:10,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)("div",{style:{display:"flex",paddingTop:10,paddingBottom:10,paddingLeft:15,paddingRight:15},children:Object(v.jsx)("div",{style:{display:"flex",flex:6,justifyContent:"center"},children:Object(v.jsx)(Y.a,{defaultValue:0,valueLabelDisplay:"auto",orientation:"horizontal",min:0,max:1440,step:1,value:this.state.routine.watch,onChange:function(t,n){e.updateWatch(n)}})})})})]}),Object(v.jsxs)("div",{style:{flexDirection:"row",display:"flex",marginTop:20},children:[Object(v.jsxs)("div",{style:{flex:1,padding:5},children:[Object(v.jsx)(T.a,{variant:"subtitle1",children:"Trigger"}),Object(v.jsxs)(Te.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:["   ",this.state.routine.triggers.map((function(t,n){return Object(v.jsxs)("div",{onClick:function(){return e.removeTrigger(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)(T.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(v.jsx)(T.a,{variant:"body2",children:"Reference : "+t.source}),Object(v.jsx)(T.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(v.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(v.jsxs)(T.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]}),t.result&&t.statement&&t.expected?Object(v.jsxs)("div",{children:[Object(v.jsx)(T.a,{variant:"body2",children:"Pour condition"}),Object(v.jsxs)("div",{style:{marginLeft:20},children:[Object(v.jsx)(T.a,{variant:"body2",children:"Resultat : "+t.result}),Object(v.jsx)(T.a,{variant:"body2",children:"Condition : "+t.statement}),Object(v.jsx)(T.a,{variant:"body2",children:"Expected : "+t.expected})]})]}):null]})})),Object(v.jsx)(g.a,{onClick:function(){e.reset(),e.setState({modalTrigger:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)(k.a,{})})]})]}),Object(v.jsxs)("div",{style:{flex:1,padding:5},children:[Object(v.jsx)(T.a,{variant:"subtitle1",children:"Effect"}),Object(v.jsxs)(Te.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:[this.state.routine.effects.map((function(t,n){return Object(v.jsxs)("div",{onClick:function(){return e.removeEffect(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(v.jsxs)(T.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(v.jsx)(T.a,{variant:"body2",children:"Reference : "+t.source}),Object(v.jsx)(T.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(v.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(v.jsxs)(T.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]})})),Object(v.jsx)(g.a,{onClick:function(){e.reset(),e.setState({modalEffect:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)(k.a,{})})]})]})]})]}),Object(v.jsx)(p.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(v.jsx)(E.a,{onClick:function(){e.save()},style:{borderRadius:0},variant:"outlined",children:Object(v.jsx)(te.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message}),Object(v.jsx)(De.a,{open:this.state.modalTrigger,onClose:function(){e.reset(),e.setState({modalTrigger:!1})},children:Object(v.jsx)(Re.a,{in:this.state.modalTrigger,children:Object(v.jsx)(p.a,{style:Ie,children:Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)(T.a,{variant:"h5",children:"New Trigger"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(v.jsx)($,{setState:e.setState.bind(e),action:t})}))})}):null,Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(v.jsx)(f.a,{variant:"outlined",placeholder:"Result",value:this.state.result,onChange:function(t){e.setState({result:t.currentTarget.value})},style:{width:"100%"}})}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginBottom:5,marginTop:5,flex:1},children:[Object(v.jsx)(q.a,{children:"Condition"}),Object(v.jsxs)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.statement,onChange:function(t){e.setState({statement:t.target.value})},label:"Source",children:[Object(v.jsx)(X.a,{value:"equal",children:"="}),Object(v.jsx)(X.a,{value:"smaller",children:"<"}),Object(v.jsx)(X.a,{value:"bigger",children:">"}),Object(v.jsx)(X.a,{value:"different",children:"<>"})]})]}),Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(v.jsx)(f.a,{variant:"outlined",placeholder:"Expected",value:this.state.expected,onChange:function(t){e.setState({expected:t.currentTarget.value})},style:{width:"100%"}})})]}),Object(v.jsx)(g.a,{onClick:function(){e.addTrigger()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})}),Object(v.jsx)(De.a,{open:this.state.modalEffect,onClose:function(){e.reset(),e.setState({modalEffect:!1})},children:Object(v.jsx)(Re.a,{in:this.state.modalEffect,children:Object(v.jsx)(p.a,{style:Ie,children:Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)(T.a,{variant:"h5",children:"New effect"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(v.jsx)($,{setState:e.setState.bind(e),action:t})}))})}):null,Object(v.jsx)(g.a,{onClick:function(){e.addEffect()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})})]}):Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),Pe={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,backgroundColor:le.palette.background.paper,padding:10,borderRadius:5},Ae=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={popup:!1,id:e.match.params.id,enabled:!1,message:"",routine:null,sources:[],modalTrigger:!1,modalEffect:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.getSource(["smartobject","process","module"]);case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/routines/"+this.state.id);case 5:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):t.error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({routine:n.data,sources:t.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.setState({action:null,source:null,result:null,statement:null,expected:null})}},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"updateIcon",value:function(e){var t=this.state.routine;t.icon=e,this.setState({routine:t})}},{key:"updateName",value:function(e){var t=this.state.routine;t.name=e,this.setState({routine:t})}},{key:"updateWatch",value:function(e){var t=this.state.routine;t.watch=e,this.setState({routine:t})}},{key:"addTrigger",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.triggers.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e,result:this.state.result,statement:this.state.statement,expected:this.state.expected}),this.setState({routine:s,modalTrigger:!1,action:null,source:null,result:null,statement:null,expected:null})}}},{key:"addEffect",value:function(){if(null==this.state.source)this.setState({enabled:!0,message:"Missing source"});else if(null==this.state.action)this.setState({enabled:!0,message:"Missing action"});else{for(var e=[],t=0;t<this.state.action.settings.length;t++){var n=this.state.action.settings[t],a=this.state["argument-"+n.id];void 0==a&&(a=n.default),e.push({reference:n.id,value:a})}var s=this.state.routine;s.effects.push({source:this.state.source.id,type:this.state.source.type,action:this.state.action.id,arguments:e}),this.setState({routine:s,modalEffect:!1,action:null,source:null})}}},{key:"removeTrigger",value:function(e){var t=this.state.routine,n=t.triggers.filter((function(t,n){return n!=e}));t.triggers=n,this.setState({routine:t})}},{key:"removeEffect",value:function(e){var t=this.state.routine,n=t.effects.filter((function(t,n){return n!=e}));t.effects=n,this.setState({routine:t})}},{key:"save",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.routine.name.length){e.next=4;break}this.setState({enabled:!0,message:"Missing name"}),e.next=16;break;case 4:if(0!=this.state.routine.icon.length){e.next=8;break}this.setState({enabled:!0,message:"Missing icon"}),e.next=16;break;case 8:if(0!=this.state.routine.effects.length){e.next=12;break}this.setState({enabled:!0,message:"Missing effect"}),e.next=16;break;case 12:return e.next=14,(new W).put({name:this.state.routine.name,watch:this.state.routine.watch,icon:this.state.routine.icon,triggers:this.state.routine.triggers,effects:this.state.routine.effects}).fetch("/api/routines/"+this.state.id);case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.props.history.push("/routine/");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.routine?Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(v.jsx)(f.a,{onChange:function(t){e.updateName(t.nativeEvent.target.value)},style:{width:"49%"},value:this.state.routine.name,label:"Name",variant:"outlined"}),Object(v.jsx)(f.a,{onChange:function(t){e.updateIcon(t.nativeEvent.target.value)},value:this.state.routine.icon,label:"Icon",variant:"outlined",style:{width:"49%"},InputProps:{endAdornment:Object(v.jsx)(he.a,{position:"end",children:Object(v.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(v.jsx)(fe.a,{})})})}}),Object(v.jsx)(je.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(v.jsx)(xe,{onSelect:function(t){e.setState({popup:!1}),e.updateIcon(t)}})})]}),Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,marginRight:10,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)("div",{style:{display:"flex",paddingTop:10,paddingBottom:10,paddingLeft:15,paddingRight:15},children:Object(v.jsx)("div",{style:{display:"flex",flex:6,justifyContent:"center"},children:Object(v.jsx)(Y.a,{defaultValue:0,valueLabelDisplay:"auto",orientation:"horizontal",min:0,max:1440,step:1,value:this.state.routine.watch,onChange:function(t,n){e.updateWatch(n)}})})})})]}),Object(v.jsxs)("div",{style:{flexDirection:"row",display:"flex",marginTop:20},children:[Object(v.jsxs)("div",{style:{flex:1,padding:5},children:[Object(v.jsx)(T.a,{variant:"subtitle1",children:"Trigger"}),Object(v.jsxs)(Te.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:["   ",this.state.routine.triggers.map((function(t,n){return Object(v.jsxs)("div",{onClick:function(){return e.removeTrigger(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)(T.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(v.jsx)(T.a,{variant:"body2",children:"Reference : "+t.source}),Object(v.jsx)(T.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(v.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(v.jsxs)(T.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]}),t.result&&t.statement&&t.expected?Object(v.jsxs)("div",{children:[Object(v.jsx)(T.a,{variant:"body2",children:"Pour condition"}),Object(v.jsxs)("div",{style:{marginLeft:20},children:[Object(v.jsx)(T.a,{variant:"body2",children:"Resultat : "+t.result}),Object(v.jsx)(T.a,{variant:"body2",children:"Condition : "+t.statement}),Object(v.jsx)(T.a,{variant:"body2",children:"Expected : "+t.expected})]})]}):null]})})),Object(v.jsx)(g.a,{onClick:function(){e.reset(),e.setState({modalTrigger:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)(k.a,{})})]})]}),Object(v.jsxs)("div",{style:{flex:1,padding:5},children:[Object(v.jsx)(T.a,{variant:"subtitle1",children:"Effect"}),Object(v.jsxs)(Te.a,{style:{textTransform:"none",padding:15,marginTop:5,marginRight:10,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content"},children:[this.state.routine.effects.map((function(t,n){return Object(v.jsxs)("div",{onClick:function(){return e.removeEffect(n)},style:{textTransform:"none",padding:15,marginTop:5,borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",height:"min-content",marginBottom:10},children:[Object(v.jsxs)(T.a,{variant:"body2",children:["Type : "+t.type," "]}),Object(v.jsx)(T.a,{variant:"body2",children:"Reference : "+t.source}),Object(v.jsx)(T.a,{variant:"body2",children:"Action : "+t.action}),t.arguments.length>0?Object(v.jsx)("div",{style:{marginLeft:20},children:t.arguments.map((function(e){return Object(v.jsxs)(T.a,{variant:"body2",children:[e.reference+" : "+e.value," "]})}))}):null]})})),Object(v.jsx)(g.a,{onClick:function(){e.reset(),e.setState({modalEffect:!0})},style:{width:"100%",borderStyle:"solid",borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)(k.a,{})})]})]})]})]}),Object(v.jsx)(p.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(v.jsx)(E.a,{onClick:function(){e.save()},style:{borderRadius:0},variant:"outlined",children:Object(v.jsx)(te.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message}),Object(v.jsx)(De.a,{open:this.state.modalTrigger,onClose:function(){e.reset(),e.setState({modalTrigger:!1})},children:Object(v.jsx)(Re.a,{in:this.state.modalTrigger,children:Object(v.jsx)(p.a,{style:Pe,children:Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)(T.a,{variant:"h5",children:"New Trigger"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(v.jsx)($,{setState:e.setState.bind(e),action:t})}))})}):null,Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(v.jsx)(f.a,{variant:"outlined",placeholder:"Result",value:this.state.result,onChange:function(t){e.setState({result:t.currentTarget.value})},style:{width:"100%"}})}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginBottom:5,marginTop:5,flex:1},children:[Object(v.jsx)(q.a,{children:"Condition"}),Object(v.jsxs)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.statement,onChange:function(t){e.setState({statement:t.target.value})},label:"Source",children:[Object(v.jsx)(X.a,{value:"equal",children:"="}),Object(v.jsx)(X.a,{value:"smaller",children:"<"}),Object(v.jsx)(X.a,{value:"bigger",children:">"}),Object(v.jsx)(X.a,{value:"different",children:"<>"})]})]}),Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,flex:1},children:Object(v.jsx)(f.a,{variant:"outlined",placeholder:"Expected",value:this.state.expected,onChange:function(t){e.setState({expected:t.currentTarget.value})},style:{width:"100%"}})})]}),Object(v.jsx)(g.a,{onClick:function(){e.addTrigger()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})}),Object(v.jsx)(De.a,{open:this.state.modalEffect,onClose:function(){e.reset(),e.setState({modalEffect:!1})},children:Object(v.jsx)(Re.a,{in:this.state.modalEffect,children:Object(v.jsx)(p.a,{style:Pe,children:Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(v.jsx)(T.a,{variant:"h5",children:"New effect"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{placeholder:"Source",style:{width:"100%"},value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5},children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null,this.state.action&&this.state.action.settings.length>0?Object(v.jsx)("div",{style:{marginBottom:10,marginTop:10,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)"},children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:10,paddingBottom:10},children:this.state.action.settings.map((function(t){return Object(v.jsx)($,{setState:e.setState.bind(e),action:t})}))})}):null,Object(v.jsx)(g.a,{onClick:function(){e.addEffect()},variant:"outlined",style:{width:"minContent",marginTop:5},children:"Save"})]})})})})]}):Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),Ee=n(73),Be=n.n(Ee),We=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",modules:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/configurations/module");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({enabled:!1,message:"",modules:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Identifiant"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Name"})})]})}),Object(v.jsx)(A.a,{children:this.state.modules.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(v.jsx)(w.b,{to:"/module/"+Be()(e.id),style:{textDecoration:"none",color:"white",display:"contents"},children:Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.id})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.name})})]},e.reference)})}))})]})}),Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignContent:"center",alignItems:"center"},children:Object(v.jsx)(B.a,{component:"div",count:this.state.modules.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Le=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={hashId:e.match.params.id,module:null,loading:!0,enabled:!1,message:"",executeInformation:""},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/configurations/module");case 2:(t=e.sent).error?(this.setState({enabled:!0,message:t.code+" : "+t.message}),this.props.history.push("/module")):(n=!1,t.data.forEach((function(e){Be()(e.id)==a.state.hashId&&(n=e)})),n?this.setState({module:n}):this.props.history.push("/module"));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeAction",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,s,i,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a={},s=0;s<n.length;s++)i=n[s],void 0==(r=this.state["argument-"+i.id])&&(r=i.default),a[i.id]=r;return e.next=4,(new W).post({settings:a,reference:this.state.module.reference}).fetch("/api/modules/"+Be()(this.state.module.id)+"/actions/"+t);case 4:(c=e.sent).error?this.setState({enabled:!0,message:c.code+" : "+c.message}):(c.data&&this.setState({executeInformation:JSON.stringify(c.data)}),this.componentDidMount());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.module?Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,marginBottom:10,justifyContent:"left"},children:[Object(v.jsxs)("div",{style:{padding:10},children:[Object(v.jsx)(T.a,{variant:"h4",children:this.state.module.id}),Object(v.jsx)(T.a,{variant:"subtitle1",children:this.state.module.module})]}),Object(v.jsx)(J.a,{}),Object(v.jsx)("div",{style:{padding:10,paddingBottom:0},children:this.state.module.actions.map((function(t){return Object(v.jsxs)(p.a,{style:{marginTop:10,marginBottom:10,display:"flex",flexDirection:"column",padding:10},children:[Object(v.jsx)(g.a,{onClick:function(){e.executeAction(t.id,t.settings)},variant:"outlined",style:{width:"250px",height:"100%"},children:t.name}),t.settings.length>0?Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",marginTop:10,marginBottom:10},children:t.settings.map((function(t){return Object(v.jsx)($,{orientation:"vertical",setState:e.setState.bind(e),action:t})}))}):null]})}))}),this.state.executeInformation.length>0?Object(v.jsx)("div",{style:{padding:10},children:Object(v.jsx)(m.a,{severity:"success",action:Object(v.jsx)(E.a,{onClick:function(){e.setState({executeInformation:""})},style:{alignSelf:"start"},color:"inherit",size:"small",children:Object(v.jsx)(V.a,{})}),children:Object(v.jsx)(N.a,{id:"json-pretty",data:JSON.parse(this.state.executeInformation)})})}):null]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),ze=n(153),Ne=n(138),Je=n(133),_e=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={pageSmartobject:0,pageModule:0,enabled:!1,message:"",modules:[],smartobjects:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/configurations/module");case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/configurations/smartobject");case 5:n=e.sent,t.error?this.setState({enabled:!0,message:t.code+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.setState({enabled:!1,message:"",modules:t.data,smartobjects:n.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Identifiant"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Name"})})]})}),Object(v.jsx)(A.a,{children:this.state.smartobjects.slice(10*this.state.pageSmartobject,10*(this.state.pageSmartobject+1)).map((function(e){return Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.id})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.name})})]},e.reference)}))})]})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"/market/module",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:Object(v.jsx)(ze.a,{})})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.smartobjects.length,rowsPerPage:10,page:this.state.pageSmartobject,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({pageSmartobject:n})}})]}),Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Identifiant"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Name"})})]})}),Object(v.jsx)(A.a,{children:this.state.modules.slice(10*this.state.pageSmartobject,10*(this.state.pageSmartobject+1)).map((function(e){return Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.id})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.name})})]},e.reference)}))})]})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"/market/smartobject",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:"smartobject"!=this.state.id?Object(v.jsx)(Ne.a,{}):Object(v.jsx)(Je.a,{})})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.modules.length,rowsPerPage:10,page:this.state.pageModule,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({pageModule:n})}})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Ue=n(144),Fe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={id:e.match.params.id,enabled:!1,message:"",markets:[],pageMarket:0,severity:"error"},a}return Object(h.a)(n,[{key:"install",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).post({package:t}).fetch("/api/markets/install");case 2:(n=e.sent).error?this.setState({severity:"error",enabled:!0,message:n.code+" : "+n.message}):(this.setState({severity:"info",enabled:!0,message:t+" was installed"}),this.componentDidMount());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uninstall",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).post({package:t}).fetch("/api/markets/uninstall");case 2:(n=e.sent).error?this.setState({severity:"error",enabled:!0,message:n.code+" : "+n.message}):(this.setState({severity:"info",enabled:!0,message:t+" was removed"}),this.componentDidMount());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=this;this.props.match.params.id!=this.state.id&&this.setState({id:this.props.match.params.id},(function(){e.componentDidMount()}))}},{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/configurations/module");case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/configurations/smartobject");case 5:return n=e.sent,e.next=8,fetch("https://market.intendant.io");case 8:return a=e.sent,e.next=11,a.json();case 11:s=(s=e.sent).map((function(e){return e.alreadyInstall=!1,e})),t.data.forEach((function(e){s=s.map((function(t){return t.package==e.id&&(t.alreadyInstall=!0),t}))})),n.data.forEach((function(e){s=s.map((function(t){return t.package==e.id&&(t.alreadyInstall=!0),t}))})),this.setState({markets:s.filter((function(e){return e.type==i.state.id}))}),t.error?this.setState({severity:"error",enabled:!0,message:t.code+" : "+t.message}):n.error?this.setState({severity:"error",enabled:!0,message:n.code+" : "+n.message}):this.setState({modules:t.data,smartobjects:n.data});case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Name"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"Dependencies"})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:"Action"})})]})}),Object(v.jsx)(A.a,{children:this.state.markets.slice(10*this.state.pageMarket,10*(this.state.pageMarket+1)).map((function(t){return Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.name})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:"None"})}),Object(v.jsx)(P.a,{align:"center",children:Object(v.jsx)(T.a,{variant:"body1",children:t.alreadyInstall?Object(v.jsx)(g.a,{size:"small",startIcon:Object(v.jsx)(V.a,{}),onClick:function(){e.uninstall(t.package)},variant:"outlined",children:"Remove"}):Object(v.jsx)(g.a,{size:"small",startIcon:Object(v.jsx)(Ue.a,{}),onClick:function(){e.install(t.package)},variant:"outlined",disableElevation:!0,children:"Install"})})})]},t.reference)}))})]})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"smartobject"==this.state.id?"/market/module":"/market/smartobject",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:"smartobject"!=this.state.id?Object(v.jsx)(Ne.a,{}):Object(v.jsx)(Je.a,{})})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.markets.length,rowsPerPage:10,page:this.state.pageMarket,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({pageMarket:n})}})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:this.state.severity,children:this.state.message})]})}}]),n}(s.a.Component),He=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",widgets:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/widgets");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({enabled:!1,message:"",widgets:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsx)(A.a,{children:this.state.widgets.slice(10*this.state.page,10*(this.state.page+1)).map((function(e){return Object(v.jsx)(w.b,{to:"/widget/"+e.id,style:{textDecoration:"none",color:"white",display:"contents"},children:Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)("img",{style:{width:30,height:30,filter:"invert(100%)"},src:"/admin/ressource/icon/"+e.icon+".svg"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.reference})}),Object(v.jsx)(P.a,{align:"left",children:e.contents.sort((function(e,t){return e.type.rank>t.type.rank})).map((function(e){return e.content.split("\n").map((function(t){return Object(v.jsx)(T.a,{variant:"body1",style:{fontWeight:"title"==e.type.reference?"bold":"normal"},children:t})}))}))}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:e.icon})})]},e.reference)})}))})})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex"},children:Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"/widget/new",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:Object(v.jsx)(k.a,{})})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.widgets.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Qe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,message:"",popup:!1,content:null,description:"",image:"",sources:[],contentSources:[],source:null,action:null,widgetReference:"",reference:"",icon:"",type:"title",types:[],contents:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/smartobjects");case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/configurations/widget");case 5:return n=e.sent,e.next=8,ge.getSource(["smartobject","module"]);case 8:a=e.sent,t.error?this.setState({enabled:!0,message:t.code+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.code+" : "+n.message}):a.error?this.setState({enabled:!0,message:a.code+" : "+a.message}):this.setState({enabled:!1,message:"",loading:!1,sources:a.data,type:!1,types:n.data.contents.types});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"setType",value:function(e){var t=this;this.state.types.map((function(n){n.id==e&&t.setState({type:n})}))}},{key:"save",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.widgetReference.length&&0!=this.state.contentSources.length&&0!=this.state.icon.length){e.next=3;break}return this.setState({enabled:!0,message:"Missing parameters"}),e.abrupt("return");case 3:return t=localStorage.getItem("authorization"),n=localStorage.getItem("server"),e.next=7,fetch(n+"/api/widgets",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({reference:this.state.widgetReference,sources:this.state.contentSources,contents:this.state.contents,icon:this.state.icon})});case 7:return a=e.sent,e.next=10,a.json();case 10:(s=e.sent).error?this.setState({enabled:!0,message:s.code+" : "+s.message}):this.props.history.push("/widget");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"insertContent",value:function(){var e=this.state.contents;e.push({type:this.state.type,content:this.state.content}),this.setState({contents:e,content:""})}},{key:"insertSource",value:function(){var e=this;if(null!=this.state.action&&null!=this.state.source&&0!=this.state.reference.length){var t=!1,n=this.state.contentSources;if(n.forEach((function(n){n.reference==e.state.reference&&(t=!0,e.setState({enabled:!0,message:"Duplicate reference"}))})),!t){for(var a=[],s=this.state.action,i=0;i<s.settings.length;i++){var r=s.settings[i],c=this.state["argument-"+r.id];void 0==c&&(c=r.default),a.push({reference:r.id,value:c})}n.push({source:this.state.source,action:this.state.action,arguments:a,reference:this.state.reference}),this.setState({contentSources:n,action:null,source:null,reference:""})}}else this.setState({enabled:!0,message:"Missing parameters"})}},{key:"delete",value:function(e){var t=[];this.state.contents.forEach((function(n,a){a!=e&&t.push(n)})),this.setState({contents:t})}},{key:"deleteContent",value:function(e){var t=[];this.state.contentSources.forEach((function(n,a){a!=e&&t.push(n)})),this.setState({contentSources:t})}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,marginBottom:10,justifyContent:"left"},children:[Object(v.jsx)("div",{style:{padding:10},children:Object(v.jsx)(T.a,{variant:"h4",children:" Widget "})}),Object(v.jsx)(J.a,{}),Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(f.a,{onChange:function(t){e.setState({widgetReference:t.target.value})},multiline:!0,value:this.state.widgetReference,label:"Reference",variant:"outlined"}),Object(v.jsx)(f.a,{style:{marginLeft:10},onChange:function(t){e.setState({icon:t.target.value})},multiline:!0,value:this.state.icon,label:"Icon",variant:"outlined",InputProps:{endAdornment:Object(v.jsx)(he.a,{position:"end",children:Object(v.jsx)(E.a,{onClick:function(){e.setState({popup:!0})},style:{margin:0,padding:0},children:Object(v.jsx)(fe.a,{})})})}}),Object(v.jsx)(je.a,{open:this.state.popup,onClose:function(){e.setState({popup:!1})},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(v.jsx)(xe,{onSelect:function(t){e.setState({popup:!1,icon:t})}})})]}),Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:" Source "}),Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:" Source "})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:" Argument "})}),Object(v.jsx)(P.a,{align:"left"})]})}),Object(v.jsxs)(A.a,{children:[this.state.contentSources.map((function(t,n){return Object(v.jsxs)(M.a,{children:[Object(v.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.reference," "]}),Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.source.name," "]}),Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.action.name," "]})]}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:JSON.stringify(t.arguments)})}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.deleteContent(n)},style:{borderRadius:2},children:Object(v.jsx)(V.a,{})})})]})})),Object(v.jsxs)(M.a,{children:[Object(v.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(v.jsx)(f.a,{onChange:function(t){e.setState({reference:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.reference,label:"Reference",variant:"outlined"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{placeholder:"Source",value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null]}),Object(v.jsx)(P.a,{align:"right",style:{width:"40%"},children:this.state.action&&this.state.action.settings.length>0?Object(v.jsx)("div",{style:{marginLeft:5,marginBottom:5,marginTop:5,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",width:"100%"},children:Object(v.jsx)("div",{style:{display:"flex",paddingTop:10,paddingBottom:10,flexDirection:"column"},children:this.state.action.settings.map((function(t){return Object(v.jsx)($,{orientation:"horizontal",setState:e.setState.bind(e),action:t})}))})}):null}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.insertSource()},style:{borderRadius:2},children:Object(v.jsx)(k.a,{})})})]})]})]})})})]}),Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:" Content "}),Object(v.jsx)("div",{style:{marginTop:10,marginBottom:10},children:Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:" Type "})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:" Affichage "})}),Object(v.jsx)(P.a,{align:"left"})]})}),Object(v.jsxs)(A.a,{children:[this.state.contents.sort((function(e,t){return e.type.rank>t.type.rank})).map((function(t,n){return Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.type.name," "]})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.content," "]})}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.delete(n)},style:{borderRadius:2},children:Object(v.jsx)(V.a,{})})})]})})),Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsxs)(G.a,{variant:"outlined",style:{marginRight:10,width:"100%"},children:[Object(v.jsx)(q.a,{children:"Type"}),Object(v.jsx)(K.a,{value:this.state.type.id,onChange:function(t){e.setType(t.target.value)},label:"Type",children:this.state.types.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(f.a,{onChange:function(t){e.setState({content:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.content,label:"Name",variant:"outlined"})}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.insertContent()},style:{borderRadius:2},children:Object(v.jsx)(k.a,{})})})]})]})]})})})]}),Object(v.jsx)(g.a,{style:{marginTop:5,marginBottom:5},onClick:function(){e.save()},variant:"outlined",children:"Save"})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Ve=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,message:"",id:e.match.params.id,contentSources:[],reference:"",source:null,action:null,type:"title",content:"",sources:[],types:[],widget:null},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/widgets/"+this.state.id);case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/configurations/widget");case 5:return n=e.sent,e.next=8,ge.getSource(["smartobject","module"]);case 8:a=e.sent,t.error?this.setState({enabled:!0,message:t.code+" : "+t.message}):a.error?this.setState({enabled:!0,message:a.code+" : "+a.message}):n.error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.setState({enabled:!1,message:"",loading:!1,widget:t.data,sources:a.data,types:n.data.contents.types});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete({}).fetch("/api/widgets/"+this.state.widget.id);case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.props.history.push("/widget");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteSource",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/widgets/"+this.state.widget.id+"/sources/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertSource",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s,i,r,c,o=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.state.action&&null!=this.state.source&&0!=this.state.reference.length){e.next=3;break}return this.setState({enabled:!0,message:"Missing parameters"}),e.abrupt("return");case 3:if(t=!1,this.state.widget.sources.forEach((function(e){e.reference==o.state.reference&&(t=!0,o.setState({enabled:!0,message:"Duplicate reference"}))})),!t){e.next=7;break}return e.abrupt("return");case 7:for(n=[],a=this.state.action,s=0;s<a.settings.length;s++)i=a.settings[s],void 0==(r=this.state["argument-"+i.id])&&(r=i.default),n.push({reference:i.id,value:r});return e.next=12,(new W).post({source:this.state.source,action:this.state.action,arguments:n,reference:this.state.reference}).fetch("/api/widgets/"+this.state.id+"/sources");case 12:(c=e.sent).error?this.setState({enabled:!0,message:c.code+" : "+c.message}):(this.setState({action:null,source:null,reference:""}),this.componentDidMount());case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSource",value:function(e){var t=this;this.state.sources.map((function(n){n.id==e&&t.setState({source:n,action:null})}))}},{key:"setAction",value:function(e){var t=this;this.state.source.actions.map((function(n){n.id==e&&t.setState({action:n})}))}},{key:"setContent",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).post({type:this.state.type,content:this.state.content}).fetch("/api/widgets/"+this.state.id+"/contents");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):(this.setState({content:""}),this.componentDidMount());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteContent",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/widgets/"+this.state.id+"/contents/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.widget,a=n.contents.map((function(e){return e.id==t.id&&(e.native=t.native),e})),n.contents=a,this.setState({widget:n}),e.next=6,(new W).put({content:t}).fetch("/api/widgets/"+this.state.widget.id);case 6:(s=e.sent).error?this.setState({enabled:!0,message:s.code+" : "+s.message}):this.componentDidMount();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.widget?Object(v.jsxs)("div",{children:[Object(v.jsxs)(p.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:[Object(v.jsxs)("div",{style:{padding:10},children:[Object(v.jsx)(T.a,{variant:"h4",style:{fontSize:25},children:this.state.widget.reference}),Object(v.jsx)(T.a,{variant:"subtitle1",children:this.state.widget.icon})]}),Object(v.jsx)(J.a,{}),Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Source"}),Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:"Reference"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:"Source"})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:"Argument"})}),Object(v.jsx)(P.a,{align:"left"})]})}),Object(v.jsx)(A.a,{children:this.state.widget.sources.map((function(t,n){return Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:t.reference})}),Object(v.jsxs)(P.a,{align:"left",children:[Object(v.jsx)(T.a,{variant:"subtitle1",children:t.object}),Object(v.jsx)(T.a,{variant:"subtitle1",children:t.action})]}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:t.arguments.map((function(e){return Object(v.jsx)(T.a,{variant:"body1",children:e.reference+" : "+e.value})}))})}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.deleteSource(t.id)},style:{borderRadius:3},children:Object(v.jsx)(Q.a,{})})})]})}))})]})})})]}),Object(v.jsx)("div",{style:{padding:10,paddingBottom:0},children:Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsxs)(A.a,{children:[this.state.contentSources.map((function(t,n){return Object(v.jsxs)(M.a,{children:[Object(v.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.reference," "]}),Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.source.name," "]}),Object(v.jsxs)(T.a,{variant:"subtitle1",children:[" ",t.action.name," "]})]}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:JSON.stringify(t.arguments)})}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.deleteContent(n)},style:{borderRadius:2},children:Object(v.jsx)(V.a,{})})})]})})),Object(v.jsxs)(M.a,{children:[Object(v.jsxs)(P.a,{align:"left",style:{width:"30%"},children:[Object(v.jsx)(f.a,{onChange:function(t){e.setState({reference:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.reference,label:"Reference",variant:"outlined"}),Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(v.jsx)(q.a,{children:"Source"}),Object(v.jsx)(K.a,{placeholder:"Source",value:this.state.source?this.state.source.id:null,onChange:function(t){e.setSource(t.target.value)},label:"Source",children:this.state.sources.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}),this.state.source?Object(v.jsxs)(G.a,{variant:"outlined",style:{marginTop:5,marginBottom:5,width:"100%"},children:[Object(v.jsx)(q.a,{children:"Action"}),Object(v.jsx)(K.a,{placeholder:"Action",style:{width:"100%"},value:this.state.action?this.state.action.id:null,onChange:function(t){e.setAction(t.target.value)},label:"Source",children:this.state.source.actions.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]}):null]}),Object(v.jsx)(P.a,{align:"right",style:{width:"40%"},children:this.state.action&&this.state.action.settings.length>0?Object(v.jsx)("div",{style:{marginLeft:5,marginBottom:5,marginTop:5,borderStyle:"solid",paddingLeft:10,paddingRight:10,borderRadius:3,borderWidth:.25,borderColor:"rgba(255, 255, 255, 0.23)",width:"100%"},children:Object(v.jsx)("div",{style:{display:"flex",paddingTop:10,paddingBottom:10,flexDirection:"column"},children:this.state.action.settings.map((function(t){return Object(v.jsx)($,{orientation:"horizontal",setState:e.setState.bind(e),action:t})}))})}):null}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.insertSource()},style:{borderRadius:2},children:Object(v.jsx)(k.a,{})})})]})]})})})})}),Object(v.jsxs)("div",{style:{padding:10,paddingBottom:0},children:[Object(v.jsx)(T.a,{variant:"h5",children:"Content"}),Object(v.jsx)("div",{style:{display:"flex",flexDirection:"row",paddingTop:10},children:Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsxs)(R.a,{children:[Object(v.jsx)(I.a,{children:Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",style:{width:"15%"},children:Object(v.jsx)(T.a,{variant:"subtitle1",children:"Type"})}),Object(v.jsx)(P.a,{align:"left",style:{width:"80%"},children:Object(v.jsx)(T.a,{variant:"subtitle1",children:"content"})}),Object(v.jsx)(P.a,{align:"left",style:{width:"20%"}})]})}),Object(v.jsxs)(A.a,{children:[this.state.widget.contents.sort((function(e,t){return e.type.rank>t.type.rank})).map((function(t,n){return Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"subtitle1",children:t.type.name})}),Object(v.jsxs)(P.a,{align:"left",children:[Object(v.jsx)(f.a,{style:{width:"100%",marginBottom:5},onChange:function(n){t.native=n.target.value,e.update(t)},multiline:!0,value:t.native,variant:"outlined"}),t.content.split("\n").map((function(e){return Object(v.jsx)(T.a,{variant:"body1",style:{fontWeight:"title"==e.type?"bold":"normal"},children:e})}))]}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.deleteContent(t.id)},style:{borderRadius:3},children:Object(v.jsx)(Q.a,{})})})]})})),Object(v.jsxs)(M.a,{children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsxs)(G.a,{variant:"outlined",style:{marginRight:10,width:"100%"},children:[Object(v.jsx)(q.a,{children:"Type"}),Object(v.jsx)(K.a,{value:this.state.type,onChange:function(t){e.setState({type:t.target.value})},label:"Type",children:this.state.types.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})]})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(f.a,{onChange:function(t){e.setState({content:t.target.value})},style:{width:"100%"},multiline:!0,value:this.state.content,label:"Name",variant:"outlined"})}),Object(v.jsx)(P.a,{align:"right",children:Object(v.jsx)(E.a,{onClick:function(){e.setContent()},style:{borderRadius:2},children:Object(v.jsx)(k.a,{})})})]})]})]})})})]})]}),Object(v.jsx)(p.a,{style:{width:"min-content",marginTop:10,alignContent:"center",justifyContent:"center",alignSelf:"center"},children:Object(v.jsx)(E.a,{onClick:function(){e.delete()},style:{borderRadius:5},children:Object(v.jsx)(Q.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})}}]),n}(s.a.Component),Ge=n(151),qe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={page:0,enabled:!1,message:"",users:[],profiles:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/users");case 2:return t=e.sent,e.next=5,(new W).get().fetch("/api/profiles");case 5:n=e.sent,t.error?this.setState({enabled:!0,message:t.code+" : "+t.message}):n.error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.setState({enabled:!1,message:"",users:t.data,profiles:n.data});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).delete().fetch("/api/users/"+t);case 2:(n=e.sent).error?this.setState({enabled:!0,message:n.code+" : "+n.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateProfile",value:function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).put({login:t.login,profile:n}).fetch("/api/users/"+t.id);case 2:(a=e.sent).error?this.setState({enabled:!0,message:a.code+" : "+a.message}):this.componentDidMount();case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)(v.Fragment,{children:[this.state.loading?Object(v.jsx)(p.a,{style:{display:"flex",padding:10,alignContent:"center",justifyContent:"center",alignItems:"center",alignSelf:"center"},children:Object(v.jsx)(T.a,{variant:"subtitle1",style:{fontSize:18},children:"Chargement des smartobject"})}):Object(v.jsxs)("div",{children:[Object(v.jsx)(D.a,{component:p.a,children:Object(v.jsx)(R.a,{children:Object(v.jsx)(A.a,{children:this.state.users.sort((function(e,t){return e.profile>t.profile})).slice(10*this.state.page,10*(this.state.page+1)).map((function(t){return Object(v.jsxs)(M.a,{hover:!0,style:{cursor:"pointer"},children:[Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(T.a,{variant:"body1",children:t.login})}),Object(v.jsx)(P.a,{align:"left",children:Object(v.jsx)(G.a,{variant:"outlined",children:Object(v.jsx)(K.a,{disabled:"admin"==t.login,value:t.profile,onChange:function(n){e.updateProfile(t,n.target.value)},children:e.state.profiles.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})})}),Object(v.jsxs)(P.a,{align:"right",children:[Object(v.jsx)(E.a,{onClick:function(){e.props.history.push("/user/"+t.id+"/password")},style:{borderRadius:3},children:Object(v.jsx)(Ge.a,{})}),Object(v.jsx)(E.a,{onClick:function(){e.delete(t.id)},style:{borderRadius:3},children:Object(v.jsx)(Q.a,{})})]})]},t.id)}))})})}),Object(v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",alignItems:"center"},children:[Object(v.jsx)(p.a,{style:{width:50,height:50,marginTop:10,padding:5,marginBottom:10,textAlign:"center",justifyContent:"space-around",alignContent:"center",alignItems:"center",display:"flex",flexDirection:"row"},children:Object(v.jsx)(w.b,{to:"/user/new",style:{textDecoration:"none",color:"white"},children:Object(v.jsx)(E.a,{style:{borderRadius:0},children:Object(v.jsx)(k.a,{})})})}),Object(v.jsx)(B.a,{component:"div",count:this.state.users.length,rowsPerPage:10,page:this.state.page,rowsPerPageOptions:[],onChangePage:function(t,n){e.setState({page:n})}})]})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Ke=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,message:"",profiles:[],profile:1,login:"",password:"",confirmationPassword:""},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new W).get().fetch("/api/profiles");case 2:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.setState({enabled:!1,message:"",profiles:t.data});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.login.length){e.next=4;break}this.setState({enabled:!0,message:"Missing login"}),e.next=16;break;case 4:if(0!=this.state.password.length){e.next=8;break}this.setState({enabled:!0,message:"Missing password"}),e.next=16;break;case 8:if(this.state.password==this.state.confirmationPassword){e.next=12;break}this.setState({enabled:!0,message:"Passwords are not the same"}),e.next=16;break;case 12:return e.next=14,(new W).post({login:this.state.login,password:this.state.password,profile:this.state.profile}).fetch("/api/users");case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.props.history.push("/user");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(p.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between"},children:Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"start",flexDirection:"column",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(v.jsx)(f.a,{placeholder:"login",variant:"outlined",value:this.state.login,onChange:function(t){e.setState({login:t.currentTarget.value})}}),Object(v.jsx)(f.a,{type:"password",placeholder:"password",variant:"outlined",value:this.state.password,style:{marginTop:10},onChange:function(t){e.setState({password:t.currentTarget.value})}}),Object(v.jsx)(f.a,{placeholder:"password confirmation",type:"password",variant:"outlined",value:this.state.confirmationPassword,style:{marginTop:10},onChange:function(t){e.setState({confirmationPassword:t.currentTarget.value})}}),Object(v.jsx)(G.a,{variant:"outlined",style:{width:"100%",marginTop:10},children:Object(v.jsx)(K.a,{value:this.state.profile,onChange:function(t){e.setState({profile:t.target.value})},children:this.state.profiles.map((function(e){return Object(v.jsx)(X.a,{value:e.id,children:e.name})}))})})]})})}),Object(v.jsx)(p.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(v.jsx)(E.a,{onClick:function(){e.add()},style:{borderRadius:0},variant:"outlined",children:Object(v.jsx)(te.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Xe=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={enabled:!1,id:e.match.params.id,message:"",confirmationPassword:"",password:""},a}return Object(h.a)(n,[{key:"changePassword",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.password.length){e.next=4;break}this.setState({enabled:!0,message:"Missing password"}),e.next=16;break;case 4:if(0!=this.state.confirmationPassword.length){e.next=8;break}this.setState({enabled:!0,message:"Missing confirmation password"}),e.next=16;break;case 8:if(this.state.password==this.state.confirmationPassword){e.next=12;break}this.setState({enabled:!0,message:"Passwords are not the same"}),e.next=16;break;case 12:return e.next=14,(new W).post({password:this.state.password}).fetch("/api/users/"+this.state.id+"/password");case 14:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.props.history.push("/user");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{children:[Object(v.jsx)(p.a,{elevation:2,style:{padding:10,justifyContent:"left"},children:Object(v.jsx)("div",{style:{flexDirection:"row",display:"flex",justifyContent:"space-between"},children:Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"start",flexDirection:"column",alignSelf:"start",alignContent:"start",alignItems:"start",padding:10},children:[Object(v.jsx)(f.a,{placeholder:"password",type:"password",variant:"outlined",value:this.state.password,onChange:function(t){e.setState({password:t.currentTarget.value})}}),Object(v.jsx)(f.a,{placeholder:"password confirmation",type:"password",variant:"outlined",value:this.state.confirmationPassword,style:{marginTop:10},onChange:function(t){e.setState({confirmationPassword:t.currentTarget.value})}})]})})}),Object(v.jsx)(p.a,{style:{width:"min-content",height:"min-content",padding:2,alignContent:"center",alignItems:"center",justifyContent:"center",alignSelf:"center",marginTop:5},children:Object(v.jsx)(E.a,{onClick:function(){e.changePassword()},style:{borderRadius:0},variant:"outlined",children:Object(v.jsx)(te.a,{})})}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),Ye=n(400),Ze=n(390),$e=n(142),et=n(137),tt=n(130),nt=n(145),at=n(148),st=n(152),it=n(141),rt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return this.props.isMobile?null:Object(v.jsx)(Ye.a,{variant:"persistent",anchor:"left",open:!0,style:{width:240},children:Object(v.jsx)("div",{style:{width:240},children:Object(v.jsxs)(ae.a,{children:[Object(v.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",padding:5,alignContent:"center",alignSelf:"center",alignItems:"center"},children:[Object(v.jsx)("img",{src:"/admin/logo.svg",style:{height:"7vh",width:"7vh",borderRadius:7,marginLeft:15}}),Object(v.jsxs)("div",{children:[Object(v.jsx)(T.a,{variant:"h5",style:{textAlign:"start",fontWeight:"bold",paddingTop:15,paddingLeft:10},children:"Intendant"}),Object(v.jsx)(T.a,{variant:"subtitle1",style:{textAlign:"start",fontWeight:"bold",paddingTop:0,paddingBottom:15,paddingLeft:10},children:"Administration"})]})]}),Object(v.jsx)(J.a,{}),Object(v.jsx)(w.b,{to:"/smartobject",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(Ne.a,{})}),Object(v.jsx)(se.a,{primary:"Smartobject"})]},"smartobject")}),Object(v.jsx)(w.b,{to:"/module",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(Je.a,{})}),Object(v.jsx)(se.a,{primary:"Module"})]},"module")}),Object(v.jsx)(w.b,{to:"/widget",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)($e.a,{})}),Object(v.jsx)(se.a,{primary:"Widget"})]},"widget")}),Object(v.jsx)(w.b,{to:"/process",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(et.a,{})}),Object(v.jsx)(se.a,{primary:"Process"})]},"process")}),Object(v.jsx)(w.b,{to:"/routine",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(tt.a,{})}),Object(v.jsx)(se.a,{primary:"Routine"})]},"configuration")}),Object(v.jsx)(w.b,{to:"/authorization",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(nt.a,{})}),Object(v.jsx)(se.a,{primary:"Authorization"})]},"authorization")}),Object(v.jsx)(w.b,{to:"/user",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(at.a,{})}),Object(v.jsx)(se.a,{primary:"User"})]},"user")}),Object(v.jsx)(w.b,{to:"/market/smartobject",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(st.a,{})}),Object(v.jsx)(se.a,{primary:"Market"})]},"market")}),Object(v.jsx)(w.b,{to:"/configuration",style:{textDecoration:"none",color:"white"},children:Object(v.jsxs)(_.a,{button:!0,children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(Ge.a,{})}),Object(v.jsx)(se.a,{primary:"Configuration"})]},"configuration")}),Object(v.jsx)(J.a,{}),Object(v.jsxs)(_.a,{button:!0,onClick:function(){e.props.onDisconnect()},children:[Object(v.jsx)(Ze.a,{children:Object(v.jsx)(it.a,{})}),Object(v.jsx)(se.a,{primary:"Disconnect"})]},"disconnect")]})})})}}]),n}(s.a.Component),ct=n(28),ot=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={isMobile:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.mediaQueries("(max-width: 900px)")}},{key:"mediaQueries",value:function(e){var t=this,n=window.matchMedia(e);this.setState({isMobile:n.matches});n.addListener((function(e){return t.setState({isMobile:e.matches})}))}},{key:"render",value:function(){var e=this;return Object(v.jsxs)(w.a,{basename:"/admin",children:[Object(v.jsx)(rt,{isMobile:this.state.isMobile,onDisconnect:function(){e.props.onDisconnect()}}),Object(v.jsx)("main",{style:{padding:20,width:this.state.isMobile?"95vw":"80vw",height:"100vh"},children:Object(v.jsx)("div",{style:{marginLeft:this.state.isMobile?0:240,marginTop:this.state.isMobile?0:32},children:Object(v.jsxs)(ct.c,{children:[Object(v.jsx)(ct.a,{exact:!0,path:"/smartobject",component:L}),Object(v.jsx)(ct.a,{exact:!0,path:"/smartobject/new",component:ne}),Object(v.jsx)(ct.a,{exact:!0,path:"/smartobject/:id",component:ee}),Object(v.jsx)(ct.a,{exact:!0,path:"/module",component:We}),Object(v.jsx)(ct.a,{exact:!0,path:"/module/:id",component:Le}),Object(v.jsx)(ct.a,{exact:!0,path:"/routine",component:ke}),Object(v.jsx)(ct.a,{exact:!0,path:"/routine/new",component:Me}),Object(v.jsx)(ct.a,{exact:!0,path:"/routine/:id",component:Ae}),Object(v.jsx)(ct.a,{exact:!0,path:"/widget",component:He}),Object(v.jsx)(ct.a,{exact:!0,path:"/widget/new",component:Qe}),Object(v.jsx)(ct.a,{exact:!0,path:"/widget/authorization",component:He}),Object(v.jsx)(ct.a,{exact:!0,path:"/widget/:id",component:Ve}),Object(v.jsx)(ct.a,{exact:!0,path:"/process",component:ue}),Object(v.jsx)(ct.a,{exact:!0,path:"/process/new",component:me}),Object(v.jsx)(ct.a,{exact:!0,path:"/process/:id",component:ye}),Object(v.jsx)(ct.a,{exact:!0,path:"/user",component:qe}),Object(v.jsx)(ct.a,{exact:!0,path:"/user/new",component:Ke}),Object(v.jsx)(ct.a,{exact:!0,path:"/user/:id/password",component:Xe}),Object(v.jsx)(ct.a,{exact:!0,path:"/configuration",component:_e}),Object(v.jsx)(ct.a,{exact:!0,path:"/market/:id",component:Fe}),Object(v.jsx)(ct.a,{exact:!0,path:"/authorization",component:de})]})})})]})}}]),n}(s.a.Component),lt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={authentification:!0,enabled:!1,message:"",password:"",confirmePassword:"",login:"admin",isMobile:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.mediaQueries("(max-width: 900px)")}},{key:"mediaQueries",value:function(e){var t=this,n=window.matchMedia(e);this.setState({isMobile:n.matches});n.addListener((function(e){return t.setState({isMobile:e.matches})}))}},{key:"register",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.password!=this.state.confirmePassword){e.next=7;break}return e.next=3,(new W).put({password:this.state.password}).fetch("/api/getstarted");case 3:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):this.props.onFinish(),e.next=8;break;case 7:this.setState({enabled:!0,message:"Password and password confirmation is not the same"});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(v.jsxs)(p.a,{elevation:3,style:{padding:30,width:this.state.isMobile?"400px":"30vw",textAlign:"center"},children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("img",{src:"/admin/logo.svg",style:{height:"15vh",width:"15vh",borderRadius:7}}),Object(v.jsx)("div",{style:{fontSize:70,fontWeight:"bold",marginTop:0,lineHeight:.5},children:"Intendant"}),Object(v.jsx)("div",{style:Object(c.a)({fontSize:14,fontWeight:"bold",marginTop:0,lineHeight:1},"marginTop",30),children:"At the first launch, you must set the admin password"})]}),Object(v.jsxs)("div",{noValidate:!0,autoComplete:"off",style:{marginBottom:10},children:[Object(v.jsx)("div",{style:{marginTop:10},children:Object(v.jsx)(f.a,{value:this.state.password,fullWidth:!0,label:"Password",type:"password",inputProps:{maxLength:12},onChange:function(t){e.setState({password:t.nativeEvent.target.value})}})}),Object(v.jsx)("div",{style:{marginTop:10},children:Object(v.jsx)(f.a,{value:this.state.confirmePassword,fullWidth:!0,label:"Confirmation",type:"password",inputProps:{maxLength:12},onChange:function(t){e.setState({confirmePassword:t.nativeEvent.target.value})}})}),Object(v.jsx)("div",{style:{marginTop:15,textAlign:"end"},children:Object(v.jsx)(g.a,{variant:"plain",onClick:function(){e.register()},children:"Let's get started"})})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]})}}]),n}(s.a.Component),dt=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={authentification:!0,enabled:!1,getStarted:!1,message:"",password:"",customAddress:!1,address:window.location.origin,login:"admin",isMobile:!1},a}return Object(h.a)(n,[{key:"mediaQueries",value:function(e){var t=this,n=window.matchMedia(e);this.setState({isMobile:n.matches});n.addListener((function(e){return t.setState({isMobile:e.matches})}))}},{key:"componentDidMount",value:function(){var e=localStorage.getItem("server");e&&this.setState({address:e.replace("http://","")}),this.mediaQueries("(max-width: 900px)")}},{key:"login",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkServer();case 2:if(!e.sent){e.next=7;break}return e.next=5,(new W).post({login:this.state.login,password:this.state.password}).fetch("/api/authentification");case 5:(t=e.sent).error?this.setState({enabled:!0,message:t.code+" : "+t.message}):(localStorage.setItem("authorization",t.token),this.setState({enabled:!1,message:"",authentification:!1}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){localStorage.removeItem("authorization"),this.setState({authentification:!0,password:""})}},{key:"checkServer",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!0,n=window.location.protocol+"//",this.state.address.split("://").length>1&&(n=""),e.prev=3,e.next=6,fetch(n+this.state.address+"/api/ping",{},2e3);case 6:return a=e.sent,e.next=9,a.json();case 9:if("pong"==(s=e.sent).message&&"ok"==s.code){e.next=15;break}this.setState({enabled:!0,message:"Connection to server failed"}),t=!1,e.next=19;break;case 15:if(localStorage.setItem("server",n+this.state.address),!s.getStarted){e.next=19;break}return this.setState({getStarted:!0}),e.abrupt("return",!1);case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(3),this.setState({enabled:!0,message:"Connection to server failed"}),t=!1;case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}}),e,this,[[3,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.getStarted?Object(v.jsx)(lt,{onFinish:function(){e.setState({getStarted:!1})}}):this.state.authentification?Object(v.jsxs)(p.a,{elevation:3,style:{padding:30,width:this.state.isMobile?"400px":"25vw",textAlign:"center"},children:[Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{style:{marginBottom:50},children:[Object(v.jsx)("img",{onClick:function(){e.setState({customAddress:!e.state.customAddress})},src:"/admin/logo.svg",style:{height:"15vh",width:"15vh",borderRadius:7,cursor:"pointer"}}),Object(v.jsx)("div",{style:{fontSize:55,fontWeight:"bold",marginTop:0,lineHeight:.5},children:"Intendant"}),Object(v.jsx)("div",{style:Object(c.a)({fontSize:20,fontWeight:"bold",marginTop:0,lineHeight:1},"marginTop",15),children:"Administration"})]}),Object(v.jsxs)("form",{noValidate:!0,onSubmit:function(t){t.preventDefault(),e.login()},autoComplete:"off",style:{marginBottom:10},children:[this.state.customAddress?Object(v.jsx)("div",{style:{padding:5},children:Object(v.jsx)(f.a,{value:this.state.address,fullWidth:!0,label:"Server address",autoFocus:!0,onChange:function(t){e.setState({address:t.nativeEvent.target.value})}})}):null,Object(v.jsx)("div",{style:{padding:5},children:Object(v.jsx)(f.a,{value:this.state.login,fullWidth:!0,label:"Login",autoComplete:"current-login",inputProps:{maxLength:12},onChange:function(t){e.setState({login:t.nativeEvent.target.value})}})}),Object(v.jsx)("div",{style:{padding:5},children:Object(v.jsx)(f.a,{value:this.state.password,fullWidth:!0,label:"Password",type:"password",autoComplete:"current-login",inputProps:{maxLength:12},onChange:function(t){e.setState({password:t.nativeEvent.target.value})}})}),Object(v.jsx)("div",{style:{padding:5,marginTop:5,textAlign:"end"},children:Object(v.jsx)(g.a,{type:"submit",variant:"plain",on:!0,onSubmit:function(){e.login()},onClick:function(){e.login()},children:"Connection"})})]})]}),Object(v.jsx)(y,{onClose:function(){e.setState({enabled:!1})},open:this.state.enabled,severity:"error",children:this.state.message})]}):Object(v.jsx)(ot,{onDisconnect:function(){e.disconnect()}})}}]),n}(s.a.Component),ut=n(391),ht=n(392),jt=n(394);var bt=function(){return Object(v.jsxs)(ut.a,{theme:le,children:[Object(v.jsx)(ht.a,{}),Object(v.jsx)(jt.a,{style:{userSelect:"none",outline:"none",WebkitTapHighlightColor:"rgba(41,108,71,0.33)",height:"100vh",width:"100wh",backgroundColor:le.palette.background.default,display:"flex",flexDirection:"column",alignSelf:"center",justifyContent:"center",alignContent:"center",alignItems:"center"},children:Object(v.jsx)(dt,{})})]})};r.a.render(Object(v.jsx)(s.a.StrictMode,{children:Object(v.jsx)(bt,{})}),document.getElementById("root"))}},[[329,1,2]]]);
//# sourceMappingURL=main.295359d2.chunk.js.map