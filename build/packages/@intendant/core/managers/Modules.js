"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _package=_interopRequireDefault(require("../package")),_md=_interopRequireDefault(require("md5"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}class Modules{constructor(a){this.core=a,this.connector=a.connector,this.logger=a.logger,this.configuration=a.configuration,this.logger.verbose(_package.default.name,"Start Module Manager"),this.modules=new Map,this.configuration.modules.forEach(async a=>{this.logger.verbose(_package.default.name,"Module "+a+" has installed");let b=require(require("path").resolve("./")+"/.intendant/"+a),c=new b(this.core);this.modules.set(a,c)})}restart(){this.logger.verbose(_package.default.name,"Restart Module Manager"),this.modules=new Map,this.configuration.modules.forEach(async a=>{this.logger.verbose(_package.default.name,"Module "+a+" has installed");let b=require(require("path").resolve("./")+"/.intendant/"+a),c=new b(this.core);this.modules.set(a,c)})}getByHash(a){let b=!1;return this.configuration.modules.forEach(c=>{(0,_md.default)(c)==a&&(b=c)}),b}async executeAction(a,b,c){if(this.modules.has(a)){let d=this.modules.get(a);return"function"==typeof d["__"+b]?await d["__"+b](c):{error:!0,code:_package.default.name+" > ModuleManager > executeAction > action not found",message:"Action not found"}}return{error:!0,code:_package.default.name+" > ModuleManager > executeAction > module not found",message:"Module not found"}}getAll(){this.core.logger.verbose(_package.default.name,"Get all modules");let a=[];return this.configuration.modules.forEach(b=>{try{let c=require(require("path").resolve("./")+"/.intendant/"+b+"/configuration.json");a.push(c)}catch(a){this.core.logger.error(_package.default.name,"Impossible get configuration in "+b+" module"),this.core.logger.error(_package.default.name,JSON.stringify(a.toString()))}}),{error:!1,code:"ok",message:"",data:a}}}var _default=Modules;exports.default=_default,module.exports=exports.default;