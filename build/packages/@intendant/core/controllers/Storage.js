"use strict";var _Controller=_interopRequireDefault(require("./Controller"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}class Storage extends _Controller.default{async getItem(a){let b=await this.sqlStorage.getOneByField({id:a});if(b.error)return b;try{return{error:!1,code:"ok",message:"",data:b.data?JSON.parse(b.data.value):b.data}}catch(b){return await this.removeItem(a),{error:!1,code:"ok",message:"",data:{}}}}async setItem(a,b){let c=await this.sqlStorage.getOneByField({id:a});if(c.error)return c;if(c.data){let b=await this.sqlStorage.deleteAllByField({id:a});if(b.error)return b}let d=await this.sqlStorage.insert({id:a,value:JSON.stringify(b)});return d.error?d:{error:!1,code:"ok",message:""}}async removeItem(a){let b=await this.sqlStorage.deleteAllByField({id:a});return b.error?b:{error:!1,code:"ok",message:""}}async clear(){let a=await this.sqlStorage.truncate();return a.error?a:{error:!1,code:"ok",message:""}}}var _default=Storage;exports.default=_default,module.exports=exports.default;